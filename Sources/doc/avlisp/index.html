<html>
    <head>
        <meta http-equiv="content-type" content="text/html">
        <title>Auto/Visual lisp help</title>
        <meta name="Generator" content="Vim/7.3">
        <meta name="Author" content="John Kaul">
        <meta name="syntax" content="help">
        <meta name="settings" content="use_css">
        <style type="text/css">
            <!--
            pre {
                color:#333333;
                background-color:#fffffc;
                margin-left:7px;
                margin-right:7px;
                margin-top:0;
                margin-bottom:0;
                border:none;
                padding:0;
                text-indent:0;
                font-family:'Courier New', monospace;
                font-size:12px;
            }
            body {
                color:#333333;
                background-color:#fffffc;
            }
            .heading {
                color: #000044;
                font-size:22px;
                font-weight:bold;
                font-style: italic;
            }
            .Ignore {
                color: #202020;
            }
            .Statement {
                color: #7e8aa2;
            }
            .Todo {
                color: #C82536;
                font-size:14px;
                font-style: italic;
                font-weight: bold;
                text-decoration: underline;
            }
            .Special {
                color: #B22222;
            }
            .Identifier {
                color: #000044;
            }
            .ArgumentsIdentifier {
                font-family:'Courier New', monospace;
                font-size:14px;
                font-weight:bold;
                font-style:italic;
                text-decoration: underline;
            }
            .ReturnsIdentifier {
                font-family:'Courier New', monospace;
                font-size:14px;
                font-weight:bold;
                font-style:italic;
                text-decoration: underline;
            }
            .ExamplesIdentifier {
                font-family:'Courier New', monospace;
                font-size:14px;
                font-weight:bold;
                font-style:italic;
                text-decoration: underline;
            }
            .PreProc {
                color: #000000;
            }
            .String {
                color: #000044;
                font-size:22px;
                font-style: italic;
            }
            -->
        </style>
    </head>
   <body>
<pre>
<span class="heading">Auto/Visual Lisp Help</span>
Creator: John Kaul
Maintainer: theswamp.org
Last Updated: 04.12.12 8:57:47 AM

<span class="PreProc">==========</span>
 Operators
<span class="PreProc">==========</span>
  <a class="Identifier" href="#+">(add)</a>
  <a class="Identifier" href="#-">(subtract)</a>
  <a class="Identifier" href="#multiply">(*)</a>
  <a class="Identifier" href="#/">(divide)</a>
  <a class="Identifier" href="#=">(equal to)</a>
  <a class="Identifier" href="#/=">(not equal to)</a>
  <a class="Identifier" href="#&lt;">(less than)</a>
  <a class="Identifier" href="#&lt;=">(less than or equal to)</a>
  <a class="Identifier" href="#&gt;">(greater than)</a>
  <a class="Identifier" href="#&gt;=">(greater than or equal to)</a>
  <a class="Identifier" href="#~">(bitwise NOT)</a>
  <a class="Identifier" href="#1+">(increment)</a>
  <a class="Identifier" href="#1-">(decrement)</a>
<span class="PreProc">============</span>
 A Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#abs">abs</a>
  <a class="Identifier" href="#acad_colordlg">acad_colordlg</a>
  <a class="Identifier" href="#acad_helpdlg">acad_helpdlg</a>
  <a class="Identifier" href="#acad_strlsort">acad_strlsort</a>
  <a class="Identifier" href="#acdimenableupdate">acdimenableupdate</a>
  <a class="Identifier" href="#acet-attsync">acet-attsync</a>
  <a class="Identifier" href="#acet-layerp-mode">acet-layerp-mode</a>
  <a class="Identifier" href="#acet-layerp-mark">acet-layerp-mark</a>
  <a class="Identifier" href="#acet-laytrans">acet-laytrans</a>
  <a class="Identifier" href="#acet-ms-to-ps">acet-ms-to-ps</a>
  <a class="Identifier" href="#acet-ps-to-ms">acet-ps-to-ms</a>
  <a class="Identifier" href="#action_tile">action_tile</a>
  <a class="Identifier" href="#add_list">add_list</a>
  <a class="Identifier" href="#alert">alert</a>
  <a class="Identifier" href="#alloc">alloc</a>
  <a class="Identifier" href="#and">and</a>
  <a class="Identifier" href="#angle">angle</a>
  <a class="Identifier" href="#angtof">angtof</a>
  <a class="Identifier" href="#angtos">angtos</a>
  <a class="Identifier" href="#append">append</a>
  <a class="Identifier" href="#apply">apply</a>
  <a class="Identifier" href="#arx">arx</a>
  <a class="Identifier" href="#arxload">arxload</a>
  <a class="Identifier" href="#arxunload">arxunload</a>
  <a class="Identifier" href="#ascii">ascii</a>
  <a class="Identifier" href="#assoc">assoc</a>
  <a class="Identifier" href="#atan">atan</a>
  <a class="Identifier" href="#atof">atof</a>
  <a class="Identifier" href="#atoi">atoi</a>
  <a class="Identifier" href="#atom">atom</a>
  <a class="Identifier" href="#atoms-family">atoms-family</a>
  <a class="Identifier" href="#autoarxload">autoarxload</a>
  <a class="Identifier" href="#autoload">autoload</a>
<span class="PreProc">============</span>
 B Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#Boole">Boole</a>
  <a class="Identifier" href="#boundp">boundp</a>
<span class="PreProc">============</span>
 C Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#caddr">caddr</a>
  <a class="Identifier" href="#cadr">cadr</a>
  <a class="Identifier" href="#car">car</a>
  <a class="Identifier" href="#cdr">cdr</a>
  <a class="Identifier" href="#chr">chr</a>
  <a class="Identifier" href="#client_data_tile">client_data_tile</a>
  <a class="Identifier" href="#close">close</a>
  <a class="Identifier" href="#command">command</a>
  <a class="Identifier" href="#cond">cond</a>
  <a class="Identifier" href="#cons">cons</a>
  <a class="Identifier" href="#cos">cos</a>
  <a class="Identifier" href="#cvunit">cvunit</a>
<span class="PreProc">============</span>
 D Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#defun">defun</a>
  <a class="Identifier" href="#defun-q">defun-q</a>
  <a class="Identifier" href="#defun-q-list-ref">defun-q-list-ref</a>
  <a class="Identifier" href="#defun-q-list-set">defun-q-list-set</a>
  <a class="Identifier" href="#dictadd">dictadd</a>
  <a class="Identifier" href="#dictnext">dictnext</a>
  <a class="Identifier" href="#dictremove">dictremove</a>
  <a class="Identifier" href="#dictrename">dictrename</a>
  <a class="Identifier" href="#dictsearch">dictsearch</a>
  <a class="Identifier" href="#dimx_tile">dimx_tile</a>
  <a class="Identifier" href="#dimy_tile">dimy_tile</a>
  <a class="Identifier" href="#distance">distance</a>
  <a class="Identifier" href="#distof">distof</a>
  <a class="Identifier" href="#done_dialog">done_dialog</a>
<span class="PreProc">============</span>
 E Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#end_image">end_image</a>
  <a class="Identifier" href="#end_list">end_list</a>
  <a class="Identifier" href="#entdel">entdel</a>
  <a class="Identifier" href="#entget">entget</a>
  <a class="Identifier" href="#entlast">entlast</a>
  <a class="Identifier" href="#entmake">entmake</a>
  <a class="Identifier" href="#entmakex">entmakex</a>
  <a class="Identifier" href="#entmod">entmod</a>
  <a class="Identifier" href="#entnext">entnext</a>
  <a class="Identifier" href="#entsel">entsel</a>
  <a class="Identifier" href="#entupd">entupd</a>
  <a class="Identifier" href="#eq">eq</a>
  <a class="Identifier" href="#equal">equal</a>
  <a class="Identifier" href="#error_function">error_function</a> (*error*)
  <a class="Identifier" href="#eval">eval</a>
  <a class="Identifier" href="#exit">exit</a>
  <a class="Identifier" href="#exp">exp</a>
  <a class="Identifier" href="#expand">expand</a>
  <a class="Identifier" href="#expt">expt</a>
<span class="PreProc">============</span>
 F Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#fill_image">fill_image</a>
  <a class="Identifier" href="#findfile">findfile</a>
  <a class="Identifier" href="#fix">fix</a>
  <a class="Identifier" href="#float">float</a>
  <a class="Identifier" href="#foreach">foreach</a>
  <a class="Identifier" href="#function">function</a>
<span class="PreProc">============</span>
 G Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#gc">gc</a>
  <a class="Identifier" href="#gcd">gcd</a>
  <a class="Identifier" href="#get_attr">get_attr</a>
  <a class="Identifier" href="#get_tile">get_tile</a>
  <a class="Identifier" href="#getangle">getangle</a>
  <a class="Identifier" href="#getcfg">getcfg</a>
  <a class="Identifier" href="#getcname">getcname</a>
  <a class="Identifier" href="#getcorner">getcorner</a>
  <a class="Identifier" href="#getdist">getdist</a>
  <a class="Identifier" href="#getenv">getenv</a>
  <a class="Identifier" href="#getfiled">getfiled</a>
  <a class="Identifier" href="#getint">getint</a>
  <a class="Identifier" href="#getkword">getkword</a>
  <a class="Identifier" href="#getorient">getorient</a>
  <a class="Identifier" href="#getpoint">getpoint</a>
  <a class="Identifier" href="#getreal">getreal</a>
  <a class="Identifier" href="#getstring">getstring</a>
  <a class="Identifier" href="#getvar">getvar</a>
  <a class="Identifier" href="#graphscr">graphscr</a>
  <a class="Identifier" href="#grclear">grclear</a>
  <a class="Identifier" href="#grdraw">grdraw</a>
  <a class="Identifier" href="#grread">grread</a>
  <a class="Identifier" href="#grtext">grtext</a>
  <a class="Identifier" href="#grvecs">grvecs</a>
<span class="PreProc">============</span>
 H Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#handent">handent</a>
  <a class="Identifier" href="#help">help</a>
<span class="PreProc">============</span>
 I Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#if">if</a>
  <a class="Identifier" href="#initdia">initdia</a>
  <a class="Identifier" href="#initget">initget</a>
  <a class="Identifier" href="#inters">inters</a>
  <a class="Identifier" href="#itoa">itoa</a>
<span class="PreProc">============</span>
 L Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#lambda">lambda</a>
  <a class="Identifier" href="#last">last</a>
  <a class="Identifier" href="#layoutlist">layoutlist</a>
  <a class="Identifier" href="#length">length</a>
  <a class="Identifier" href="#list">list</a>
  <a class="Identifier" href="#listp">listp</a>
  <a class="Identifier" href="#load">load</a>
  <a class="Identifier" href="#load_dialog">load_dialog</a>
  <a class="Identifier" href="#log">log</a>
  <a class="Identifier" href="#logand">logand</a>
  <a class="Identifier" href="#logior">logior</a>
  <a class="Identifier" href="#lsh">lsh</a>
<span class="PreProc">============</span>
 M Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#mapcar">mapcar</a>
  <a class="Identifier" href="#max">max</a>
  <a class="Identifier" href="#mem">mem</a>
  <a class="Identifier" href="#member">member</a>
  <a class="Identifier" href="#menucmd">menucmd</a>
  <a class="Identifier" href="#menugroup">menugroup</a>
  <a class="Identifier" href="#min">min</a>
  <a class="Identifier" href="#minusp">minusp</a>
  <a class="Identifier" href="#mode_tile">mode_tile</a>
<span class="PreProc">============</span>
 N Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#namedobjdict">namedobjdict</a>
  <a class="Identifier" href="#nentsel">nentsel</a>
  <a class="Identifier" href="#nentselp">nentselp</a>
  <a class="Identifier" href="#new_dialog">new_dialog</a>
  <a class="Identifier" href="#not">not</a>
  <a class="Identifier" href="#nth">nth</a>
  <a class="Identifier" href="#null">null</a>
  <a class="Identifier" href="#numberp">numberp</a>
<span class="PreProc">============</span>
 O Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#open">open</a>
  <a class="Identifier" href="#or">or</a>
  <a class="Identifier" href="#osnap">osnap</a>
<span class="PreProc">============</span>
 P Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#polar">polar</a>
  <a class="Identifier" href="#prin1">prin1</a>
  <a class="Identifier" href="#princ">princ</a>
  <a class="Identifier" href="#print">print</a>
  <a class="Identifier" href="#progn">progn</a>
  <a class="Identifier" href="#prompt">prompt</a>
<span class="PreProc">============</span>
 Q Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#quit">quit</a>
  <a class="Identifier" href="#quote">quote</a>
<span class="PreProc">============</span>
 R Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#read">read</a>
  <a class="Identifier" href="#read-char">read-char</a>
  <a class="Identifier" href="#read-line">read-line</a>
  <a class="Identifier" href="#redraw">redraw</a>
  <a class="Identifier" href="#regapp">regapp</a>
  <a class="Identifier" href="#rem">rem</a>
  <a class="Identifier" href="#repeat">repeat</a>
  <a class="Identifier" href="#reverse">reverse</a>
  <a class="Identifier" href="#rtos">rtos</a>
<span class="PreProc">============</span>
 S Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#set">set</a>
  <a class="Identifier" href="#set_tile">set_tile</a>
  <a class="Identifier" href="#setcfg">setcfg</a>
  <a class="Identifier" href="#setenv">setenv</a>
  <a class="Identifier" href="#setfunhelp">setfunhelp</a>
  <a class="Identifier" href="#setq">setq</a>
  <a class="Identifier" href="#setvar">setvar</a>
  <a class="Identifier" href="#setview">setview</a>
  <a class="Identifier" href="#sin">sin</a>
  <a class="Identifier" href="#slide_image">slide_image</a>
  <a class="Identifier" href="#snvalid">snvalid</a>
  <a class="Identifier" href="#sqrt">sqrt</a>
  <a class="Identifier" href="#ssadd">ssadd</a>
  <a class="Identifier" href="#ssdel">ssdel</a>
  <a class="Identifier" href="#ssget">ssget</a>
  <a class="Identifier" href="#ssgetfirst">ssgetfirst</a>
  <a class="Identifier" href="#sslength">sslength</a>
  <a class="Identifier" href="#ssmemb">ssmemb</a>
  <a class="Identifier" href="#ssname">ssname</a>
  <a class="Identifier" href="#ssnamex">ssnamex</a>
  <a class="Identifier" href="#sssetfirst">sssetfirst</a>
  <a class="Identifier" href="#startapp">startapp</a>
  <a class="Identifier" href="#start_dialog">start_dialog</a>
  <a class="Identifier" href="#start_image">start_image</a>
  <a class="Identifier" href="#start_list">start_list</a>
  <a class="Identifier" href="#strcase">strcase</a>
  <a class="Identifier" href="#strcat">strcat</a>
  <a class="Identifier" href="#strlen">strlen</a>
  <a class="Identifier" href="#subst">subst</a>
  <a class="Identifier" href="#substr">substr</a>
<span class="PreProc">============</span>
 T Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#tablet">tablet</a>
  <a class="Identifier" href="#tblnext">tblnext</a>
  <a class="Identifier" href="#tblobjname">tblobjname</a>
  <a class="Identifier" href="#tblsearch">tblsearch</a>
  <a class="Identifier" href="#term_dialog">term_dialog</a>
  <a class="Identifier" href="#terpri">terpri</a>
  <a class="Identifier" href="#textbox">textbox</a>
  <a class="Identifier" href="#textpage">textpage</a>
  <a class="Identifier" href="#textscr">textscr</a>
  <a class="Identifier" href="#trace">trace</a>
  <a class="Identifier" href="#trans">trans</a>
  <a class="Identifier" href="#type">type</a>
<span class="PreProc">============</span>
 U Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#unload_dialog">unload_dialog</a>
  <a class="Identifier" href="#untrace">untrace</a>
<span class="PreProc">============</span>
 V Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#vector_image">vector_image</a>
  <a class="Identifier" href="#ver">ver</a>
  <a class="Identifier" href="#vl-acad-defun">vl-acad-defun</a>
  <a class="Identifier" href="#vl-acad-undefun">vl-acad-undefun</a>
  <a class="Identifier" href="#vl-arx-import">vl-arx-import</a>
  <a class="Identifier" href="#vl-bb-ref">vl-bb-ref</a>
  <a class="Identifier" href="#vl-bb-set">vl-bb-set</a>
  <a class="Identifier" href="#vl-catch-all-apply">vl-catch-all-apply</a>
  <a class="Identifier" href="#vl-catch-all-error-message">vl-catch-all-error-message</a>
  <a class="Identifier" href="#vl-catch-all-error-p">vl-catch-all-error-p</a>
  <a class="Identifier" href="#vl-cmdf">vl-cmdf</a>
  <a class="Identifier" href="#vl-consp">vl-consp</a>
  <a class="Identifier" href="#vl-copyobjects">vl-copyobjects</a>
  <a class="Identifier" href="#vl-directory-files">vl-directory-files</a>
  <a class="Identifier" href="#vl-doc-export">vl-doc-export</a>
  <a class="Identifier" href="#vl-doc-import">vl-doc-import</a>
  <a class="Identifier" href="#vl-doc-ref">vl-doc-ref</a>
  <a class="Identifier" href="#vl-doc-set">vl-doc-set</a>
  <a class="Identifier" href="#vl-every">vl-every</a>
  <a class="Identifier" href="#vl-exit-with-error">vl-exit-with-error</a>
  <a class="Identifier" href="#vl-exit-with-value">vl-exit-with-value</a>
  <a class="Identifier" href="#vl-file-copy">vl-file-copy</a>
  <a class="Identifier" href="#vl-file-delete">vl-file-delete</a>
  <a class="Identifier" href="#vl-file-directory-p">vl-file-directory-p</a>
  <a class="Identifier" href="#vl-file-rename">vl-file-rename</a>
  <a class="Identifier" href="#vl-file-size">vl-file-size</a>
  <a class="Identifier" href="#vl-file-systime">vl-file-systime</a>
  <a class="Identifier" href="#vl-filename-base">vl-filename-base</a>
  <a class="Identifier" href="#vl-filename-directory">vl-filename-directory</a>
  <a class="Identifier" href="#vl-filename-extension">vl-filename-extension</a>
  <a class="Identifier" href="#vl-filename-mktemp">vl-filename-mktemp</a>
  <a class="Identifier" href="#vl-get-resource">vl-get-resource</a>
  <a class="Identifier" href="#vl-list_star">vl-list_star</a> (vl-list*)
  <a class="Identifier" href="#vl-list-&gt;string">vl-list-&gt;string</a>
  <a class="Identifier" href="#vl-list-exported-functions">vl-list-exported-functions</a>
  <a class="Identifier" href="#vl-list-length">vl-list-length</a>
  <a class="Identifier" href="#vl-list-loaded-vlx">vl-list-loaded-vlx</a>
  <a class="Identifier" href="#vl-load-all">vl-load-all</a>
  <a class="Identifier" href="#vl-load-com">vl-load-com</a>
  <a class="Identifier" href="#vl-load-reactors">vl-load-reactors</a>
  <a class="Identifier" href="#vl-member-if">vl-member-if</a>
  <a class="Identifier" href="#vl-member-if-not">vl-member-if-not</a>
  <a class="Identifier" href="#vl-position">vl-position</a>
  <a class="Identifier" href="#vl-prin1-to-string">vl-prin1-to-string</a>
  <a class="Identifier" href="#vl-princ-to-string">vl-princ-to-string</a>
  <a class="Identifier" href="#vl-propagate">vl-propagate</a>
  <a class="Identifier" href="#vl-registry-delete">vl-registry-delete</a>
  <a class="Identifier" href="#vl-registry-descendents">vl-registry-descendents</a>
  <a class="Identifier" href="#vl-registry-read">vl-registry-read</a>
  <a class="Identifier" href="#vl-registry-write">vl-registry-write</a>
  <a class="Identifier" href="#vl-remove">vl-remove</a>
  <a class="Identifier" href="#vl-remove-if">vl-remove-if</a>
  <a class="Identifier" href="#vl-remove-if-not">vl-remove-if-not</a>
  <a class="Identifier" href="#vl-some">vl-some</a>
  <a class="Identifier" href="#vl-sort">vl-sort</a>
  <a class="Identifier" href="#vl-sort-i">vl-sort-i</a>
  <a class="Identifier" href="#vl-string-&gt;list">vl-string-&gt;list</a>
  <a class="Identifier" href="#vl-string-elt">vl-string-elt</a>
  <a class="Identifier" href="#vl-string-left-trim">vl-string-left-trim</a>
  <a class="Identifier" href="#vl-string-mismatch">vl-string-mismatch</a>
  <a class="Identifier" href="#vl-string-position">vl-string-position</a>
  <a class="Identifier" href="#vl-string-right-trim">vl-string-right-trim</a>
  <a class="Identifier" href="#vl-string-search">vl-string-search</a>
  <a class="Identifier" href="#vl-string-subst">vl-string-subst</a>
  <a class="Identifier" href="#vl-string-translate">vl-string-translate</a>
  <a class="Identifier" href="#vl-string-trim">vl-string-trim</a>
  <a class="Identifier" href="#vl-symbol-name">vl-symbol-name</a>
  <a class="Identifier" href="#vl-symbol-value">vl-symbol-value</a>
  <a class="Identifier" href="#vl-symbolp">vl-symbolp</a>
  <a class="Identifier" href="#vl-unload-vlx">vl-unload-vlx</a>
  <a class="Identifier" href="#vl-vbaload">vl-vbaload</a>
  <a class="Identifier" href="#vl-vbarun">vl-vbarun</a>
  <a class="Identifier" href="#vl-vlx-loaded-p">vl-vlx-loaded-p</a>
  <a class="Identifier" href="#vlax-3D-point">vlax-3D-point</a>
  <a class="Identifier" href="#vlax-add-cmd">vlax-add-cmd</a>
  <a class="Identifier" href="#vlax-create-object">vlax-create-object</a>
  <a class="Identifier" href="#vlax-curve-getArea">vlax-curve-getArea</a>
  <a class="Identifier" href="#vlax-curve-getClosestPointTo">vlax-curve-getClosestPointTo</a>
  <a class="Identifier" href="#vlax-curve-getClosestPointToProjection">vlax-curve-getClosestPointToProjection</a>
  <a class="Identifier" href="#vlax-curve-getDistAtParam">vlax-curve-getDistAtParam</a>
  <a class="Identifier" href="#vlax-curve-getDistAtPoint">vlax-curve-getDistAtPoint</a>
  <a class="Identifier" href="#vlax-curve-getEndParam">vlax-curve-getEndParam</a>
  <a class="Identifier" href="#vlax-curve-getEndPoint">vlax-curve-getEndPoint</a>
  <a class="Identifier" href="#vlax-curve-getFirstDeriv">vlax-curve-getFirstDeriv</a>
  <a class="Identifier" href="#vlax-curve-getParamAtDist">vlax-curve-getParamAtDist</a>
  <a class="Identifier" href="#vlax-curve-getParamAtPoint">vlax-curve-getParamAtPoint</a>
  <a class="Identifier" href="#vlax-curve-getPointAtDist">vlax-curve-getPointAtDist</a>
  <a class="Identifier" href="#vlax-curve-getPointAtParam">vlax-curve-getPointAtParam</a>
  <a class="Identifier" href="#vlax-curve-getSecondDeriv">vlax-curve-getSecondDeriv</a>
  <a class="Identifier" href="#vlax-curve-getStartParam">vlax-curve-getStartParam</a>
  <a class="Identifier" href="#vlax-curve-getStartPoint">vlax-curve-getStartPoint</a>
  <a class="Identifier" href="#vlax-curve-isClosed">vlax-curve-isClosed</a>
  <a class="Identifier" href="#vlax-curve-isPeriodic">vlax-curve-isPeriodic</a>
  <a class="Identifier" href="#vlax-curve-isPlanar">vlax-curve-isPlanar</a>
  <a class="Identifier" href="#vlax-dump-object">vlax-dump-object</a>
  <a class="Identifier" href="#vlax-ename-&gt;vla-object">vlax-ename-&gt;vla-object</a>
  <a class="Identifier" href="#vlax-erased-p">vlax-erased-p</a>
  <a class="Identifier" href="#vlax-for">vlax-for</a>
  <a class="Identifier" href="#vlax-get-acad-object">vlax-get-acad-object</a>
  <a class="Identifier" href="#vlax-get-object">vlax-get-object</a>
  <a class="Identifier" href="#vlax-get-or-create-object">vlax-get-or-create-object</a>
  <a class="Identifier" href="#vlax-get-property">vlax-get-property</a>
  <a class="Identifier" href="#vlax-import-type-library">vlax-import-type-library</a>
  <a class="Identifier" href="#vlax-invoke-method">vlax-invoke-method</a>
  <a class="Identifier" href="#vlax-ldata-delete">vlax-ldata-delete</a>
  <a class="Identifier" href="#vlax-ldata-get">vlax-ldata-get</a>
  <a class="Identifier" href="#vlax-ldata-list">vlax-ldata-list</a>
  <a class="Identifier" href="#vlax-ldata-put">vlax-ldata-put</a>
  <a class="Identifier" href="#vlax-ldata-test">vlax-ldata-test</a>
  <a class="Identifier" href="#vlax-make-safearray">vlax-make-safearray</a>
  <a class="Identifier" href="#vlax-make-variant">vlax-make-variant</a>
  <a class="Identifier" href="#vlax-map-collection">vlax-map-collection</a>
  <a class="Identifier" href="#vlax-method-applicable-p">vlax-method-applicable-p</a>
  <a class="Identifier" href="#vlax-object-released-p">vlax-object-released-p</a>
  <a class="Identifier" href="#vlax-product-key">vlax-product-key</a>
  <a class="Identifier" href="#vlax-property-available-p">vlax-property-available-p</a>
  <a class="Identifier" href="#vlax-put-property">vlax-put-property</a>
  <a class="Identifier" href="#vlax-read-enabled-p">vlax-read-enabled-p</a>
  <a class="Identifier" href="#vlax-release-object">vlax-release-object</a>
  <a class="Identifier" href="#vlax-remove-cmd">vlax-remove-cmd</a>
  <a class="Identifier" href="#vlax-safearray-fill">vlax-safearray-fill</a>
  <a class="Identifier" href="#vlax-safearray-get-dim">vlax-safearray-get-dim</a>
  <a class="Identifier" href="#vlax-safearray-get-element">vlax-safearray-get-element</a>
  <a class="Identifier" href="#vlax-safearray-get-l-bound">vlax-safearray-get-l-bound</a>
  <a class="Identifier" href="#vlax-safearray-get-u-bound">vlax-safearray-get-u-bound</a>
  <a class="Identifier" href="#vlax-safearray-put-element">vlax-safearray-put-element</a>
  <a class="Identifier" href="#vlax-safearray-type">vlax-safearray-type</a>
  <a class="Identifier" href="#vlax-safearray-&gt;list">vlax-safearray-&gt;list</a>
  <a class="Identifier" href="#vlax-tmatrix">vlax-tmatrix</a>
  <a class="Identifier" href="#vlax-typeinfo-available-p">vlax-typeinfo-available-p</a>
  <a class="Identifier" href="#vlax-variant-change-type">vlax-variant-change-type</a>
  <a class="Identifier" href="#vlax-variant-type">vlax-variant-type</a>
  <a class="Identifier" href="#vlax-variant-value">vlax-variant-value</a>
  <a class="Identifier" href="#vlax-vla-object-&gt;ename">vlax-vla-object-&gt;ename</a>
  <a class="Identifier" href="#vlax-write-enabled-p">vlax-write-enabled-p</a>
  <a class="Identifier" href="#vlisp-compile">vlisp-compile</a>
  <a class="Identifier" href="#vlr-acdb-reactor">vlr-acdb-reactor</a>
  <a class="Identifier" href="#vlr-add">vlr-add</a>
  <a class="Identifier" href="#vlr-added-p">vlr-added-p</a>
  <a class="Identifier" href="#vlr-beep-reaction">vlr-beep-reaction</a>
  <a class="Identifier" href="#vlr-command-reactor">vlr-command-reactor</a>
  <a class="Identifier" href="#vlr-current-reaction-name">vlr-current-reaction-name</a>
  <a class="Identifier" href="#vlr-data">vlr-data</a>
  <a class="Identifier" href="#vlr-data-set">vlr-data-set</a>
  <a class="Identifier" href="#vlr-deepclone-reactor">vlr-deepclone-reactor</a>
  <a class="Identifier" href="#vlr-docmanager-reactor">vlr-docmanager-reactor</a>
  <a class="Identifier" href="#vlr-dwg-reactor">vlr-dwg-reactor</a>
  <a class="Identifier" href="#vlr-dxf-reactor">vlr-dxf-reactor</a>
  <a class="Identifier" href="#vlr-editor-reactor">vlr-editor-reactor</a>
  <a class="Identifier" href="#vlr-insert-reactor">vlr-insert-reactor</a>
  <a class="Identifier" href="#vlr-linker-reactor">vlr-linker-reactor</a>
  <a class="Identifier" href="#vlr-lisp-reactor">vlr-lisp-reactor</a>
  <a class="Identifier" href="#vlr-miscellaneous-reactor">vlr-miscellaneous-reactor</a>
  <a class="Identifier" href="#vlr-mouse-reactor">vlr-mouse-reactor</a>
  <a class="Identifier" href="#vlr-notification">vlr-notification</a>
  <a class="Identifier" href="#vlr-object-reactor">vlr-object-reactor</a>
  <a class="Identifier" href="#vlr-owner-add">vlr-owner-add</a>
  <a class="Identifier" href="#vlr-owner-remove">vlr-owner-remove</a>
  <a class="Identifier" href="#vlr-owners">vlr-owners</a>
  <a class="Identifier" href="#vlr-pers">vlr-pers</a>
  <a class="Identifier" href="#vlr-pers-list">vlr-pers-list</a>
  <a class="Identifier" href="#vlr-pers-p">vlr-pers-p</a>
  <a class="Identifier" href="#vlr-pers-release">vlr-pers-release</a>
  <a class="Identifier" href="#vlr-reaction-name">vlr-reaction-name</a>
  <a class="Identifier" href="#vlr-reaction-set">vlr-reaction-set</a>
  <a class="Identifier" href="#vlr-reactions">vlr-reactions</a>
  <a class="Identifier" href="#vlr-reactors">vlr-reactors</a>
  <a class="Identifier" href="#vlr-remove">vlr-remove</a>
  <a class="Identifier" href="#vlr-remove-all">vlr-remove-all</a>
  <a class="Identifier" href="#vlr-set-notification">vlr-set-notification</a>
  <a class="Identifier" href="#vlr-sysvar-reactor">vlr-sysvar-reactor</a>
  <a class="Identifier" href="#vlr-toolbar-reactor">vlr-toolbar-reactor</a>
  <a class="Identifier" href="#vlr-trace-reaction">vlr-trace-reaction</a>
  <a class="Identifier" href="#vlr-type">vlr-type</a>
  <a class="Identifier" href="#vlr-types">vlr-types</a>
  <a class="Identifier" href="#vlr-undo-reactor">vlr-undo-reactor</a>
  <a class="Identifier" href="#vlr-wblock-reactor">vlr-wblock-reactor</a>
  <a class="Identifier" href="#vlr-window-reactor">vlr-window-reactor</a>
  <a class="Identifier" href="#vlr-xref-reactor">vlr-xref-reactor</a>
  <a class="Identifier" href="#vports">vports</a>
<span class="PreProc">============</span>
 W Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#wcmatch">wcmatch</a>
  <a class="Identifier" href="#while">while</a>
  <a class="Identifier" href="#write-char">write-char</a>
  <a class="Identifier" href="#write-line">write-line</a>
<span class="PreProc">============</span>
 X Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#xdroom">xdroom</a>
  <a class="Identifier" href="#xdsize">xdsize</a>
<span class="PreProc">============</span>
 Z Functions
<span class="PreProc">============</span>
  <a class="Identifier" href="#zerop">zerop</a>
<span class="PreProc">===========================</span>
 Externally Defined Commands
<span class="PreProc">===========================</span>
  <a class="Identifier" href="#3dsin">3dsin</a>
  <a class="Identifier" href="#3dsout">3dsout</a>
  <a class="Identifier" href="#align">align</a>
  <a class="Identifier" href="#cal">cal</a>
  <a class="Identifier" href="#fog">fog</a>
  <a class="Identifier" href="#light">light</a>
  <a class="Identifier" href="#lsedit">lsedit</a>
  <a class="Identifier" href="#lslib">lslib</a>
  <a class="Identifier" href="#lsnew">lsnew</a>
  <a class="Identifier" href="#matlib">matlib</a>
  <a class="Identifier" href="#mirror3d">mirror3d</a>
  <a class="Identifier" href="#render">render</a>
  <a class="Identifier" href="#renderupdate">renderupdate</a>
  <a class="Identifier" href="#replay">replay</a>
  <a class="Identifier" href="#rmat">rmat</a>
  <a class="Identifier" href="#rotate3d">rotate3d</a>
  <a class="Identifier" href="#rpref">rpref</a>
  <a class="Identifier" href="#saveimg">saveimg</a>
  <a class="Identifier" href="#scene">scene</a>
  <a class="Identifier" href="#setuv">setuv</a>
  <a class="Identifier" href="#showmat">showmat</a>
  <a class="Identifier" href="#solprof">solprof</a>
  <a class="Identifier" href="#stats">stats</a>

<span class="PreProc">================================== Operators ==================================</span>
<h3 class="String" id="+">+ (add)</h3>

Returns the sum of all numbers

(+ [number number] ...)

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

The result of the addition. If you supply only one number argument, this
function returns the result of adding it to zero. If you supply no arguments,
the function returns 0.

<span class="ExamplesIdentifier">Examples</span>

(+ 1 2) returns 3

(+ 1 2 3 4.5) returns 10.5

(+ 1 2 3 4.0) returns 10.0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="-">- (subtract)</h3>

Subtracts the second and following numbers from the first and returns the
difference

(- [number number] ...)

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

The result of the subtraction. If you supply more than two number arguments,
this function returns the result of subtracting the sum of the second through
the last numbers from the first number. If you supply only one number argument,
this function subtracts the number from zero, and returns a negative number.
Supplying no arguments returns 0.

<span class="ExamplesIdentifier">Examples</span>

(- 50 40) returns 10

(- 50 40.0) returns 10.0

(- 50 40.0 2.5) returns 7.5

(- 8) returns -8

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="multiply">multiply</h3>

Returns the product of all numbers

(* [number number] ...)

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

The result of the multiplication. If you supply only one number argument, this
function returns the result of multiplying it by one; it returns the number.
Supplying no arguments returns 0.

<span class="ExamplesIdentifier">Examples</span>

(* 2 3) returns  6

(* 2 3.0) returns  6.0

(* 2 3 4.0) returns 24.0

(* 3 -4.5) returns -13.5

(* 3) returns 3

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="/">/ (divide)</h3>

Divides the first number by the product of the remaining numbers and returns
the quotient

(/ [number number] ...)

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

The result of the division. If you supply more than two number arguments, this
function divides the first number by the product of the second through the last
numbers, and returns the final quotient. If you supply one number argument,
this function returns the result of dividing it by one; it returns the number.
Supplying no arguments returns 0.

<span class="ExamplesIdentifier">Examples</span>

(/ 100 2) returns 50

(/ 100 2.0) returns 50.0

(/ 100 20.0 2) returns 2.5

(/ 100 20 2) returns 2

(/ 4) returns 4

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="=">= (equal to)</h3>

Compares arguments for numerical equality

(= numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if all arguments are numerically equal, nil otherwise. If only one argument
is supplied, = returns T.

<span class="ExamplesIdentifier">Examples</span>

(= 4 4.0) returns T

(= 20 388) returns nil

(= 2.4 2.4 2.4) returns T

(= 499 499 500) returns nil

(= &quot;me&quot; &quot;me&quot;) returns T

(= &quot;me&quot; &quot;you&quot;) returns nil

See Also

The <a class="Identifier" href="#eq">eq</a> and <a class="Identifier" href="#equal">equal</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="/=">/= (not equal to)</h3>

Compares arguments for numerical inequality

(/= numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if no two successive arguments are the same in value, nil otherwise. If only
one argument is supplied, /= returns T.

<span class="Todo">Note</span> that the behavior of /= does not quite conform to other LISP dialects. The
standard behavior is to return T if no two arguments in the list have the same
value. In AutoLISP, /= returns T if no successive arguments have the same
value; see the examples that follow.

<span class="ExamplesIdentifier">Examples</span>

(/= 10 20) returns T

(/= &quot;you&quot; &quot;you&quot;) returns nil

(/= 5.43 5.44) returns T

(/= 10 20 10 20 20) returns nil

(/= 10 20 10 20) returns T

<span class="Todo">Note</span> in the last example that although there are two arguments in the list with
the same value, they do not follow one another, and thus /= evaluates to T.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="&lt;">&lt; (less than)</h3>

Returns T if each argument is numerically less than the argument to its right,
and returns nil otherwise

(&lt; numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if each argument is numerically less than the argument to its right, and
returns nil otherwise. If only one argument is supplied, &lt; returns T.

<span class="ExamplesIdentifier">Examples</span>

(&lt; 10 20) returns T

(&lt; &quot;b&quot; &quot;c&quot;) returns T

(&lt; 357 33.2) returns nil

(&lt; 2 3 88) returns T

(&lt; 2 3 4 4) returns nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="&lt;=">&lt;= (less than or equal to)</h3>

Returns T if each argument is numerically less than or equal to the argument to
its right, and returns nil otherwise

(&lt;= numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if each argument is numerically less than or equal to the argument to its
right, and returns nil otherwise. If only one argument is supplied, &lt;= returns
T.

<span class="ExamplesIdentifier">Examples</span>

(&lt;= 10 20) returns T

(&lt;= &quot;b&quot; &quot;b&quot;) returns T

(&lt;= 357 33.2) returns nil

(&lt;= 2 9 9) returns T

(&lt;= 2 9 4 5) returns nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="&gt;">&gt; (greater than)</h3>

Returns T if each argument is numerically greater than the argument to its
right, and returns nil otherwise

(&gt; numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if each argument is numerically greater than the argument to its right, and
nil otherwise. If only one argument is supplied, &gt; returns T.

<span class="ExamplesIdentifier">Examples</span>

(&gt; 120 17) returns T

(&gt; &quot;c&quot; &quot;b&quot;) returns T

(&gt; 3.5 1792) returns nil

(&gt; 77 4 2) returns T

(&gt; 77 4 4) returns nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="&gt;=">&gt;=</h3> (greater than or equal to)

Returns T if each argument is numerically greater than or equal to the argument
to its right, and returns nil otherwise

(&gt;= numstr <span class="Special">[numstr]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

numstr

A number or a string.

<span class="ReturnsIdentifier">Return Values</span>

T, if each argument is numerically greater than or equal to the argument to its
right, and nil otherwise. If only one argument is supplied, &gt;= returns T.

<span class="ExamplesIdentifier">Examples</span>

(&gt;= 120 17) returns T

(&gt;= &quot;c&quot; &quot;c&quot;) returns T

(&gt;= 3.5 1792) returns nil

(&gt;= 77 4 4) returns T

(&gt;= 77 4 9) returns nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="~">~ (bitwise NOT)</h3>

Returns the bitwise NOT (1's complement) of the argument

(~ int)

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer.

<span class="ReturnsIdentifier">Return Values</span>

The bitwise NOT (1's complement) of the argument.

<span class="ExamplesIdentifier">Examples</span>

(~ 3) returns -4

(~ 100) returns -101

(~ -4) returns   3

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="1+">1+ (increment)</h3>

Increments a number by 1

(1+ number)

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

<span class="ReturnsIdentifier">Return Values</span>

The argument, increased by 1.

<span class="ExamplesIdentifier">Examples</span>

(1+ 5) returns   6

(1+ -17.5) returns -16.5

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="1-">1- (decrement)</h3>

Decrements a number by 1

(1- number)

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

<span class="ReturnsIdentifier">Return Values</span>

The argument, reduced by 1.

<span class="ExamplesIdentifier">Examples</span>

(1- 5) returns   4

(1- -17.5) returns -18.5

<span class="PreProc">================================ A Functions ===================================</span>

<h3 class="String" id="abs">abs</h3>

Returns the absolute value of a number

(abs number)

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

<span class="ReturnsIdentifier">Return Values</span>

The absolute value of the argument.

<span class="ExamplesIdentifier">Examples</span>

(abs 100) returns 100

(abs -100) returns 100

(abs -99.25) returns 99.25

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acad_colordlg">acad_colordlg</h3>

Displays the standard AutoCAD color selection dialog box

(acad_colordlg colornum <span class="Special">[flag]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

colornum

An integer in the range 0-256 (inclusive), specifying the AutoCAD color number
to display as the initial default.

flag

If set to nil, disables the ByLayer and ByBlock buttons. Omitting the flag
argument or setting it to a non-nil value enables the ByLayer and ByBlock
buttons.

A colornum value of 0 defaults to ByBlock, and a value of 256 defaults to
ByLayer.

<span class="ReturnsIdentifier">Return Values</span>

The user-selected color number, or nil, if the user cancels the dialog box.

<span class="ExamplesIdentifier">Examples</span>

Prompt the user to select a color, and default to green if none is selected:

(acad_colordlg 3)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acad_helpdlg">acad_helpdlg</h3>

Invokes the help facility (obsolete)

(acad_helpdlg helpfile topic)

This externally defined function has been replaced by the built-in function
help. It is provided for compatibility with previous releases of AutoCAD.

See Also

The <a class="Identifier" href="#help">help</a> function for a complete description of this function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acad_strlsort">acad_strlsort</h3>

Sorts a list of strings by alphabetical order

(acad_strlsort list)

<span class="ArgumentsIdentifier">Arguments</span>

list

The list of strings to be sorted.

<span class="ReturnsIdentifier">Return Values</span>

The list in alphabetical order. If the list is invalid or if there is not
enough memory to do the sort, acad_strlsort returns nil.

<span class="ExamplesIdentifier">Examples</span>

Sort a list of abbreviated month names:

Command: (setq mos '(&quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Apr&quot; &quot;May&quot; &quot;Jun&quot; &quot;Jul&quot; &quot;Aug&quot;

&quot;Sep&quot; &quot;Oct&quot; &quot;Nov&quot; &quot;Dec&quot;))

(&quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Apr&quot; &quot;May&quot; &quot;Jun&quot; &quot;Jul&quot; &quot;Aug&quot; &quot;Sep&quot; &quot;Oct&quot; &quot;Nov&quot; &quot;Dec&quot;)

Command: (acad_strlsort mos)

(&quot;Apr&quot; &quot;Aug&quot; &quot;Dec&quot; &quot;Feb&quot; &quot;Jan&quot; &quot;Jul&quot; &quot;Jun&quot; &quot;Mar&quot; &quot;May&quot; &quot;Nov&quot; &quot;Oct&quot; &quot;Sep&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acdimenableupdate">acdimenableupdate</h3>

Controls the automatic updating of associative dimensions

(acdimenableupdate nil | T)

The acdimenableupdate function is intended for developers who are editing
geometry and don't want the dimension to be updated until after the edits are
complete.

<span class="ArgumentsIdentifier">Arguments</span>

nil

Associative dimensions will not update (even if the geometry is modified) until
the DIMREGEN command is entered.

T

Enable automatic updating of associative dimensions when the geometry is
modified.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

Disable the automatic update of associative dimensions in the drawing:

Command: (acdimenableupdate nil)

Enable the automatic update of associative dimensions in the drawing:

Command: (acdimenableupdate T)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-attsync">acet-attsync</h3>

Updates all instances of a specified block with the current attribute
definition of the block

(acet-attsync blockname)

This function is equivalent to the AutoCAD ATTSYNC command.

<span class="ArgumentsIdentifier">Arguments</span>

blockname

A string naming the block to be updated. The string can contain wildcard
characters.

<span class="ReturnsIdentifier">Return Values</span>

T, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Update the attribute definitions of all ProductInfo block instances in the
current drawing:

Command: (acet-attsync &quot;ProductInfo&quot;)

T

Update the attributes of all blocks whose names begin with &quot;Prod:&quot;

Command: (acet-attsync &quot;Prod*&quot;)

T

Update the attributes of all blocks whose names begin with &quot;Pix:&quot;

Command: (acet-attsync &quot;Pix*&quot;)

Block table contains no attributed block named Pix*.nil

See Also

The <a class="Identifier" href="#ATTSYNC">ATTSYNC</a> command.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-layerp-mode">acet-layerp-mode</h3>

Queries and sets the LAYERPMODE setting

(acet-layerp-mode <span class="Special">[status]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

status

Specifying T turns LAYERPMODE on, enabling layer- change tracking. Nil turns
LAYERPMODE off.

If this argument is not present, acet-layerp-mode returns the current status of
LAYERPMODE.

<span class="ReturnsIdentifier">Return Values</span>

T if current status of LAYERPMODE is on, nil if LAYERPMODE is off.

<span class="ExamplesIdentifier">Examples</span>

Check the current status of LAYERPMODE:

Command: (acet-layerp-mode)

T

Turn LAYERPMODE off:

Command: (acet-layerp-mode nil)

nil

Check the current status of LAYERPMODE:

Command: (acet-layerp-mode)

nil

See Also

The <a class="Identifier" href="#layerp">layerp</a> and <a class="Identifier" href="#layerpmode">layerpmode</a> commands.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-layerp-mark">acet-layerp-mark</h3>

Places beginning and ending marks for Layer Previous recording

(acet-layerp-mark <span class="Special">[status]</span>)

The acet-layerp-mark function allows you to group multiple layer commands into
a single transaction so that they can be undone by issuing LAYERP a single
time. LAYERPMODE must be on in order to set marks.

<span class="ArgumentsIdentifier">Arguments</span>

status

Specifying T sets a begin mark. Specifying nil sets an end mark, clearing the
begin mark.

If status is omitted, acet-layerp-mark returns the current mark status for
layer settings.

<span class="ReturnsIdentifier">Return Values</span>

T if a begin mark is in effect, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following code changes layer 0 to blue, and then makes several additional
layer changes between a set of begin and end marks. If you issue LAYERP after
running this code, layer 0 reverts back to blue.

(defun TestLayerP ()

 ;; Turn LAYERPMODE on, if it isn't already

 (if (not (acet-layerp-mode))

  (acet-layerp-mode T)

 )

 ;; Set layer 0 to the color blue

 (command &quot;_.layer&quot; &quot;_color&quot; &quot;blue&quot; &quot;0&quot; &quot;&quot;)

 ;; Set a begin mark

 (acet-layerp-mark T)

 ;; Issue a series of layer commands, and then set an end mark

 (command &quot;_.layer&quot; &quot;_color&quot; &quot;green&quot; &quot;0&quot; &quot;&quot;)

 (command &quot;_.layer&quot; &quot;_thaw&quot; &quot;*&quot; &quot;&quot;)

 (command &quot;_.layer&quot; &quot;_unlock&quot; &quot;*&quot; &quot;&quot;)

 (command &quot;_.layer&quot; &quot;_ltype&quot; &quot;hidden&quot; &quot;0&quot; &quot;&quot;)

 (command &quot;_.layer&quot; &quot;_color&quot; &quot;red&quot; &quot;0&quot; &quot;&quot;)

 ;; Set an end mark

(acet-layerp-mark nil)

 )

See Also

The <a class="Identifier" href="#LAYERP">LAYERP</a> command.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-laytrans">acet-laytrans</h3>

Translates drawing layers to standards defined in another drawing or standards
file

(acet-laytrans &quot;filename&quot; <span class="Special">[settings]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string specifying a file containing layer mappings to be used for
translation.

settings

A bit-coded integer specifying Layer Translator processing options. The bits
can be added together in any combination to form a value between 0 and 15. If
the settings argument is omitted, a value of 15 (all options selected) is
assumed. The bit values are as follows:

0 No options

1 Force entity color to BYLAYER

2 Force entity linetype to BYLAYER

4 Translate objects in blocks

8 Write transaction log

<span class="ReturnsIdentifier">Return Values</span>

T if translation is successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following command translates the current drawing using layer mappings saved
in LayMap.dwg. No transaction log will be produced, but all other processing
options will be in effect.

Command: (acet-laytrans &quot;c:/my documents/cad drawings/LayMap.dwg&quot; 7)

T


<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-ms-to-ps">acet-ms-to-ps</h3>

Converts a real value from model space units to paper space units.

(acet-ms-to-ps <span class="Special">[value]</span> <span class="Special">[viewport]</span>)

If both the value and viewport arguments are specified, the value is converted
to model space units using the specified viewport. No user input is required.

If only the value argument is specified, the current viewport is assumed and no
user input is required. However, if the current space is model space, there is
no current viewport and the function will fail (returning nil). If paper space
is the current space, the function will either prompt for a viewport if more
than one viewport exists in the current paper space layout, or use the single
existing viewport.

If no arguments are specified, the function prompts for a value and converts it
if possible.

<span class="ArgumentsIdentifier">Arguments</span>

value

A real value to be converted.

viewport

A viewport entity name (ads_name).

<span class="ReturnsIdentifier">Return Values</span>

The converted real value on success, nil on failure.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="acet-ps-to-ms">acet-ps-to-ms</h3>

Converts a real value from paper space units to model space units.

(acet-ps-to-ms <span class="Special">[value]</span> <span class="Special">[viewport]</span>)

If both the value and viewport arguments are specified, the value is converted
to model space units using the specified viewport. No user input is required.

If only the value argument is specified, the current viewport is assumed and no
user input is required. However, if the current space is model space, there is
no current viewport and the function will fail (returning nil). If paper space
is the current space, the function will either prompt for a viewport if more
than one viewport exists in the layout, or use the single existing viewport.

If no arguments are specified, the function prompts for a value and converts it
if possible.

<span class="ArgumentsIdentifier">Arguments</span>

value

A real value to be converted.

viewport

A viewport entity name (ads_name).

<span class="ReturnsIdentifier">Return Values</span>

The converted real value on success, nil on failure.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="action_tile">action_tile</h3>

Assigns an action to evaluate when the user selects the specified tile in a
dialog box

(action_tile key action-expression)

The action assigned by action_tile supersedes the dialog box's default action
(assigned by new_dialog) or the tile's action attribute, if these are
specified. The expression can refer to the tile's current value as $value, its
name as $key, its application-specific data (as set by client_data_tile) as
$data, its callback reason as $reason, and its image coordinates (if the tile
is an image button) as $x and $y.

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that names the tile that triggers the action (specified as its key
attribute). This argument is case-sensitive.

action-expression

A string naming the expression evaluated when the tile is selected.

<span class="Todo">Note</span>:  You cannot call the AutoLISP command function from the action_tile
function.

<span class="ReturnsIdentifier">Return Values</span>

T

<span class="ExamplesIdentifier">Examples</span>

If edit1 is a text box, the action expression in the following action_tile call
is evaluated when the user exits the text box:

(action_tile &quot;edit1&quot; &quot;(setq ns $value)&quot;)

See Also

The Default and DCL Actions topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="add_list">add_list</h3>

Adds or modifies a string in the currently active dialog box list

(add_list string)

Before using add_list, you must open the list and initialize it with a call to
start_list. Depending on the operation specified in start_list, the string is
either added to the current list or replaces the current list item.

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

<span class="ReturnsIdentifier">Return Values</span>

Returns the string added to the list, if successful, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Assuming the currently active DCL file has a popup_list or list_box with a key
of longlist, the following code fragment initializes the list and adds to it
the text strings in llist.

(setq llist '(&quot;first line&quot; &quot;second line&quot; &quot;third line&quot;))

(start_list &quot;longlist&quot;)

(mapcar 'add_list llist)

(end_list)

After the list has been defined, the following code fragment changes the text
in the second line to &quot;2nd line&quot;.

(start_list &quot;longlist&quot; 1 0)

(add_list &quot;2nd line&quot;)

(end_list)

See Also

The <a class="Identifier" href="#start_list">start_list</a> and <a class="Identifier" href="#end_list">end_list</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="alert">alert</h3>

Displays a dialog box containing an error or warning message

(alert string)

<span class="ArgumentsIdentifier">Arguments</span>

string

The string to appear in the alert box.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

Display a message in an alert box:

(alert &quot;That function is not available.&quot;)

Display a multiple line message, by using the newline character in string:

(alert &quot;That function\nis not available.&quot;)

<span class="Todo">Note</span>:  Line length and the number of lines in an alert box are platform,
device, and window dependent. AutoCAD truncates any string that is too long to
fit inside an alert box.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="alloc">alloc</h3>

Sets the size of the segment to be used by the expand function

(alloc n-alloc)

<span class="ArgumentsIdentifier">Arguments</span>

n-alloc

An integer indicating the amount of memory to be allocated. The integer
represents the number of symbols, strings, usubrs, reals, and cons cells.

<span class="ReturnsIdentifier">Return Values</span>

The previous setting of n-alloc.

<span class="ExamplesIdentifier">Examples</span>

_$ (alloc 100)

1000

See Also

The <a class="Identifier" href="#expand">expand</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="and">and</h3>

Returns the logical AND of the supplied arguments

(and [expr ...])

<span class="ArgumentsIdentifier">Arguments</span>

expr

Any expression.

<span class="ReturnsIdentifier">Return Values</span>

Nil, if any of the expressions evaluate to nil, otherwise T. If and is issued
without arguments, it returns T.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 103 b nil c &quot;string&quot;)

&quot;string&quot;

Command: (and 1.4 a c)

T

Command: (and 1.4 a b c)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="angle">angle</h3>

Returns an angle in radians of a line defined by two endpoints

(angle pt1 pt2)

<span class="ArgumentsIdentifier">Arguments</span>

pt1

An endpoint.

pt2

An endpoint.

<span class="ReturnsIdentifier">Return Values</span>

An angle, in radians.

The angle is measured from the X axis of the current construction plane, in
radians, with angles increasing in the counterclockwise direction. If 3D points
are supplied, they are projected onto the current construction plane.

<span class="ExamplesIdentifier">Examples</span>

Command: (angle '(1.0 1.0) '(1.0 4.0))

1.5708

Command: (angle '(5.0 1.33) '(2.4 1.33))

3.14159

See Also

The Angular Conversion topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="angtof">angtof</h3>

Converts a string representing an angle into a real (floating-point) value in
radians

(angtof string <span class="Special">[units]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string describing an angle based on the format specified by the mode
argument. The string must be a string that angtof can parse correctly to the
specified unit. It can be in the same form that angtos returns, or in a form
that AutoCAD allows for keyboard entry.

units

Specifies the units in which the string is formatted. The value should
correspond to values allowed for the AutoCAD system variable AUNITS. If unit is
omitted, angtof uses the current value of AUNITS. The following units may be
specified:

0 Degrees

1 Degrees/minutes/seconds

2 Grads

3 Radians

4 Surveyor's units

<span class="ReturnsIdentifier">Return Values</span>

A real value, if successful, otherwise nil.

The angtof and angtos functions are complementary: if you pass angtof a string
created by angtos, angtof is guaranteed to return a valid value, and vice versa
(assuming the unit values match).

<span class="ExamplesIdentifier">Examples</span>

Command: (angtof &quot;45.0000&quot;)

0.785398

Command: (angtof &quot;45.0000&quot; 3)

1.0177

See Also

The <a class="Identifier" href="#angtos">angtos</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="angtos">angtos</h3>

Converts an angular value in radians into a string

(angtos angle [unit <span class="Special">[precision]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

angle

A real number, in radians.

unit

An integer that specifies the angular units. If unit is omitted, angtos uses
the current value of the AutoCAD system variable AUNITS. The following units
may be specified:

0 Degrees

1 Degrees/minutes/seconds

2 Grads

3 Radians

4 Surveyor's units

precision

An integer specifying the number of decimal places of precision to be returned.
If omitted, angtos uses the current setting of the AutoCAD system variable
AUPREC.

The angtos function takes angle and returns it edited into a string according
to the settings of unit, precision, the AutoCAD UNITMODE system variable, and
the DIMZIN dimensioning variable.

The angtos function accepts a negative angle argument, but always reduces it to
a positive value between zero and 2 pi radians before performing the specified
conversion.

The UNITMODE system variable affects the returned string when surveyor's units
are selected (a unit value of 4). If UNITMODE = 0, spaces are included in the
string (for example, &quot;<span class="Special">N</span> 45d E&quot;); if UNITMODE = 1, no spaces are included in the
string (for example, &quot;N45dE&quot;).

<span class="ReturnsIdentifier">Return Values</span>

A string, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (angtos 0.785398 0 4)

&quot;45.0000&quot;

Command: (angtos -0.785398 0 4)

&quot;315.0000&quot;

Command: (angtos -0.785398 4)

&quot;S 45d E&quot;

<span class="Todo">Note</span>:  Routines that use the angtos function to display arbitrary angles (those
not relative to the value of ANGBASE) should check and consider the value of
ANGBASE.

See Also

The <a class="Identifier" href="#angtof">angtof</a> function, and String Conversions in the Visual LISP Developer's
Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="append">append</h3>

Takes any number of lists and appends them together as one list

(append [list ...])

<span class="ArgumentsIdentifier">Arguments</span>

list

A list.

<span class="ReturnsIdentifier">Return Values</span>

A list with all arguments appended to the original. If no arguments are
supplied, append returns nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (append '(a b) '(c d))

(A B C D)

Command: (append '((a)(b)) '((c)(d)))

((A) (B) (C) (D))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="apply">apply</h3>

Passes a list of arguments to, and executes, a specified function

(apply 'function list)

<span class="ArgumentsIdentifier">Arguments</span>

'function

A function. The function argument can be either a symbol identifying a defun,
or a lambda expression.

list

A list. Can be nil, if the function accepts no arguments.

<span class="ReturnsIdentifier">Return Values</span>

The result of the function call.

<span class="ExamplesIdentifier">Examples</span>

Command: (apply '+ '(1 2 3))

6

Command: (apply 'strcat '(&quot;a&quot; &quot;b&quot; &quot;c&quot;))

&quot;abc&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="arx">arx</h3>

Returns a list of the currently loaded ObjectARX applications

(arx)

<span class="ReturnsIdentifier">Return Values</span>

A list of ObjectARX(R) application file names; the path is not included in the
file name.

<span class="ExamplesIdentifier">Examples</span>

Command: (arx)

(&quot;acadapp.arx&quot; &quot;acmted.arx&quot; &quot;oleaprot.arx&quot;)

See Also

The <a class="Identifier" href="#arxload">arxload</a> and <a class="Identifier" href="#arxunload">arxunload</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="arxload">arxload</h3>

Loads an ObjectARX application

(arxload application <span class="Special">[onfailure]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

application

A quoted string or a variable that contains the name of an executable file. You
can omit the .arx extension from the file name.

You must supply the full path name of the ObjectARX executable file, unless the
file is in a directory that is in the AutoCAD Support File Search Path.

onfailure

An expression to be executed if the load fails.

<span class="ReturnsIdentifier">Return Values</span>

The application name, if successful. If unsuccessful and the onfailure argument
is supplied, arxload returns the value of this argument, otherwise, failure
results in an error message.

If you attempt to load an application that is already loaded, arxload issues an
error message. You may want to check the currently loaded ObjectARX
applications with the arx function before using arxload.

<span class="ExamplesIdentifier">Examples</span>

Load the acbrowse.arx file supplied in the AutoCAD install directory:

Command: (arxload &quot;c:/program files/AutoCAD/acbrowse.arx&quot;)

&quot;c:/program files/AutoCAD/acbrowse.arx&quot;

See Also

The <a class="Identifier" href="#arxunload">arxunload</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="arxunload">arxunload</h3>

Unloads an ObjectARX application

(arxunload application <span class="Special">[onfailure]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

application

A quoted string or a variable that contains the name of a file that was loaded
with the arxload function. You can omit the .arx extension and the path from
the file name.

onfailure

An expression to be executed if the unload fails.

<span class="ReturnsIdentifier">Return Values</span>

The application name, if successful. If unsuccessful and the onfailure argument
is supplied, arxunload returns the value of this argument, otherwise, failure
results in an error message.

<span class="Todo">Note</span> that locked ObjectARX applications cannot be unloaded. ObjectARX
applications are locked by default.

<span class="ExamplesIdentifier">Examples</span>

Unload the acbrowse application that was loaded in the arxload function
example:

Command: (arxunload &quot;acbrowse&quot;)

&quot;acbrowse&quot;

See Also

The <a class="Identifier" href="#arxload">arxload</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ascii">ascii</h3>

Returns the conversion of the first character of a string into its ASCII
character code (an integer)

(ascii string)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

Command: (ascii &quot;A&quot;)

65

Command: (ascii &quot;a&quot;)

97

Command: (ascii &quot;BIG&quot;)

66

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="assoc">assoc</h3>

Searches an association list for an element and returns that association list
entry

(assoc element alist)

<span class="ArgumentsIdentifier">Arguments</span>

element

Key of an element in an association list.

alist

An association list to be searched.

<span class="ReturnsIdentifier">Return Values</span>

The alist entry, if successful. If assoc does not find element as a key in
alist, it returns nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq al '((name box) (width 3) (size 4.7263) (depth 5)))

((NAME BOX) (WIDTH 3) (SIZE 4.7263) (DEPTH 5))

Command: (assoc 'size al)

(SIZE 4.7263)

Command: (assoc 'weight al)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="atan">atan</h3>

Returns the arctangent of a number in radians

(atan num1 <span class="Special">[num2]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

num1

A number.

num2

A number.

<span class="ReturnsIdentifier">Return Values</span>

The arctangent of num1, in radians, if only num1 is supplied. If you supply
both num1 and num2 arguments, atan returns the arctangent of num1/num2, in
radians. If num2 is zero, it returns an angle of plus or minus 1.570796 radians
(+90 degrees or -90 degrees), depending on the sign of num1. The range of
angles returned is -pi/2 to +pi/2 radians.

<span class="ExamplesIdentifier">Examples</span>

Command: (atan 1)

0.785398

Command: (atan 1.0)

0.785398

Command: (atan 0.5)

0.463648

Command: (atan 1.0)

0.785398

Command: (atan -1.0)

-0.785398

Command: (atan 2.0 3.0)

0.588003

Command: (atan 2.0 -3.0)

2.55359

Command: (atan 1.0 0.0)

1.5708

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="atof">atof</h3>

Converts a string into a real number

(atof string)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string to be converted into a real number.

<span class="ReturnsIdentifier">Return Values</span>

A real number.

<span class="ExamplesIdentifier">Examples</span>

Command: (atof &quot;97.1&quot;)

97.1

Command: (atof &quot;3&quot;)

3.0

Command: (atof &quot;3.9&quot;)

3.9

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="atoi">atoi</h3>

Converts a string into an integer

(atoi string)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string to be converted into an integer.

<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

Command: (atoi &quot;97&quot;)

97

Command: (atoi &quot;3&quot;)

3

Command: (atoi &quot;3.9&quot;)

3

See Also

The <a class="Identifier" href="#itoa">itoa</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="atom">atom</h3>

Verifies that an item is an atom

(atom item)

<span class="ArgumentsIdentifier">Arguments</span>

item

Any AutoLISP element.

Some versions of LISP differ in their interpretation of atom, so be careful
when converting from non-AutoLISP code.

<span class="ReturnsIdentifier">Return Values</span>

Nil if item is a list, otherwise T. Anything that is not a list is considered
an atom.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a '(x y z))

(X Y Z)

Command: (setq b 'a)

A

Command: (atom 'a)

T

Command: (atom a)

nil

Command: (atom 'b)

T

Command: (atom b)

T

Command: (atom '(a b c))

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="atoms-family">atoms-family</h3>

Returns a list of the currently defined symbols

(atoms-family format <span class="Special">[symlist]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

format

An integer value of 0 or 1 that determines the format in which atoms-family
returns the symbol names:

0 Return the symbol names as a list

1 Return the symbol names as a list of strings

symlist

A list of strings that specify the symbol names you want atoms-family to search
for.

<span class="ReturnsIdentifier">Return Values</span>

A list of symbols. If you specify symlist, then atoms-family returns the
specified symbols that are currently defined, and returns nil for those symbols
that are not defined.

<span class="ExamplesIdentifier">Examples</span>

Command: (atoms-family 0)

(BNS_PRE_SEL FITSTR2LEN C:AI_SPHERE ALERT DEFUN C:BEXTEND REM_GROUP

B_RESTORE_SYSVARS BNS_CMD_EXIT LISPED FNSPLITL...

The following code verifies that the symbols CAR, CDR, and XYZ are defined, and
returns the list as strings:

Command: (atoms-family 1 '(&quot;CAR&quot; &quot;CDR&quot; &quot;XYZ&quot;))

(&quot;CAR&quot; &quot;CDR&quot; nil)

The return value shows that the symbol XYZ is not defined.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="autoarxload">autoarxload</h3>

Predefines command names to load an associated ObjectARX file

(autoarxload filename cmdlist)

The first time a user enters a command specified in cmdlist, AutoCAD loads the
ObjectARX application specified in filename, then continues the command.

If you associate a command with filename and that command is not defined in the
specified file, AutoCAD alerts you with an error message when you enter the
command.

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string specifying the .arx file to be loaded when one of the commands defined
by the cmdlist argument is entered at the Command prompt. If you omit the path
from filename, AutoCAD looks for the file in the Support File Search Path.

cmdlist

A list of strings.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

The following code defines the C:APP1, C:APP2, and C:APP3 functions to load the
bonusapp.arx file:

(autoarxload &quot;BONUSAPP&quot; '(&quot;APP1&quot; &quot;APP2&quot; &quot;APP3&quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="autoload">autoload</h3>

Predefines command names to load an associated AutoLISP file

(autoload filename cmdlist)

The first time a user enters a command specified in cmdlist, AutoCAD loads the
application specified in filename, then continues the command.

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string specifying the .lsp file to be loaded when one of the commands defined
by the cmdlist argument is entered at the Command prompt. If you omit the path
from filename, AutoCAD looks for the file in the Support File Search Path.

cmdlist

A list of strings.

<span class="ReturnsIdentifier">Return Values</span>

nil

If you associate a command with filename and that command is not defined in the
specified file, AutoCAD alerts you with an error message when you enter the
command.

<span class="ExamplesIdentifier">Examples</span>

The following causes AutoCAD to load the bonusapp.lsp file the first time the
APP1, APP2, or APP3 commands are entered at the Command prompt:

(autoload &quot;BONUSAPP&quot; '(&quot;APP1&quot; &quot;APP2&quot; &quot;APP3&quot;))

<span class="PreProc">================================ B Functions ===================================</span>

<h3 class="String" id="Boole">Boole</h3>

Serves as a general bitwise Boolean function

(Boole operator int1 [int2 ...])

<span class="ArgumentsIdentifier">Arguments</span>

operator

An integer between 0 and 15 representing one of the 16 possible Boolean
functions in two variables.

int1, int2...

Integers.

<span class="Todo">Note</span> that Boole will accept a single integer argument, but the result is
unpredictable.

Successive integer arguments are bitwise (logically) combined based on this
function and on the following truth table:

                  +---------------------+------+--------------+
                  |            Boolean truth table            |
                  +---------------------+------+--------------+
                  |        Int1         | Int2 | operator bit |
                  +---------------------+------+--------------+
                  | 0                   | 0    | 8            |
                  +---------------------+------+--------------+
                  | 0                   | 1    | 4            |
                  +---------------------+------+--------------+
                  | 1                   | 0    | 2            |
                  +---------------------+------+--------------+
                  | 1                   | 1    | 1            |
                  +---------------------+------+--------------+
Each bit of int1 is paired with the corresponding bit of int2, specifying one
horizontal row of the truth table. The resulting bit is either 0 or 1,
depending on the setting of the operator bit that corresponds to this row of
the truth table.

If the appropriate bit is set in operator, the resulting bit is 1; otherwise
the resulting bit is 0. Some of the values for operator are equivalent to the
standard Boolean operations AND, OR, XOR, and NOR.

+---------------------------+-----------+--------------------------------------+
|                          Boole function bit values                           |
+---------------------------+-----------+--------------------------------------+
|Operator                   | Operation | Resulting bit is 1 if                |
+---------------------------+-----------+--------------------------------------+
| 1                         | AND       | Both input bits are 1                |
+---------------------------+-----------+--------------------------------------+
| 6                         | XOR       | Only one of the two input bits is 1  |
+---------------------------+-----------+--------------------------------------+
| 7                         | OR        | Either or both of the input bits     |
|                           |           | are 1                                |
+---------------------------+-----------+--------------------------------------+
| 8                         | NOR       | Both input bits are 0 (1's           |
|                           |           | complement)                          |
+---------------------------+-----------+--------------------------------------+
<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

The following specifies a logical AND of the values 12 and 5:

Command: (Boole 1 12 5)

4

The following specifies a logical XOR of the values 6 and 5:

Command: (Boole 6 6 5)

3

You can use other values of operator to perform other Boolean operations for
which there are no standard names. For example, if operator is 4, the resulting
bits are set if the corresponding bits are set in int2 but not in int1:

Command: (Boole 4 3 14)

12

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="boundp">boundp</h3>

Verifies if a value is bound to a symbol

(boundp sym)

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol.

<span class="ReturnsIdentifier">Return Values</span>

T if sym has a value bound to it. If no value is bound to sym, or if it has
been bound to nil, boundp returns nil. If sym is an undefined symbol, it is
automatically created and is bound to nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 2 b nil)

nil

Command: (boundp 'a)

T

Command: (boundp 'b)

nil

The atoms-family function provides an alternative method of determining the
existence of a symbol without automatically creating the symbol.

See Also

The <a class="Identifier" href="#atoms-family">atoms-family</a> function.

<span class="PreProc">================================ C Functions ===================================</span>

<h3 class="String" id="caddr">caddr</h3>

Returns the third element of a list

(caddr list)

In AutoLISP, caddr is frequently used to obtain the Z coordinate of a 3D point
(the third element of a list of three reals).

<span class="ArgumentsIdentifier">Arguments</span>

list

A list.

<span class="ReturnsIdentifier">Return Values</span>

The third element in list; or nil, if the list is empty or contains fewer than
three elements.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq pt3 '(5.25 1.0 3.0))

(5.25 1.0 3.0)

Command: (caddr pt3)

3.0

Command: (caddr '(5.25 1.0))

nil

See Also

The Point Lists topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cadr">cadr</h3>

Returns the second element of a list

(cadr list)

In AutoLISP, cadr is frequently used to obtain the Y coordinate of a 2D or 3D
point (the second element of a list of two or three reals).

<span class="ArgumentsIdentifier">Arguments</span>

list

A list.

<span class="ReturnsIdentifier">Return Values</span>

The second element in list, or nil, if the list is empty or contains only one
element.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq pt2 '(5.25 1.0))

(5.25 1.0)

Command: (cadr pt2)

1.0

Command: (cadr '(4.0))

nil

Command: (cadr '(5.25 1.0 3.0))

1.0

See Also

The Point Lists topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="car">car</h3>

Returns the first element of a list

(car list)

<span class="ArgumentsIdentifier">Arguments</span>

list

A list.

<span class="ReturnsIdentifier">Return Values</span>

The first element in list; or nil, if the list is empty.

<span class="ExamplesIdentifier">Examples</span>

Command: (car '(a b c))

A

Command: (car '((a b) c))

(A B)

Command: (car '())

nil

See Also

The Point Lists topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cdr">cdr</h3>

Returns a list containing all but the first element of the specified list

(cdr list)

<span class="ArgumentsIdentifier">Arguments</span>

list

A list.

<span class="ReturnsIdentifier">Return Values</span>

A list containing all the elements of list, except the first element (but see
<span class="Todo">Note</span> below). If the list is empty, cdr returns nil.

<span class="Todo">Note</span>:  When the list argument is a dotted pair, cdr returns the second element
without enclosing it in a list.

<span class="ExamplesIdentifier">Examples</span>

Command: (cdr '(a b c))

(B C)

Command: (cdr '((a b) c))

(C)

Command: (cdr '())

nil

Command: (cdr '(a . b))

B

Command: (cdr '(1 . &quot;Text&quot;))

&quot;Text&quot;

See Also

The Point Lists topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="chr">chr</h3>

Converts an integer representing an ASCII character code into a
single-character string

(chr integer)

<span class="ArgumentsIdentifier">Arguments</span>

list

An integer.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the ASCII character code for integer. If the integer is not
in the range of 1-255, the return value is unpredictable.

<span class="ExamplesIdentifier">Examples</span>

Command: (chr 65)

&quot;A&quot;

Command: (chr 66)

&quot;B&quot;

Command: (chr 97)

&quot;a&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="client_data_tile">client_data_tile</h3>

Associates application-managed data with a dialog box tile

(client_data_tile key clientdata)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies a tile. This argument is case-sensitive.

clientdata

A string to be associated with the key tile. An action expression or callback
function can refer to the string as $data.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="close">close</h3>

Closes an open file

(close file-desc)

<span class="ArgumentsIdentifier">Arguments</span>

file-desc

A file descriptor obtained from the open function.

<span class="ReturnsIdentifier">Return Values</span>

Nil if file-desc is valid, otherwise results in an error message.

After a close, the file descriptor is unchanged but is no longer valid. Data
added to an open file is not actually written until the file is closed.

<span class="ExamplesIdentifier">Examples</span>

The following code counts the number of lines in the file somefile.txt and sets
the variable ct equal to that number:

(setq fil &quot;SOMEFILE.TXT&quot;)

(setq x (open fil &quot;r&quot;) ct 0)

(while (read-line x)

 (setq ct (1+ ct))

)

(close x)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="command">command</h3>

Executes an AutoCAD command

(command <span class="Special">[arguments]</span> ...)

<span class="ArgumentsIdentifier">Arguments</span>

arguments

AutoCAD commands and their options.

The arguments to the command function can be strings, reals, integers, or
points, as expected by the prompt sequence of the executed command. A null
string (&quot;&quot;) is equivalent to pressing ENTER on the keyboard. Invoking command
with no argument is equivalent to pressing ESC and cancels most AutoCAD
commands.

The command function evaluates each argument and sends it to AutoCAD in
response to successive prompts. It submits command names and options as
strings, 2D points as lists of two reals, and 3D points as lists of three
reals. AutoCAD recognizes command names only when it issues a Command prompt.

<span class="Todo">Note</span> that if you issue command from Visual LISP, focus does not change to the
AutoCAD window. If the command requires user input, you'll see the return value
(nil) in the Console window, but AutoCAD will be waiting for input. You must
manually activate the AutoCAD window and respond to the prompts. Until you do
so, any subsequent commands will fail.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

The following example sets two variables pt1 and pt2 equal to two point values
1,1 and 1,5. It then uses the command function to issue the LINE command and
pass the two point values.

Command: (setq pt1 '(1 1) pt2 '(1 5))

(1 5)

Command: (command &quot;line&quot; pt1 pt2 &quot;&quot;)

line From point:

To point:

To point:

Command: nil

<span class="Todo">Restrictions and Notes</span>

The AutoCAD SKETCH command reads the digitizer directly and therefore cannot be
used with the AutoLISP command function. If the SCRIPT command is used with the
command function, it should be the last function call in the AutoLISP routine.

Also, if you use the command function in an acad.lsp or .mnl file, it should be
called only from within a defun statement. Use the S::STARTUP function to
define commands that need to be issued immediately when you begin a drawing
session.

For AutoCAD commands that require the selection of an object (like the BREAK
and TRIM commands), you can supply a list obtained with entsel instead of a
point to select the object. For examples, see Passing Pick Points to AutoCAD
Commands in the Visual LISP Developer's Guide.

Commands executed from the command function are not echoed to the command line
if the CMDECHO system variable (accessible from setvar and getvar) is set to 0.

See Also

The <a class="Identifier" href="#vl-cmdf">vl-cmdf</a> function in this reference and Command Submission in the Visual
LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cond">cond</h3>

Serves as the primary conditional function for AutoLISP

(cond [(test result ...) ...])

The cond function accepts any number of lists as arguments. It evaluates the
first item in each list (in the order supplied) until one of these items
returns a value other than nil. It then evaluates those expressions that follow
the test that succeeded.

<span class="ReturnsIdentifier">Return Values</span>

The value of the last expression in the sublist. If there is only one
expression in the sublist (that is, if result is missing), the value of the
test expression is returned. If no arguments are supplied, cond returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following example uses cond to perform an absolute value calculation:

(cond

 ((minusp a) (- a))

 (t a)

)

If the variable a is set to the value -10, this returns 10.

As shown, cond can be used as a case type function. It is common to use T as
the last (default) test expression. Here's another simple example. Given a user
response string in the variable s, this function tests the response and returns
1 if it is Y or y, 0 if it is <span class="Special">N</span> or n, and nil otherwise.

(cond

 ((= s &quot;Y&quot;) 1)

 ((= s &quot;y&quot;) 1)

 ((= s &quot;<span class="Special">N</span>&quot;) 0)

 ((= s &quot;n&quot;) 0)

 (t nil)

)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cons">cons</h3>

Adds an element to the beginning of a list, or constructs a dotted list

(cons new-first-element list-or-atom)

<span class="ArgumentsIdentifier">Arguments</span>

new-first-element

Element to be added to the beginning of a list. This element can be an atom or
a list.

list-or-atom

A list or an atom.

<span class="ReturnsIdentifier">Return Values</span>

The value returned depends on the data type of list-or-atom. If list-or-atom is
a list, cons returns that list with new-first-element added as the first item
in the list. If list-or-atom is an atom, cons returns a dotted pair consisting
of new-first-element and list-or-atom.

<span class="ExamplesIdentifier">Examples</span>

Command: (cons 'a '(b c d))

(A B C D)

Command: (cons '(a) '(b c d))

((A) B C D)

Command: (cons 'a 2)

(A . 2)

See Also

The List Handling topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cos">cos</h3>

Returns the cosine of an angle expressed in radians

(cos ang)

<span class="ArgumentsIdentifier">Arguments</span>

ang

An angle, in radians.

<span class="ReturnsIdentifier">Return Values</span>

The cosine of ang, in radians.

<span class="ExamplesIdentifier">Examples</span>

Command: (cos 0.0)

1.0

Command: (cos pi)

-1.0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cvunit">cvunit</h3>

Converts a value from one unit of measurement to another

(cvunit value from-unit to-unit)

<span class="ArgumentsIdentifier">Arguments</span>

value

The numeric value or point list (2D or 3D point) to be converted.

from-unit

The unit that value is being converted from.

to-unit

The unit that value is being converted to.

The from-unit and to-unit arguments can name any unit type found in the
acad.unt file.

<span class="ReturnsIdentifier">Return Values</span>

The converted value, if successful, or nil, if either unit name is unknown (not
found in the acad.unt file), or if the two units are incompatible (for example,
trying to convert grams into years).

<span class="ExamplesIdentifier">Examples</span>

Command: (cvunit 1 &quot;minute&quot; &quot;second&quot;)

60.0

Command: (cvunit 1 &quot;gallon&quot; &quot;furlong&quot;)

nil

Command: (cvunit 1.0 &quot;inch&quot; &quot;cm&quot;)

2.54

Command: (cvunit 1.0 &quot;acre&quot; &quot;sq yard&quot;)

4840.0

Command: (cvunit '(1.0 2.5) &quot;ft&quot; &quot;in&quot;)

(12.0 30.0)

Command: (cvunit '(1 2 3) &quot;ft&quot; &quot;in&quot;)

(12.0 24.0 36.0)

<span class="Todo">Note</span>:  If you have several values to convert in the same manner, it is more
efficient to convert the value 1.0 once and then apply the resulting value as a
scale factor in your own function or computation. This works for all predefined
units except temperature, where an offset is involved as well.

See Also

The Unit Conversion topic in the Visual LISP Developer's Guide.

<span class="PreProc">================================ D Functions ===================================</span>

<h3 class="String" id="defun">defun</h3>

Defines a function

(defun sym (<span class="Special">[arguments]</span> [/ variables...]) expr...)

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol naming the function.

arguments

The names of arguments expected by the function.

/ variables

The names of one or more local variables for the function.

The slash preceding the variable names must be separated from the first local
name and from the last argument, if any, by at least one space.

expr

Any number of AutoLISP expressions to be evaluated when the function executes.

If you do not declare any arguments or local symbols, you must supply an empty
set of parentheses after the function name.

If duplicate argument or symbol names are specified, AutoLISP uses the first
occurrence of each name and ignores the following occurrences.

<span class="ReturnsIdentifier">Return Values</span>

The result of the last expression evaluated.

Warning!  Never use the name of a built-in function or symbol for the sym
argument to defun. This overwrites the original definition and makes the
built-in function or symbol inaccessible. To get a list of built-in and
previously defined functions, use the atoms-family function.

<span class="ExamplesIdentifier">Examples</span>

(defun myfunc (x y) ...) Function takes two arguments

(defun myfunc (/ a b) ...) Function has two local variables

(defun myfunc (x / temp) ...) One argument, one local variable

(defun myfunc () ...) No arguments or local variables

See Also

The Symbol and Function Handling topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="defun-q">defun-q</h3>

Defines a function as a list

(defun-q sym (<span class="Special">[arguments]</span> [/ variables...]) expr...)

The defun-q function is provided strictly for backward-compatibility with
previous versions of AutoLISP, and should not be used for other purposes. You
can use defun-q in situations where you need to access a function definition as
a list structure, which is the way defun was implemented in previous,
non-compiled versions of AutoLISP.

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol naming the function.

arguments

The names of arguments expected by the function.

/ variables

The names of one or more local variables for the function.

The slash preceding the variable names must be separated from the first local
name and from the last argument, if any, by at least one space.

expr

Any number of AutoLISP expressions to be evaluated when the function executes.

If you do not declare any arguments or local symbols, you must supply an empty
set of parentheses after the function name.

If duplicate argument or symbol names are specified, AutoLISP uses the first
occurrence of each name and ignores the following occurrences.

<span class="ReturnsIdentifier">Return Values</span>

The result of the last expression evaluated.

<span class="ExamplesIdentifier">Examples</span>

_$ (defun-q my-startup (x) (print (list x)))

MY-STARTUP

_$ (my-startup 5)

(5) (5)

Use defun-q-list-ref to display the list structure of my-startup:

_$ (defun-q-list-ref 'my-startup)

((X) (PRINT (LIST X)))

See Also

The <a class="Identifier" href="#defun-q-list-ref">defun-q-list-ref</a> and <a class="Identifier" href="#defun-q-list-set">defun-q-list-set">defun-q-list-ref</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="defun-q-list-ref">defun-q-list-ref</h3>

Displays the list structure of function defined with defun-q

(defun-q-list-ref 'function )

<span class="ArgumentsIdentifier">Arguments</span>

function

A symbol naming the function.

<span class="ReturnsIdentifier">Return Values</span>

The list definition of the function, or nil, if the argument is not a list.

<span class="ExamplesIdentifier">Examples</span>

Define a function using defun-q:

_$ (defun-q my-startup (x) (print (list x)))

MY-STARTUP

Use defun-q-list-ref to display the list structure of my-startup:

_$ (defun-q-list-ref 'my-startup)

((X) (PRINT (LIST X)))

See Also

The <a class="Identifier" href="#defun-q">defun-q</a> and <a class="Identifier" href="#defun-q-list-set">defun-q-list-set</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="defun-q-list-set">defun-q-list-set</h3>

Sets the value of a symbol to be a function defined by a list

(defun-q-list-set 'sym list)

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol naming the function

list

A list containing the expressions to be included in the function.

<span class="ReturnsIdentifier">Return Values</span>

The sym defined.

<span class="ExamplesIdentifier">Examples</span>

_$ (defun-q-list-set 'foo '((x) x))

FOO

_$ (foo 3)

3

The following example illustrates the use of defun-q-list-set to combine two
functions into a single function. First, from the Visual LISP Console window,
define two functions with defun-q:

_$ (defun-q s::startup (x) (print x))

S::STARTUP

_$ (defun-q my-startup (x) (print (list x)))

MY-STARTUP

Use defun-q-list-set to combine the functions into a single function:

_$ (defun-q-list-set 's::startup (append

 (defun-q-list-ref 's::startup)

 (cdr (defun-q-list-ref 'my-startup))))

S::STARTUP

The following illustrates how the functions respond individually, and how the
functions work after being combined using defun-q-list-set:

_$ (defun-q foo (x) (print (list 'foo x)))

FOO

_$ (foo 1)

(FOO 1) (FOO 1)

_$ (defun-q bar (x) (print (list 'bar x)))

BAR

_$ (bar 2)

(BAR 2) (BAR 2)

_$ (defun-q-list-set

 'foo

 (append (defun-q-list-ref 'foo)

 (cdr (defun-q-list-ref 'bar))

 ))

FOO

_$ (foo 3)

(FOO 3)

(BAR 3) (BAR 3)

See Also

The <a class="Identifier" href="#defun-q">defun-q</a> and <a class="Identifier" href="#defun-q-list-ref">defun-q-list-ref</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dictadd">dictadd</h3>

Adds a nongraphical object to the specified dictionary

(dictadd ename symbol newobj)

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the dictionary the object is being added to.

symbol

The key name of the object being added to the dictionary; symbol must be a
unique name that does not already exist in the dictionary.

newobj

A nongraphical object to be added to the dictionary.

As a general rule, each object added to a dictionary must be unique to that
dictionary. This is specifically a problem when adding group objects to the
group dictionary. Adding the same group object using different key names
results in duplicate group names, which can send the dictnext function into an
infinite loop.

<span class="ReturnsIdentifier">Return Values</span>

The entity name of the object added to the dictionary.

<span class="ExamplesIdentifier">Examples</span>

The examples that follow create objects and add them to the named object
dictionary.

Create a dictionary entry list:

Command: (setq dictionary (list '(0 . &quot;DICTIONARY&quot;) '(100 . &quot;AcDbDictionary&quot;)))

((0 . &quot;DICTIONARY&quot;) (100 . &quot;AcDbDictionary&quot;))

Create a dictionary object using the entmakex function:

Command: (setq xname (entmakex dictionary))

&lt;Entity name: 1d98950&gt;

Add the dictionary to the named object dictionary:

Command: (setq newdict (dictadd (namedobjdict) &quot;MY_WAY_COOL_DICTIONARY&quot; xname))

&lt;Entity name: 1d98950&gt;

Create an Xrecord list:

Command: (setq datalist (append (list '(0 . &quot;XRECORD&quot;)'(100 . &quot;AcDbXrecord&quot;))
'((1 . &quot;This is my data&quot;) (10 1. 2. 3.) (70 . 33))))

((0 . &quot;XRECORD&quot;) (100 . &quot;AcDbXrecord&quot;) (1 . &quot;This is my data&quot;) (10 1.0 2.0 3.0)
(70 . 33))

Make an Xrecord object:

Command: (setq xname (entmakex datalist))

&lt;Entity name: 1d98958&gt;

Add the Xrecord object to the dictionary:

Command: (dictadd newdict &quot;DATA_RECORD_1&quot; xname)

&lt;Entity name: 1d98958&gt;

See Also

The <a class="Identifier" href="#dictnext">dictnext</a>, <a class="Identifier" href="#dictremove">dictremove</a>, <a class="Identifier" href="#dictrename">dictrename</a>, <a class="Identifier" href="#dictsearch">dictsearch</a>, and <a class="Identifier" href="#namedobjdict">namedobjdict</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dictnext">dictnext</h3>

Finds the next item in a dictionary

(dictnext ename <span class="Special">[rewind]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the dictionary being viewed.

rewind

If this argument is present and is not nil, the dictionary is rewound and the
first entry in it is retrieved.

<span class="ReturnsIdentifier">Return Values</span>

The next entry in the specified dictionary, or nil, when the end of the
dictionary is reached. Entries are returned as lists of dotted pairs of
DXF-type codes and values. Deleted dictionary entries are not returned.

The dictsearch function specifies the initial entry retrieved.

Use namedobjdict to obtain the master dictionary entity name.

<span class="Todo">Note</span>:  Once you begin stepping through the contents of a dictionary, passing a
different dictionary name to dictnext will cause the place to be lost in the
original dictionary. In other words, only one global iterator is maintained for
use in this function.

<span class="ExamplesIdentifier">Examples</span>

Create a dictionary and an entry as shown in the example for dictadd. Then make
another Xrecord object:

Command: (setq xname (entmakex datalist))

&lt;Entity name: 1b62d60&gt;

Add this Xrecord object to the dictionary, as the second record in the
dictionary:

Command: (dictadd newdict &quot;DATA_RECORD_2&quot; xname)

&lt;Entity name: 1b62d60&gt;

Return the entity name of the next entry in the dictionary:

Command: (cdr (car (dictnext newdict)))

&lt;Entity name: 1bac958&gt;

dictnext returns the name of the first entity added to the dictionary.

Return the entity name of the next entry in the dictionary:

Command: (cdr (car (dictnext newdict)))

&lt;Entity name: 1bac960&gt;

dictnext returns the name of the second entity added to the dictionary.

Return the entity name of the next entry in the dictionary:

Command: (cdr (car (dictnext newdict)))

nil

There are no more entries in the dictionary, so dictnext returns nil.

Rewind to the first entry in the dictionary and return the entity name of that
entry:

Command: (cdr (car (dictnext newdict T)))

&lt;Entity name: 1bac958&gt;

Specifying T for the optional rewind argument causes dictnext to return the
first entry in the dictionary.

See Also

The <a class="Identifier" href="#dictadd">dictadd</a>, <a class="Identifier" href="#dictremove">dictremove</a>, <a class="Identifier" href="#dictrename">dictrename</a>, <a class="Identifier" href="#dictsearch">dictsearch</a>, <a class="Identifier" href="#dictnext">dictnext</a>, and <a class="Identifier" href="#namedobjdict">namedobjdict</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dictremove">dictremove</h3>

Removes an entry from the specified dictionary

(dictremove ename symbol)

By default, removing an entry from a dictionary does not delete it from the
database. This must be done with a call to entdel. Currently the exceptions to
this rule are groups and mlinestyles. The code that implements these features
requires that the database and these dictionaries be up to date, and therefore
automatically deletes the entity when it is removed (with dictremove) from the
dictionary.

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the dictionary being modified.

symbol

The entry to be removed from ename.

The dictremove function does not allow the removal of an mlinestyle from the
mlinestyle dictionary if it is actively referenced by an mline in the database.

<span class="ReturnsIdentifier">Return Values</span>

The entity name of the removed entry. If ename is invalid or symbol is not
found, dictremove returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following example removes the dictionary created in the dictadd example:

Command: (dictremove (namedobjdict) &quot;my_way_cool_dictionary&quot;)

&lt;Entity name: 1d98950&gt;

See Also


The <a class="Identifier" href="#dictadd">dictadd</a>, <a class="Identifier" href="#dictnext">dictnext</a>, <a class="Identifier" href="#dictrename">dictrename</a>, <a class="Identifier" href="#dictsearch">dictsearch</a>, and <a class="Identifier" href="#namedobjdict">namedobjdict</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dictrename">dictrename</h3>

Renames a dictionary entry

(dictrename ename oldsym newsym)

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the dictionary being modified.

oldsym

Original key name of the entry.

newsym

New key name of the entry.

<span class="ReturnsIdentifier">Return Values</span>

The newsym value, if the rename is successful. If either the oldname is not
present in the dictionary, or ename is invalid, or newname is invalid, or
newname is already present in the dictionary, dictrename returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following example renames the dictionary created in the dictadd sample:

Command: (dictrename (namedobjdict) &quot;my_way_cool_dictionary&quot; &quot;An even cooler
dictionary&quot;)

&quot;An even cooler dictionary&quot;

See Also


The <a class="Identifier" href="#dictadd">dictadd</a>, <a class="Identifier" href="#dictnext">dictnext</a>, <a class="Identifier" href="#dictremove">dictremove</a>, <a class="Identifier" href="#dictsearch">dictsearch</a>, and <a class="Identifier" href="#namedobjdict">namedobjdict</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dictsearch">dictsearch</h3>

Searches a dictionary for an item

(dictsearch ename symbol <span class="Special">[setnext]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the dictionary being searched.

symbol

A string that specifies the item to be searched for within the dictionary.

setnext

If present and not nil, the dictnext entry counter is adjusted so the following
dictnext call returns the entry after the one returned by this dictsearch call.

<span class="ReturnsIdentifier">Return Values</span>

The entry for the specified item, if successful, or nil, if no entry is found.

<span class="ExamplesIdentifier">Examples</span>

The following example illustrates the use of dictsearch to obtain the
dictionary added in the dictadd example:

Command: (setq newdictlist (dictsearch (namedobjdict)
&quot;my_way_cool_dictionary&quot;))

((-1 . &lt;Entity name: 1d98950&gt;) (0 . &quot;DICTIONARY&quot;) (5 . &quot;52&quot;) (102 .
&quot;{ACAD_REACTORS&quot;) (330 . &lt;Entity name: 1d98860&gt;) (102 . &quot;}&quot;) (330 . &lt;Entity
name: 1d98860&gt;) (100 . &quot;AcDbDictionary&quot;) (280 . 0) (281 . 1) (3 .
&quot;DATA_RECORD_1&quot;) (350 . &lt;Entity name: 1d98958&gt;))

See Also

The <a class="Identifier" href="#dictnext">dictnext</a>, <a class="Identifier" href="#dictremove">dictremove</a>, <a class="Identifier" href="#dictsearch">dictsearch</a>, and <a class="Identifier" href="#namedobjdict">namedobjdict</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dimx_tile">dimx_tile</h3>

Retrieves the width of a tile in dialog box units

(dimx_tile key)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string specifying the tile to be queried. The key argument is case-sensitive.

<span class="ReturnsIdentifier">Return Values</span>

The width of the tile.

The coordinates returned are the maximum allowed within the tile. Because
coordinates are zero based, this function return one less than the total X
dimension (X-1). The dimx_tile and dimy_tile functions are provided for use
with vector_image, fill_image, and slide_image, which require you to specify
absolute tile coordinates.

<span class="ExamplesIdentifier">Examples</span>

(setq tile_width (dimx_tile &quot;my_tile&quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="dimy_tile">dimy_tile</h3>

Retrieves the height of a tile in dialog box units

(dimy_tile key)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string specifying the tile to be queried. The key argument is case-sensitive.

<span class="ReturnsIdentifier">Return Values</span>

The height of the tile.

The coordinates returned are the maximum allowed within the tile. Because
coordinates are zero based, this function return one less than the total Y
dimension (Y-1). The dimx_tile and dimy_tile functions are provided for use
with vector_image, fill_image, and slide_image, which require you to specify
absolute tile coordinates.

<span class="ExamplesIdentifier">Examples</span>

(setq tile_height (dimy_tile &quot;my_tile&quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="distance">distance</h3>

Returns the 3D distance between two points

(distance pt1 pt2)

<span class="ArgumentsIdentifier">Arguments</span>

pt1

A 2D or 3D point list.

pt1

A 2D or 3D point list.

<span class="ReturnsIdentifier">Return Values</span>

The distance.

If one or both of the supplied points is a 2D point, then distance ignores the
Z coordinates of any 3D points supplied and returns the 2D distance between the
points as projected into the current construction plane.

<span class="ExamplesIdentifier">Examples</span>

Command: (distance '(1.0 2.5 3.0) '(7.7 2.5 3.0))

6.7

Command: (distance '(1.0 2.0 0.5) '(3.0 4.0 0.5))

2.82843

See Also

The Geometric Utilities topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="distof">distof</h3>

Converts a string that represents a real (floating-point) value into a real
value

(distof string <span class="Special">[mode]</span>)

The distof and rtos functions are complementary. If you pass distof a string
created by rtos, distof is guaranteed to return a valid value, and vice versa
(assuming the mode values are the same).

<span class="ArgumentsIdentifier">Arguments</span>

string

A string to be converted. The argument must be a string that distof can parse
correctly according to the units specified by mode. It can be in the same form
that rtos returns, or in a form that AutoCAD allows for keyboard entry.

mode

The units in which the string is currently formatted. The mode corresponds to
the values allowed for the AutoCAD system variable LUNITS. Specify one of the
following numbers for mode:

1 Scientific

2 Decimal

3 Engineering (feet and decimal inches)

4 Architectural (feet and fractional inches)

5 Fractional

<span class="ReturnsIdentifier">Return Values</span>

A real number, if successful, otherwise nil.

<span class="Todo">Note</span>:  The distof function treats modes 3 and 4 the same. That is, if mode
specifies 3 (engineering) or 4 (architectural) units, and string is in either
of these formats, distof returns the correct real value.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="done_dialog">done_dialog</h3>

Terminates a dialog box

(done_dialog <span class="Special">[status]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

status

A positive integer that start_dialog will return instead of returning 1 for OK
or 0 for Cancel. The meaning of any status value greater than 1 is determined
by your application.

You must call done_dialog from within an action expression or callback function
(see action_tile ).

<span class="ReturnsIdentifier">Return Values</span>

A two-dimensional point list that is the (X,Y) location of the dialog box when
the user exited it.

<span class="Todo">Usage Notes</span>

If you provide a callback for the button whose key is &quot;accept&quot; or &quot;cancel&quot;
(usually the OK and Cancel buttons), the callback must call done_dialog
explicitly. If it doesn't, the user can be trapped in the dialog box. If you
don't provide an explicit callback for these buttons and use the standard exit
buttons, AutoCAD handles them automatically. Also, an explicit AutoLISP action
for the &quot;accept&quot; button must specify a status of 1 (or an application-defined
value); otherwise, start_dialog returns the default value, 0, which makes it
appear as if the dialog box was canceled.

<span class="PreProc">================================ E Functions ===================================</span>

<h3 class="String" id="end_image">end_image</h3>

Ends creation of the currently active dialog box image

(end_image)

This function is the complement of start_image.

<span class="ReturnsIdentifier">Return Values</span>

nil

See Also

The <a class="Identifier" href="#start_image">start_image</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="end_list">end_list</h3>

Ends processing of the currently active dialog box list

(end_list)

This function is the complement of start_list.

<span class="ReturnsIdentifier">Return Values</span>

nil

See Also

The <a class="Identifier" href="#add_list">add_list</a> and <a class="Identifier" href="#start_list">start_list</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entdel">entdel</h3>

Deletes objects (entities) or restores previously deleted objects

(entdel ename)

The entity specified by ename is deleted if it is currently in the drawing. The
entdel function restores the entity to the drawing if it has been deleted
previously in this editing session. Deleted entities are purged from the
drawing when the drawing is exited. The entdel function can delete both
graphical and nongraphical entities.

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the entity to be deleted or restored.

<span class="ReturnsIdentifier">Return Values</span>

The entity name.

Usage <span class="Todo">Notes</span>

The entdel function operates only on main entities. Attributes and polyline
vertices cannot be deleted independently of their parent entities. You can use
the command function to operate the ATTEDIT or PEDIT commands to modify
subentities.

You cannot delete entities within a block definition. However, you can
completely redefine a block definition, minus the entity you want deleted, with
entmake.

<span class="ExamplesIdentifier">Examples</span>

Get the name of the first entity in the drawing and assign it to variable e1:

Command: (setq e1 (entnext))

&lt;Entity name: 2c90520&gt;

Delete the entity named by e1:

Command: (entdel e1)

&lt;Entity name: 2c90520&gt;

Restore the entity named by e1:

Command: (entdel e1)

&lt;Entity name: 2c90520&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entget">entget</h3>

Retrieves an object's (entity's) definition data

(entget ename <span class="Special">[applist]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

ename

Name of the entity being queried. The ename can refer to either a graphical or
nongraphical entity.

applist

A list of registered application names.

<span class="ReturnsIdentifier">Return Values</span>

An association list containing the entity definition of ename. If you specify
the optional applist argument, entget also returns the extended data associated
with the specified applications. Objects in the list are assigned AutoCAD DXFTM
group codes for each part of the entity data.

<span class="Todo">Note</span> that the DXF group codes used by AutoLISP differ slightly from the group
codes in a DXF file. The AutoLISP DXF group codes are documented in the DXF
Reference .

<span class="ExamplesIdentifier">Examples</span>

Assume that the last object created in the drawing is a line drawn from point
(1,2) to point (6,5). The following example shows code that retrieves the
entity name of the last object with the entlast function, and passes that name
to entget:

Command: (entget (entlast))

((-1 . &lt;Entity name: 1bbd1d0&gt;) (0 . &quot;LINE&quot;) (330 . &lt;Entity name: 1bbd0c8&gt;) (5 .
&quot;6A&quot;) (100 . &quot;AcDbEntity&quot;) (67 . 0) (410 . &quot;Model&quot;) (8 . &quot;0&quot;) (100 .
&quot;AcDbLine&quot;) (10 1.0 2.0 0.0) (11 6.0 5.0 0.0) (210 0.0 0.0 1.0))

See Also

The <a class="Identifier" href="#entdel">entdel</a>, and <a class="Identifier" href="#entupd">entupd</a>
functions. See Entity Data Functions in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entlast">entlast</h3>

Returns the name of the last nondeleted main object (entity) in the drawing

(entlast)

The entlast function is frequently used to obtain the name of a new entity that
has just been added with the command function. To be selected, the entity need
not be on the screen or on a thawed layer.

<span class="ReturnsIdentifier">Return Values</span>

An entity name, or nil, if there are no entities in the current drawing.

<span class="ExamplesIdentifier">Examples</span>

Set variable e1 to the name of the last entity added to the drawing:

Command: (setq e1 (entlast))

&lt;Entity name: 2c90538&gt;

If your application requires the name of the last nondeleted entity (main
entity or subentity), define a function such as the following and call it
instead of entlast.

(defun lastent (/ a b)

 (if (setq a (entlast)) Gets last main entity

  (while (setq b (entnext a)) If subentities follow, loops

   until there are no more

   (setq a b) subentities

  )

 )

 a Returns last main entity

) or subentity

See Also

The <a class="Identifier" href="#entdel">entdel</a>, and <a class="Identifier" href="#entsel">entsel</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entmake">entmake</h3>

Creates a new entity in the drawing

(entmake <span class="Special">[elist]</span>)

The entmake function can define both graphical and nongraphical entities.

<span class="ArgumentsIdentifier">Arguments</span>

elist

A list of entity definition data in a format similar to that returned by the
entget function. The elist argument must contain all of the information
necessary to define the entity. If any required definition data is omitted,
entmake returns nil and the entity is rejected. If you omit optional definition
data (such as the layer), entmake uses the default value.

The entity type (for example, CIRCLE or LINE) must be the first or second field
of the elist. If entity type is the second field, it can be preceded only by
the entity name. The entmake function ignores the entity name when creating the
new entity. If the elist contains an entity handle, entmake ignores that too.

<span class="ReturnsIdentifier">Return Values</span>

If successful, entmake returns the entity's list of definition data. If entmake
is unable to create the entity, it returns nil.

Completion of a block definition (entmake of an endblk) returns the block's
name rather than the entity data list normally returned.

<span class="ExamplesIdentifier">Examples</span>

The following code creates a red circle (color 62), centered at (4,4) with a
radius of 1. The optional layer and linetype fields have been omitted and
therefore assume default values.

Command: (entmake '((0 . &quot;CIRCLE&quot;) (62 . 1) (10 4.0 4.0 0.0) (40 . 1.0)))

((0 . &quot;CIRCLE&quot;) (62 . 1) (10 4.0 4.0 0.0) (40 . 1.0))

<span class="Todo">Notes</span> on Using entmake

You cannot create viewport objects with entmake.

A group 66 code is honored only for insert objects (meaning attributes follow).
For polyline entities, the group 66 code is forced to a value of 1 (meaning
vertices follow), and for all other entities it takes a default of 0. The only
entity that can follow a polyline entity is a vertex entity.

The group code 2 (block name) of a dimension entity is optional for the entmake
function. If the block name is omitted from the entity definition list, AutoCAD
creates a new one. Otherwise, AutoCAD creates the dimension using the name
provided.

For legacy reasons, entmake ignores DXF group code 100 data for the following
entity types:

<span class="Statement">  </span>* AcDbText

<span class="Statement">  </span>* AcDbAttribute
<span class="Statement">  </span>* AcDbAttributeDefinition
<span class="Statement">  </span>* AcDbBlockBegin
<span class="Statement">  </span>* AcDbBlockEnd
<span class="Statement">  </span>* AcDbSequenceEnd
<span class="Statement">  </span>* AcDbBlockReference
<span class="Statement">  </span>* AcDbMInsertBlock
<span class="Statement">  </span>* AcDb2dVertex
<span class="Statement">  </span>* AcDb3dPolylineVertex
<span class="Statement">  </span>* AcDbPolygonMeshVertex
<span class="Statement">  </span>* AcDbPolyFaceMeshVertex
<span class="Statement">  </span>* AcDbFaceRecord
<span class="Statement">  </span>* AcDb2dPolyline
<span class="Statement">  </span>* AcDb3dPolyline
<span class="Statement">  </span>* AcDbArc
<span class="Statement">  </span>* AcDbCircle
<span class="Statement">  </span>* AcDbLine
<span class="Statement">  </span>* AcDbPoint
<span class="Statement">  </span>* AcDbFace
<span class="Statement">  </span>* AcDbPolyFaceMesh
<span class="Statement">  </span>* AcDbPolygonMesh
<span class="Statement">  </span>* AcDbTrace
<span class="Statement">  </span>* AcDbSolid
<span class="Statement">  </span>* AcDbShape

<span class="Statement">  </span>* AcDbViewport

See Also

The <a class="Identifier" href="#entdel">endtdel</a> and <a class="Identifier" href="#entmod">entmod</a> functions. In the Visual LISP Developer's
Guide, refer to Entity Data Functions for additional information on creating
entities in a drawing, Adding an Entity to a Drawing for specifics on using
<a class="Identifier" href="#entmake,">entmake,</a> and Creating Complex Entities for information on creating complex
entities.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entmakex">entmakex</h3>

Makes a new object or entity, gives it a handle and entity name (but, does not
assign an owner), and then returns the new entity name

(entmakex <span class="Special">[elist]</span>)

The entmakex function can define both graphical and nongraphical entities.

<span class="ArgumentsIdentifier">Arguments</span>

elist

A list of entity definition data in a format similar to that returned by the
entget function. The elist argument must contain all of the information
necessary to define the entity. If any required definition data is omitted,
entmakex returns nil and the entity is rejected. If you omit optional
definition data (such as the layer), entmakex uses the default value.

<span class="ReturnsIdentifier">Return Values</span>

If successful, entmakex returns the name of the entity created. If entmakex is
unable to create the entity, the function returns nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (entmakex '((0 . &quot;CIRCLE&quot;) (62 . 1) (10 4.0 3.0 0.0) (40 . 1.0)))

&lt;Entity name: 1d45558&gt;

Warning!  Objects and entities without owners are not written out to DWG or DXF
files. Be sure to set an owner at some point after using entmakex. For example,
you can use dictadd to set a dictionary to own an object.

See Also

The <a class="Identifier" href="#entmake">entmake</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entmod">entmod</h3>

Modifies the definition data of an object (entity)

(entmod elist)

The entmod function updates database information for the entity name specified
by the -1 group in elist. The primary mechanism through which AutoLISP updates
the database is by retrieving entities with entget, modifying the list defining
an entity, and updating the entity in the database with entmod. The entmod
function can modify both graphical and nongraphical objects.

<span class="ArgumentsIdentifier">Arguments</span>

elist

A list of entity definition data in a format similar to that returned by the
entget function.

For entity fields with floating-point values (such as thickness), entmod
accepts integer values and converts them to floating point. Similarly, if you
supply a floating-point value for an integer entity field (such as color
number), entmod truncates it and converts it to an integer.

<span class="ReturnsIdentifier">Return Values</span>

If successful, entmod returns the elist supplied to it. If entmod is unable to
modify the specified entity, the function returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following sequence of commands obtains the properties of an entity, then
modifies the entity.

Set the en1 variable to the name of the first entity in the drawing:

Command: (setq en1 (entnext))

&lt;Entity name: 2c90520&gt;

Set a variable named ed to the entity data of entity en1:

Command: (setq ed (entget en1))

((-1 . &lt;Entity name: 2c90520&gt;) (0 . &quot;CIRCLE&quot;) (5 . &quot;4C&quot;) (100 . &quot;AcDbEntity&quot;)
(67 . 0) (8 . &quot;0&quot;) (100 . &quot;AcDbCircle&quot;) (10 3.45373 6.21635 0.0) (40 . 2.94827)
(210 0.0 0.0 1.0))

Changes the layer group in ed from layer 0 to layer 1:

Command: (setq ed (subst (cons 8 &quot;1&quot;) (assoc 8 ed) ed ))

((-1 . &lt;Entity name: 2c90520&gt;) (0 . &quot;CIRCLE&quot;) (5 . &quot;4C&quot;) (100 . &quot;AcDbEntity&quot;)
(67 . 0) (8 . &quot;1&quot;) (100 . &quot;AcDbCircle&quot;) (10 3.45373 6.21635 0.0) (40 . 2.94827)
(210 0.0 0.0 1.0))

Modify the layer of the en1 entity in the drawing:

Command: (entmod ed)

((-1 . &lt;Entity name: 2c90520&gt;) (0 . &quot;CIRCLE&quot;) (5 . &quot;4C&quot;) (100 . &quot;AcDbEntity&quot;)
(67 . 0) (8 . &quot;1&quot;) (100 . &quot;AcDbCircle&quot;) (10 3.45373 6.21635 0.0) (40 . 2.94827)
(210 0.0 0.0 1.0))

Restrictions on Using entmod

There are restrictions on the changes the entmod function can make:

<span class="Statement">  </span>* An entity's type and handle cannot be changed. If you want to do this, use
    entdel to delete the entity, then make a new entity with the command or
    entmake functions.

<span class="Statement">  </span>* The entmod function cannot change internal fields such as the entity name
    in the -2 group of a seqend entity--attempts to change such fields are
    ignored.

<span class="Statement">  </span>* You cannot use the entmod function to modify a viewport entity.

You can change an entity's space visibility field to 0 or 1 (except for
viewport objects). If you use entmod to modify an entity within a block
definition, the modification affects all instances of the block in the drawing.

Before performing an entmod on vertex entities, you should read or write the
polyline entity's header. If the most recently processed polyline entity is
different from the one to which the vertex belongs, width information (the 40
and 41 groups) can be lost.

Warning!  You can use entmod to modify entities within a block definition, but
doing so can create a self-referencing block, which will cause AutoCAD to stop.

See Also

The <a class="Identifier" href="#entdel">entdel</a>, and <a class="Identifier" href="#entnext">entnext</a> functions. In the Visual
LISP Developer's Guide, refer to Modifying an Entity and Entity Data Functions
and the Graphics Screen.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entnext">entnext</h3>

Returns the name of the next object (entity) in the drawing

(entnext <span class="Special">[ename]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

ename

The name of an existing entity.

<span class="ReturnsIdentifier">Return Values</span>

If entnext is called with no arguments, it returns the entity name of the first
nondeleted entity in the database. If an ename argument is supplied to entnext,
the function returns the entity name of the first nondeleted entity following
ename in the database. If there is no next entity in the database, it returns
nil. The entnext function returns both main entities and subentities.

<span class="ExamplesIdentifier">Examples</span>

(setq e1 (entnext)) ; Sets e1 to the name of the first entity in the drawing

(setq e2 (entnext e1)) ; Sets e2 to the name of the entity following e1

<span class="Todo">Notes</span>

The entities selected by ssget are main entities, not attributes of blocks or
vertices of polylines. You can access the internal structure of these complex
entities by walking through the subentities with entnext. Once you obtain a
subentity's name, you can operate on it like any other entity. If you obtain
the name of a subentity with entnext, you can find the parent entity by
stepping forward with entnext until a seqend entity is found, then extracting
the -2 group from that entity, which is the main entity's name.

See Also

The <a class="Identifier" href="#entdel">entdel</a>, and <a class="Identifier" href="#entnext">entnext</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entsel">entsel</h3>

Prompts the user to select a single object (entity) by specifying a point

(entsel <span class="Special">[msg]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

msg

A prompt string to be displayed to users. If omitted, entsel prompts with the
message, &quot;Select object&quot;.

<span class="ReturnsIdentifier">Return Values</span>

A list whose first element is the entity name of the chosen object and whose
second element is the coordinates (in terms of the current UCS) of the point
used to pick the object.

The pick point returned by entsel does not represent a point that lies on the
selected object. The point returned is the location of the crosshairs at the
time of selection. The relationship between the pick point and the object will
vary depending on the size of the pickbox and the current zoom scale.

<span class="ExamplesIdentifier">Examples</span>

The following AutoCAD command sequence illustrates the use of the entsel
function and the list returned:

Command:  line

From point:  1,1

To point: 6,6

To point: ENTER

Command:  (setq e (entsel &quot;Please choose an object: &quot;))

Please choose an object:  3,3

(&lt;Entity name: 60000014&gt; (3.0 3.0 0.0))

Sometimes when operating on objects, you will want to simultaneously select an
object and specify the point by which it was selected. <span class="ExamplesIdentifier">Examples</span> of this in
AutoCAD can be found in Object Snap and in the BREAK, TRIM, and EXTEND
commands. The entsel function allows AutoLISP programs to perform this
operation. It selects a single object, requiring the selection to be a point
pick. The current Osnap setting is ignored by this function unless you
specifically request it while you are in the function. The entsel function
honors keywords from a preceding call to initget.

See Also

The <a class="Identifier" href="#entget">entget</a>, and <a class="Identifier" href="#entnext">entnext</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="entupd">entupd</h3>

Updates the screen image of an object (entity)

(entupd ename)

<span class="ArgumentsIdentifier">Arguments</span>

ename

The name of the entity to be updated on the screen.

<span class="ReturnsIdentifier">Return Values</span>

The entity (ename) updated, or nil, if nothing was updated.

<span class="ExamplesIdentifier">Examples</span>

Assuming that the first entity in the drawing is a 3D polyline with several
vertices, the following code modifies and redisplays the polyline:

(setq e1 (entnext)) ; Sets e1 to the polyline's entity name

(setq e2 (entnext e1)) ; Sets e2 to its first vertex

(setq ed (entget e2)) ; Sets ed to the vertex data

(setq ed

 (subst '(10 1.0 2.0)

  (assoc 10 ed) ; Changes the vertex's location in ed

  ed ; to point (1,2)

 )

)

(entmod ed) ; Moves the vertex in the drawing

(entupd e1) ; Regenerates the polyline entity e1

Updating Polylines and Blocks

When a 3D (or old-style) polyline vertex or block attribute is modified with
entmod, the entire complex entity is not updated on the screen. The entupd
function can be used to cause a modified polyline or block to be updated on the
screen. This function can be called with the entity name of any part of the
polyline or block; it need not be the head entity. While entupd is intended for
polylines and blocks with attributes, it can be called for any entity. It
always regenerates the entity on the screen, including all subentities.

<span class="Todo">Note</span>:  If entupd is used on a nested entity (an entity within a block) or on a
block that contains nested entities, some of the entities might not be
regenerated. To ensure complete regeneration, you must invoke the REGEN
command.

See Also

The <a class="Identifier" href="#entget">entget</a>, and <a class="Identifier" href="#entnext">entnext</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="eq">eq</h3>

Determines whether two expressions are identical

(eq expr1 expr2)

The eq function determines whether expr1 and expr2 are bound to the same object
(by setq, for example).

<span class="ArgumentsIdentifier">Arguments</span>

expr1

The expression to be compared.

expr2

The expression to compare with expr1.

<span class="ReturnsIdentifier">Return Values</span>

T if the two expressions are identical, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Given the following assignments:

(setq f1 '(a b c))

(setq f2 '(a b c))

(setq f3 f2)

Compare f1 and f3:

Command: (eq f1 f3)

nil

eq returns nil because f1 and f3, while containing the same value, do not refer
to the same list.

Compare f3 and f2:

Command: (eq f3 f2)

T

eq returns T because f3 and f2 refer to the same list.

See Also

The <a class="Identifier" href="#=">(equal to)</a>and <a class="Identifier" href="#equal">equal</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="equal">equal</h3>

Determines whether two expressions are equal

(equal expr1 expr2 <span class="Special">[fuzz]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

expr1

The expression to be compared.

expr2

The expression to compare with expr1.

fuzz

A real number defining the maximum amount by which expr1 and expr2 can differ
and still be considered equal.

When comparing two real numbers (or two lists of real numbers, as in points),
the two identical numbers can differ slightly if different methods are used to
calculate them. You can specify a fuzz amount to compensate for the difference
that may result from the different methods of calculation.

<span class="ReturnsIdentifier">Return Values</span>

T if the two expressions are equal (evaluate to the same value), nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Given the following assignments:

(setq f1 '(a b c))

(setq f2 '(a b c))

(setq f3 f2)

(setq a 1.123456)

(setq b 1.123457)

Compare f1 to f3:

Command: (equal f1 f3)

T

Compare f3 to f2:

Command: (equal f3 f2)

T

Compare a to b:

Command: (equal a b)

nil

The a and b variables differ by .000001.

Compare a to b:, with fuzz argument of .000001:

Command: (equal a b 0.000001)

T

The a and b variables differ by an amount equal to the specified fuzz factor,
so equal considers the variables equal.

Comparing the eq and equal Functions

If the eq function finds that two lists or atoms are the same, the equal
function also finds them to be the same.

Any atoms that the equal function determines to be the same are also found
equivalent by eq. However, two lists that equal determines to be the same may
be found to be different according to the eq function.

See Also

The <a class="Identifier" href="#="</a>(equal to)</a> and <a class="Identifier" href="#eq">eq</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="error_function">error_function</h3>
<span class="Todo">NOTE</span>: +error+ = (*error*)
A user-definable error-handling function

+error+ string

+error+ is not nil, it is executed as a function whenever an AutoLISP error
exists. AutoCAD passes one argument to +error+, which is a string
containing a description of the error.

+error+ function can include calls to the command function without
arguments (for example, (command)). This will cancel a previous AutoCAD command
called with the command function.

<span class="ReturnsIdentifier">Return Values</span>

This function does not return, except when using vl-exit-with-value .

<span class="ExamplesIdentifier">Examples</span>

The following function does the same thing that the AutoLISP standard error
handler does. It prints the word &quot;error,&quot; followed by a description:
(defun +error+ (msg)

 (princ &quot;error: &quot;)

 (princ msg)

 (princ)

)

See Also

The <a class="Identifier" href="#vl-exit-with-error">vl-exit-with-error</a>, <a class="Identifier" href="#vl-catch-all-apply">vl-catch-all-apply</a>,
<a class="Identifier" href="#vl-catch-all-error-message">vl-catch-all-error-message</a>, and <a class="Identifier" href="#vl-catch-all-error-p">vl-catch-all-error-p</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="eval">eval</h3>

Returns the result of evaluating an AutoLISP expression

(eval expr)

<span class="ArgumentsIdentifier">Arguments</span>

expr

The expression to be evaluated.

<span class="ReturnsIdentifier">Return Values</span>

The result of the expression, after evaluation.

<span class="ExamplesIdentifier">Examples</span>

First, set some variables:

Command: (setq a 123)

123

Command: (setq b 'a)

A

Now evaluate some expressions:

Command: (eval 4.0)

4.0

Command: (eval (abs -10))

10

Command: (eval a)

123

Command: (eval b)

123

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="exit">exit</h3>

Forces the current application to quit

(exit)

If exit is called, it returns the error message quit/exit abort and returns to
the AutoCAD Command prompt.

See Also

The <a class="Identifier" href="#quit">quit</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="exp">exp</h3>

Returns the constant e (a real number) raised to a specified power (the natural
antilog)

(exp num)

<span class="ArgumentsIdentifier">Arguments</span>

num

A real number.

<span class="ReturnsIdentifier">Return Values</span>

A real (num), raised to its natural antilogarithm.

<span class="ExamplesIdentifier">Examples</span>

Command: (exp 1.0)

2.71828

Command: (exp 2.2)

9.02501

Command: (exp -0.4)

0.67032

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="expand">expand</h3>

Allocates additional memory for AutoLISP

(expand n-expand)

<span class="ArgumentsIdentifier">Arguments</span>

n-expand

An integer indicating the amount of additional memory to be allocated. Memory
is allocated as follows:

<span class="Statement">  </span>* n-alloc free symbols
<span class="Statement">  </span>* n-alloc free strings
<span class="Statement">  </span>* n-alloc free usubrs
<span class="Statement">  </span>* n-alloc free reals
<span class="Statement">  </span>* n-alloc * n-expand cons cells

where n-alloc is the current segment size.

<span class="ReturnsIdentifier">Return Values</span>

An integer indicating the number of free conses divided by n-alloc.

<span class="ExamplesIdentifier">Examples</span>

Set the segment size to 100:

_$ (alloc 100)

1000

Allocate memory for two additional segments:

_$ (expand 2)

82

This ensures that AutoLISP now has memory available for at least 200 additional
symbols, strings, usubrs and reals each, and 8200 free conses.

See Also

The <a class="Identifier" href="#alloc">alloc</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="expt">expt</h3>

Returns a number raised to a specified power

(expt number power)

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

power

The power to raise number to.

<span class="ReturnsIdentifier">Return Values</span>

If both arguments are integers, the result is an integer, otherwise, the result
is a real.

<span class="ExamplesIdentifier">Examples</span>

Command: (expt 2 4)

16

Command: (expt 3.0 2.0)

9.0

<span class="PreProc">================================ F Functions ===================================</span>

<h3 class="String" id="fill_image">fill_image</h3>

Draws a filled rectangle in the currently active dialog box image tile

(fill_image x1 y1 width height color)

The first (upper-left) corner of the rectangle is located at (x1,y1) and the
second (lower-right) corner is located the relative distance (width,height)
from the first corner. The origin (0,0) is the upper-left corner of the image.
You can obtain the coordinates of the lower-right corner by calling the
dimension functions dimx_tile and dimy_tile.

The fill_image function must be used between start_image and end_image function
calls.

<span class="ArgumentsIdentifier">Arguments</span>

x1

X coordinate of the upper-left corner of the rectangle located at (x1,y1). Must
be a positive value.

y1

Y coordinate of upper-left corner. Must be a positive value.

width

Width of the fill area (in pixels), relative to x1.

height

Width of the fill area (in pixels), relative to y1.

color

An AutoCAD color number, or one of the logical color numbers shown in the
following table:

+------------------------------+--------------+--------------------------------+
|                      Symbolic names for color attribute                      |
+------------------------------+--------------+--------------------------------+
|         Color number         | ADI mnemonic |          Description           |
+------------------------------+--------------+--------------------------------+
| -2                           | BGLCOLOR     | Current background of the      |
|                              |              | AutoCAD drawing area           |
+------------------------------+--------------+--------------------------------+
| -15                          | DBGLCOLOR    | Current dialog box background  |
|                              |              | color                          |
+------------------------------+--------------+--------------------------------+
| -16                          | DFGLCOLOR    | Current dialog box foreground  |
|                              |              | color (text)                   |
+------------------------------+--------------+--------------------------------+
| -18                          | LINELCOLOR   | Current dialog box line color  |
+------------------------------+--------------+--------------------------------+
<span class="ReturnsIdentifier">Return Values</span>

An integer representing the fill color.

<span class="ExamplesIdentifier">Examples</span>

(setq color -2) ;; color of AutoCAD drawing area

(fill_image

 0

 0

 (dimx_tile &quot;slide_tile&quot;)

 (dimy_tile &quot;slide_tile&quot;)

 color

)

(end_image)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="findfile">findfile</h3>

Searches the AutoCAD library path for the specified file or directory

(findfile filename)

The findfile function makes no assumption about the file type or extension of
filename. If filename does not specify a drive/directory prefix, findfile
searches the AutoCAD library path. If a drive/directory prefix is supplied,
findfile looks only in that directory.

<span class="ArgumentsIdentifier">Arguments</span>

filename

Name of the file or directory to be searched for.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the fully qualified file name, or nil, if the specified
file or directory is not found.

The file name returned by findfile is suitable for use with the open function.

<span class="ExamplesIdentifier">Examples</span>

If the current directory is /AutoCAD and it contains the file abc.lsp, the
following function call retrieves the path name:

Command: (findfile &quot;abc.lsp&quot;)

&quot;C:\\Program Files\\AutoCAD\\abc.lsp&quot;

If you are editing a drawing in the /AutoCAD/drawings directory, the ACAD
environment variable is set to /AutoCAD/support, and the file xyz.txt
exists only in the /AutoCAD/support directory, then the following command
retrieves the path name:

Command: (findfile &quot;xyz.txt&quot;)

&quot;C:\\Program Files\\AutoCAD\\support\\xyz.txt&quot;

If the file nosuch is not present in any of the directories on the library
search path, findfile returns nil:

Command: (findfile &quot;nosuch&quot;)

nil

<span class="Todo">Note</span> that prior to AutoCAD Release 14, findfile only returned a path if you
supplied a valid file name as your argument. If you supplied a directory path,
findfile returned nil even if the path existed. For example, the following call
to findfile returns a path name in AutoCAD:

Command: (findfile &quot;c:/program files/AutoCAD&quot;)

&quot;C:\\program files\\AutoCAD&quot;

In AutoCAD Release 13, the same command returns nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="fix">fix</h3>

Returns the conversion of a real number into the nearest smaller integer

(fix number)

The fix function truncates number to the nearest integer by discarding the
fractional portion.

<span class="ArgumentsIdentifier">Arguments</span>

number

A real number.

<span class="ReturnsIdentifier">Return Values</span>

The integer derived from number.

If number is larger than the largest possible integer (+2,147,483,647 or
-2,147,483,648 on a 32-bit platform), fix returns a truncated real (although
integers transferred between AutoLISP and AutoCAD are restricted to 16-bit
values).

<span class="ExamplesIdentifier">Examples</span>

Command: (fix 3)

3

Command: (fix 3.7)

3

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="float">float</h3>

Returns the conversion of a number into a real number

(float number)

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

<span class="ReturnsIdentifier">Return Values</span>

The real number derived from number.

<span class="ExamplesIdentifier">Examples</span>

Command: (float 3)

3.0

Command: (float 3.75)

3.75

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="foreach">foreach</h3>

Evaluates expressions for all members of a list

(foreach name list [expr...])

The foreach function steps through a list, assigning each element in the list
to a variable, and evaluates each expression for every element in the list. Any
number of expressions can be specified.

<span class="ArgumentsIdentifier">Arguments</span>

name

Variable that each element in the list will be assigned to.

list

List to be stepped through and evaluated.

expr

Expression to be evaluated for each element in list.

<span class="ReturnsIdentifier">Return Values</span>

The result of the last expr evaluated. If no expr is specified, foreach returns
nil.

<span class="ExamplesIdentifier">Examples</span>

Print each element in a list:

Command: (foreach n '(a b c) (print n))

A

B

C C

foreach prints each element in the list and returns C, the last element. This
command is equivalent to the following sequence of commands:

(print a)

(print b)

(print c)

except that foreach returns the result of only the last expression evaluated.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="function">function</h3>

Tells the Visual LISPTM compiler to link and optimize an argument as if it were
a built-in function

(function symbol | lambda-expr)

The function function is identical to the quote function, except it tells the
Visual LISP compiler to link and optimize the argument as if it were a built-in
function or defun.

Compiled lambda expressions that are quoted by function will contain debugging
information when loaded into the Visual LISP IDE.

<span class="ArgumentsIdentifier">Arguments</span>

symbol

A symbol naming a function.

lambda-expr

An expression of the following form:

(LAMBDA arguments <span class="Special">{S-expression}</span>* )

<span class="ReturnsIdentifier">Return Values</span>

The result of the evaluated expression.

<span class="ExamplesIdentifier">Examples</span>

The Visual LISP compiler cannot optimize the quoted lambda expression in the
following code:

(mapcar

 '(lambda (x) (* x x))

 '(1 2 3))

After adding the function function to the expression, the compiler can optimize
the lambda expression. For example:

(mapcar

 (function (lambda (x) (* x x)))

 '(1 2 3))

<span class="PreProc">================================ G Functions ===================================</span>

<h3 class="String" id="gc">gc</h3>

Forces a garbage collection, which frees up unused memory

(gc)

See Also

The Memory Management Functions topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="gcd">gcd</h3>

Returns the greatest common denominator of two integers

(gcd int1 int2)

<span class="ArgumentsIdentifier">Arguments</span>

int1

An integer; must be greater than 0.

int2

An integer; must be greater than 0.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the greatest common denominator between int1 and int2.

<span class="ExamplesIdentifier">Examples</span>

Command: (gcd 81 57)

3

Command: (gcd 12 20)

4

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="get_attr">get_attr</h3>

Retrieves the DCL value of a dialog box attribute

(get_attr key attribute)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the tile. This parameter is case-sensitive.

attribute

A string naming the attribute as it appears in the tile's DCL description.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the attribute's initial value as specified in its DCL
description.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="get_tile">get_tile</h3>

Retrieves the current runtime value of a dialog box tile

(get_tile key)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the tile. This parameter is case-sensitive.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the tile's value.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getangle">getangle</h3>

Pauses for user input of an angle, and returns that angle in radians

(getangle <span class="Special">[pt]</span> <span class="Special">[msg]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

pt

A 2D base point in the current UCS.

The pt argument, if specified, is assumed to be the first of two points, so the
user can show AutoLISP the angle by pointing to one other point. You can supply
a 3D base point, but the angle is always measured in the current construction
plane.

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

The angle specified by the user, in radians.

The getangle function measures angles with the zero-radian direction (set by
the ANGBASE system variable) with angles increasing in the counterclockwise
direction. The returned angle is expressed in radians with respect to the
current construction plane (the XY plane of the current UCS, at the current
elevation).

<span class="ExamplesIdentifier">Examples</span>

The following code examples show how different arguments can be used with
getangle:

Command: (setq ang (getangle))

Command: (setq ang (getangle '(1.0 3.5)))

Command: (setq ang (getangle &quot;Which way? &quot;))

Command: (setq ang (getangle '(1.0 3.5) &quot;Which way? &quot;))

Usage <span class="Todo">Notes</span>

Users can specify an angle by entering a number in the AutoCAD current angle
units format. Although the current angle units format might be in degrees,
grads, or some other unit, this function always returns the angle in radians.
The user can also show AutoLISP the angle by pointing to two 2D locations in
the drawing area. AutoCAD draws a rubber-band line from the first point to the
current crosshairs position to help you visualize the angle.

It is important to understand the difference between the input angle and the
angle returned by getangle. Angles that are passed to getangle are based on the
current settings of ANGDIR and ANGBASE. However, once an angle is provided, it
is measured in a counterclockwise direction (ignoring ANGDIR) with zero radians
as the current setting of ANGBASE.

The user cannot enter another AutoLISP expression as the response to a getangle
request.

See Also

The illustration and comparison to the <a class="Identifier" href="#getorient">getorient</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getcfg">getcfg</h3>

Retrieves application data from the AppData section of the acad.cfg file

(getcfg cfgname)

<span class="ArgumentsIdentifier">Arguments</span>

cfgname

A string (maximum length of 496 characters) naming the section and parameter
value to retrieve.

The cfgname argument must be a string of the following form:

&quot;AppData/application_name/section_name/.../param_name&quot;

<span class="ReturnsIdentifier">Return Values</span>

Application data, if successful. If cfgname is not valid, getcfg returns nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming the WallThk parameter in the AppData/ArchStuff section has a value of
8, the following command retrieves that value:

Command: (getcfg &quot;AppData/ArchStuff/WallThk&quot;)

&quot;8&quot;

See Also

The <a class="Identifier" href="#setcfg">setcfg</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getcname">getcname</h3>

Retrieves the localized or English name of an AutoCAD command

(getcname cname)

<span class="ArgumentsIdentifier">Arguments</span>

cname

The localized or underscored English command name; must be 64 characters or
less in length.

<span class="ReturnsIdentifier">Return Values</span>

If cname is not preceded by an underscore (assumed to be the localized command
name), getcname returns the underscored English command name. If cname is
preceded by an underscore, getcname returns the localized command name. This
function returns nil if cname is not a valid command name.

<span class="ExamplesIdentifier">Examples</span>

In a French version of AutoCAD, the following is true.

(getcname &quot;ETIRER&quot;) returns &quot;_STRETCH&quot;

(getcname &quot;_STRETCH&quot;) returns &quot;ETIRER&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getcorner">getcorner</h3>

Pauses for user input of a rectangle's second corner

(getcorner pt <span class="Special">[msg]</span>)

The getcorner function takes a base point argument, based on the current UCS,
and draws a rectangle from that point as the user moves the crosshairs on the
screen.

The user cannot enter another AutoLISP expression in response to a getcorner
request.

<span class="ArgumentsIdentifier">Arguments</span>

pt

A point to be used as the base point.

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

The getcorner function returns a point in the current UCS, similar to getpoint.
If the user supplies a 3D point, its Z coordinate is ignored. The current
elevation is used as the Z coordinate.

<span class="ExamplesIdentifier">Examples</span>

Command: (getcorner '(7.64935 6.02964 0.0))

(17.2066 1.47628 0.0)

Command: (getcorner '(7.64935 6.02964 0.0) &quot;Pick a corner&quot;)

Pick a corner(15.9584 2.40119 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getdist">getdist</h3>

Pauses for user input of a distance

(getdist <span class="Special">[pt]</span> <span class="Special">[msg]</span>)

The user can specify the distance by selecting two points, or by specifying
just the second point, if a base point is provided. The user can also specify a
distance by entering a number in the AutoCAD current distance units format.
Although the current distance units format might be in feet and inches
(architectural), the getdist function always returns the distance as a real.

The getdist function draws a rubber-band line from the first point to the
current crosshairs position to help the user visualize the distance.

The user cannot enter another AutoLISP expression in response to a getdist
request.

<span class="ArgumentsIdentifier">Arguments</span>

pt

A 2D or 3D point to be used as the base point in the current UCS. If pt is
provided, the user is prompted for the second point.

msg

A string to be displayed to prompt the user. If no string is supplied, AutoCAD
does not display a message.

<span class="ReturnsIdentifier">Return Values</span>

A real number. If a 3D point is provided, the returned value is a 3D distance.
However, setting the 64 bit of the initget function instructs getdist to ignore
the Z component of 3D points and to return a 2D distance.

<span class="ExamplesIdentifier">Examples</span>

(setq dist (getdist))

(setq dist (getdist '(1.0 3.5)))

(setq dist (getdist &quot;How far &quot;))

(setq dist (getdist '(1.0 3.5) &quot;How far? &quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getenv">getenv</h3>

Returns the string value assigned to a system environment variable

(getenv variable-name)

<span class="ArgumentsIdentifier">Arguments</span>

variable-name

A string specifying the name of the variable to be read. Environment variable
names must be spelled and cased exactly as they are stored in the system
registry.

<span class="ReturnsIdentifier">Return Values</span>

A string representing the value assigned to the specified system variable. If
the variable does not exist, getenv returns nil.

<span class="ExamplesIdentifier">Examples</span>

Assume the system environment variable ACAD is set to /acad/support and there
is no variable named NOSUCH.

Command: (getenv &quot;ACAD&quot;)

&quot;/acad/support&quot;

Command: (getenv &quot;NOSUCH&quot;)

nil

Assume that the MaxArray environment variable is set to 10000:

Command: (getenv &quot;MaxArray&quot;)

&quot;10000&quot;

See Also

The <a class="Identifier" href="#setenv">setenv</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getfiled">getfiled</h3>

Prompts the user for a file name with the standard AutoCAD file dialog box, and
returns that file name

(getfiled title default ext flags)

The getfiled function displays a dialog box containing a list of available
files of a specified extension type. You can use this dialog box to browse
through different drives and directories, select an existing file, or specify
the name of a new file.

<span class="ArgumentsIdentifier">Arguments</span>

title

A string specifying the dialog box label.

default

A default file name to use; can be a null string (&quot;&quot;).

ext

The default file name extension. If ext is passed as a null string (&quot;&quot;), it
defaults to * (all file types).

If the file type dwg is included in the ext argument, the getfiled function
displays an image preview in the dialog.

flags

An integer value (a bit-coded field) that controls the behavior of the dialog
box. To set more than one condition at a time, add the values together to
create a flags value between 0 and 15. The following flags arguments are
recognized by getfiled:

1 (bit 0) Prompt for the name of a new file to create. Do not set this bit when
you prompt for the name of an existing file to open. In the latter case, if the
user enters the name of a file that doesn't exist, the dialog box displays an
error message at the bottom of the box.

If this bit is set and the user chooses a file that already exists, AutoCAD
displays an alert box and offers the choice of proceeding with or canceling the
operation.

4 (bit 2) Let the user enter an arbitrary file name extension, or no extension
at all.

If this bit is not set, getfiled accepts only the extension specified in the
ext argument and appends this extension to the file name if the user doesn't
enter it in the File text box.

8 (bit 3) If this bit is set and bit 0 is not set, getfiled performs a library
search for the file name entered. If it finds the file and its directory in the
library search path, it strips the path and returns only the file name. (It
does not strip the path name if it finds that a file of the same name is in a
different directory.)

If this bit is not set, getfiled returns the entire file name, including the
path name.

Set this bit if you use the dialog box to open an existing file whose name you
want to save in the drawing (or other database).

16 (bit 4) If this bit is set, or if the default argument ends with a path
delimiter, the argument is interpreted as a path name only. The getfiled
function assumes that there is no default file name. It displays the path in
the Look in: line and leaves the File name box blank.

32 (bit 5) If this bit is set and bit 0 is set (indicating that a new file is
being specified), users will not be warned if they are about to overwrite an
existing file. The alert box to warn users that a file of the same name already
exists will not be displayed; the old file will just be replaced.

64 (bit 6) Do not transfer the remote file if the user specifies a URL.

128 (bit 7) Do not allow URLs at all.

<span class="ReturnsIdentifier">Return Values</span>

If the dialog box obtains a file name from the user, getfiled returns a string
that specifies the file name; otherwise, it returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following call to getfiled displays the Select a Lisp File dialog box:

(getfiled &quot;Select a Lisp File&quot; &quot;c:/program files/AutoCAD/
support/&quot; &quot;lsp&quot; 8)

AutoCAD displays the following dialog box as a result:

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getint">getint</h3>

Pauses for user input of an integer, and returns that integer

(getint <span class="Special">[msg]</span>)

Values passed to getint can range from -32,768 to +32,767. If the user enters
something other than an integer, getint displays the message &quot;Requires an
integer value,&quot; and allows the user to try again. The users cannot enter
another AutoLISP expression as the response to a getint request.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string to be displayed to prompt the user; if omitted, no message is
displayed.

<span class="ReturnsIdentifier">Return Values</span>

The integer specified by the user; or nil, if the user presses ENTER without
entering an integer.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq num (getint))

15

15

Command: (setq num (getint &quot;Enter a number:&quot;))

Enter a number:25

25

Command: (setq num (getint))

15.0

Requires an integer value.

15

15

See Also

The <a class="Identifier" href="#initget">initget</a> function in this reference and The getxxx Functions in the Visual
LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getkword">getkword</h3>

Pauses for user input of a keyword, and returns that keyword

(getkword <span class="Special">[msg]</span>)

Valid keywords are set prior to the getkword call with the initget function.
The user cannot enter another AutoLISP expression as the response to a getkword
request.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string to be displayed to prompt the user; if omitted, getkword does not
display a prompting message.

<span class="ReturnsIdentifier">Return Values</span>

A string representing the keyword entered by the user, or nil, if the user
presses ENTER without typing a keyword. The function also returns nil if it was
not preceded by a call to initget to establish one or more keywords.

If the user enters a value that is not a valid keyword, getkword displays a
warning message and prompts the user to try again.

<span class="ExamplesIdentifier">Examples</span>

The following example shows an initial call to initget that sets up a list of
keywords (Yes and No) and disallows null input (bits value equal to 1) to the
getkword call that follows:

Command: (initget 1 &quot;Yes No&quot;)

nil

Command: (setq x (getkword &quot;Are you sure? (Yes or No) &quot;))

Are you sure? (Yes or No) yes

&quot;Yes&quot;

The following sequence illustrates what happens if the user enters invalid
input in response to getkword:

Command: (initget 1 &quot;Yes No&quot;)

nil

Command: (setq x (getkword &quot;Are you sure? (Yes or No) &quot;))

Are you sure? (Yes or No) Maybe

Invalid option keyword.

Are you sure? (Yes or No) yes

&quot;Yes&quot;

The user's response was not one of the keywords defined by the preceding
initget, so getkword issued an error message and then prompted the user again
with the string supplied in the msg argument.

See Also

The <a class="Identifier" href="#initget">initget</a> function in this reference and The getxxx Functions in the Visual
LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getorient">getorient</h3>

Pauses for user input of an angle, and returns that angle in radians

(getorient <span class="Special">[pt]</span> <span class="Special">[msg]</span>)

The getorient function measures angles with the zero-radian direction to the
right (east) and angles that are increasing in the counterclockwise direction.
The angle input by the user is based on the current settings of ANGDIR and
ANGBASE, but once an angle is provided, it is measured in a counterclockwise
direction, with zero radians being to the right (ignoring ANGDIR and ANGBASE).
Therefore, some conversion must take place if you select a different
zero-degree base or a different direction for increasing angles by using the
UNITS command or the ANGBASE and ANGDIR system variables.

Use getangle when you need a rotation amount (a relative angle). Use getorient
to obtain an orientation (an absolute angle).

The user cannot enter another AutoLISP expression as the response to a
getorient request.

<span class="ArgumentsIdentifier">Arguments</span>

pt

A 2D base point in the current UCS.

The pt argument, if specified, is assumed to be the first of two points, so
that the user can show AutoLISP the angle by pointing to one other point. You
can supply a 3D base point, but the angle is always measured in the current
construction plane.

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

The angle specified by the user, in radians, with respect to the current
construction plane.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq pt1 (getpoint &quot;Pick point: &quot;))

(4.55028 5.84722 0.0)

Command: (getorient pt1 &quot;Pick point: &quot;)

5.61582

See Also

The <a class="Identifier" href="#getangle">getangle</a> function in this reference and The getxxx Functions in the
Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getpoint">getpoint</h3>

Pauses for user input of a point, and returns that point

(getpoint <span class="Special">[pt]</span> <span class="Special">[msg]</span>)

The user can specify a point by pointing or by entering a coordinate in the
current units format. If the pt argument is present, AutoCAD draws a
rubber-band line from that point to the current crosshairs position.

The user cannot enter another AutoLISP expression in response to a getpoint
request.

<span class="ArgumentsIdentifier">Arguments</span>

pt

A 2D or 3D base point in the current UCS.

<span class="Todo">Note</span> that getpoint will accept a single integer or real number as the pt
argument, and use the AutoCAD direct distance entry mechanism to determine a
point. This mechanism uses the value of the LASTPOINT system variable as the
starting point, the pt input as the distance, and the current cursor location
as the direction from LASTPOINT. The result is a point that is the specified
number of units away from LASTPOINT in the direction of the current cursor
location.

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point, expressed in terms of the current UCS.

<span class="ExamplesIdentifier">Examples</span>

(setq p (getpoint))

(setq p (getpoint &quot;Where? &quot;))

(setq p (getpoint '(1.5 2.0) &quot;Second point: &quot;))

See Also

The <a class="Identifier" href="#getcorner">getcorner</a>and <a class="Identifier" href="#initget">initget</a> functions in this reference and The getxxx
Functions in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getreal">getreal</h3>

Pauses for user input of a real number, and returns that real number

(getreal <span class="Special">[msg]</span>)

The user cannot enter another AutoLISP expression as the response to a getreal
request.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

The real number entered by the user.

<span class="ExamplesIdentifier">Examples</span>

(setq val (getreal))

(setq val (getreal &quot;Scale factor: &quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getstring">getstring</h3>

Pauses for user input of a string, and returns that string

(getstring <span class="Special">[cr]</span> <span class="Special">[msg]</span>)

The user cannot enter another AutoLISP expression as the response to a
getstring request.

<span class="ArgumentsIdentifier">Arguments</span>

cr

If supplied and not nil, this argument indicates that users can include blanks
in their input string (and must terminate the string by pressing ENTER).
Otherwise, the input string is terminated by space or ENTER.

msg

A string to be displayed to prompt the user.

<span class="ReturnsIdentifier">Return Values</span>

The string entered by the user, or nil, if the user pressed ENTER without
typing a string.

If the string is longer than 132 characters, getstring returns only the first
132 characters of the string. If the input string contains the backslash
character (\), getstring converts it to two backslash characters (\\). This
allows you to use returned values containing file name paths in other
functions.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq s (getstring &quot;What's your first name? &quot;))

What's your first name? Gary

&quot;Gary&quot;

Command: (setq s (getstring T &quot;What's your full name? &quot;))

What's your full name? Gary Indiana Jones

&quot;Gary Indiana Jones&quot;

Command: (setq s (getstring T &quot;Enter filename: &quot;))

Enter filename: c:\my documents\vlisp\secrets

&quot;c:\\my documents\\vlisp\\secrets&quot;

See Also

The <a class="Identifier" href="#initget">initget</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="getvar">getvar</h3>

Retrieves the value of an AutoCAD system variable

(getvar varname)

<span class="ArgumentsIdentifier">Arguments</span>

varname

A string or symbol that names a system variable. See the Command Reference for
a list of current AutoCAD system variables.

<span class="ReturnsIdentifier">Return Values</span>

The value of the system variable, or nil, if varname is not a valid system
variable.

<span class="ExamplesIdentifier">Examples</span>

Get the current value of the fillet radius:

Command: (getvar 'FILLETRAD)

0.25

See Also

The <a class="Identifier" href="#setvar">setvar</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="graphscr">graphscr</h3>

Displays the AutoCAD graphics screen

(graphscr)

This function is equivalent to the GRAPHSCR command or pressing the Flip Screen
function key. The textscr function is the complement of graphscr.

Returns

nil

See Also

The <a class="Identifier" href="#textscr">textscr</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="grclear">grclear</h3>

Clears the current viewport (obsolete function)

(grclear)

Returns

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="grdraw">grdraw</h3>

Draws a vector between two points, in the current viewport

(grdraw from to color <span class="Special">[highlight]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

from

2D or 3D points (lists of two or three reals) specifying one endpoint of the
vector in terms of the current UCS. AutoCAD clips the vector to fit the screen.

to

2D or 3D points (lists of two or three reals) specifying the other endpoint of
the vector in terms of the current UCS. AutoCAD clips the vector to fit the
screen.

color

An integer identifying the color used to draw the vector. A -1 signifies XOR
ink, which complements anything it draws over and which erases itself when
overdrawn.

highlight

An integer, other than zero, indicating that the vector is to be drawn using
the default highlighting method of the display device (usually dashed).

If highlight is omitted or is zero, grdraw uses the normal display mode.

<span class="ReturnsIdentifier">Return Values</span>

nil

See Also

The <a class="Identifier" href="#grvecs">grvecs</a> function for a routine that draws multiple vectors.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="grread">grread</h3>

Reads values from any of the AutoCAD input devices

(grread <span class="Special">[track]</span> [allkeys <span class="Special">[curtype]</span>])

Only specialized AutoLISP routines need this function. Most input to AutoLISP
should be obtained through the various getxxx functions.

<span class="ArgumentsIdentifier">Arguments</span>

track

If supplied and not nil, this argument enables the return of coordinates from a
pointing device as it is moved

allkeys

An integer representing a code that tells grread what functions to perform. The
allkeys bit code values can be added together for combined functionality. The
following values can be specified:

1 (bit 0) Return drag mode coordinates. If this bit is set and the user moves
the pointing device instead of selecting a button or pressing a key, grread
returns a list where the first member is a type 5 and the second member is the
(X,Y) coordinates of the current pointing device (mouse or digitizer) location.
This is how AutoCAD implements dragging.

2 (bit 1) Return all key values, including function and cursor key codes, and
don't move the cursor when the user presses a cursor key.

4 (bit 2) Use the value passed in the curtype argument to control the cursor
display.

8 (bit 3) Don't display the error: console break message when the user presses
ESC.

curtype

An integer indicating the type of cursor to be displayed. The allkeys value for
bit 2 must be set for the curtype values to take effect. The curtype argument
affects only the cursor type during the current grread function call. You can
specify one of the following values for curtype:

0 Display the normal crosshairs.

1 Do not display a cursor (no crosshairs).

2 Display the object-selection &quot;target&quot; cursor.

<span class="ReturnsIdentifier">Return Values</span>

The grread function returns a list whose first element is a code specifying the
type of input. The second element of the list is either an integer or a point,
depending on the type of input. The return values are listed in the following
table:

+----------------+-------------------------+---------------+-------------------+
|                             grread return values                             |
+----------------+-------------------------+---------------+-------------------+
|              First element               |          Second element           |
+----------------+-------------------------+---------------+-------------------+
|     Value      |      Type of input      |     Value     |    Description    |
+----------------+-------------------------+---------------+-------------------+
| 2              | Keyboard input          | varies        | Character code    |
+----------------+-------------------------+---------------+-------------------+
| 3              | Selected point          | 3D point      | Point coordinates |
+----------------+-------------------------+---------------+-------------------+
| 4              | Screen/pull-down menu   | 0 to 999      | Screen menu box   |
|                | item (from pointing     | 1001 to 1999  | no.               |
|                | device)                 | 2001 to 2999  | POP1 menu box no. |
|                |                         | 3001 to 3999  | POP2 menu box no. |
|                |                         | ... and so    | POP3 menu box no. |
|                |                         | on, to        | ... and so on, to |
|                |                         | 16001 to      | POP16 menu box    |
|                |                         | 16999         | no.               |
+----------------+-------------------------+---------------+-------------------+
| 5              | Pointing device         | 3D point      | Drag mode         |
|                | (returned only if       |               | coordinate        |
|                | tracking is enabled)    |               |                   |
+----------------+-------------------------+---------------+-------------------+
| 6              | BUTTONS menu item       | 0 to 999      | BUTTONS1 menu     |
|                |                         | 1000 to 1999  | button no.        |
|                |                         | 2000 to 2999  | BUTTONS2 menu     |
|                |                         | 3000 to 3999  | button no.        |
|                |                         |               | BUTTONS3 menu     |
|                |                         |               | button no.        |
|                |                         |               | BUTTONS4 menu     |
|                |                         |               | button no.        |
+----------------+-------------------------+---------------+-------------------+
| 7              | TABLET1 menu item       | 0 to 32767    | Digitized box no. |
+----------------+-------------------------+---------------+-------------------+
| 8              | TABLET2 menu item       | 0 to 32767    | Digitized box no. |
+----------------+-------------------------+---------------+-------------------+
| 9              | TABLET3 menu item       | 0 to 32767    | Digitized box no. |
+----------------+-------------------------+---------------+-------------------+
| 10             | TABLET4 menu item       | 0 to 32767    | Digitized box no. |
+----------------+-------------------------+---------------+-------------------+
| 11             | AUX menu item           | 0 to 999      | AUX1 menu button  |
|                |                         | 1000 to 1999  | no.               |
|                |                         | 2000 to 2999  | AUX2 menu button  |
|                |                         | 3000 to 3999  | no.               |
|                |                         |               | AUX3 menu button  |
|                |                         |               | no.               |
|                |                         |               | AUX4 menu button  |
|                |                         |               | no.               |
+----------------+-------------------------+---------------+-------------------+
| 12             | Pointer button          | 3D point      | Point coordinates |
|                | (follows a type 6 or    |               |                   |
|                | type 11 return)         |               |                   |
+----------------+-------------------------+---------------+-------------------+
Handling User Input with grread

Entering ESC while a grread is active aborts the AutoLISP program with a
keyboard break (unless the allkeys argument has disallowed this). Any other
input is passed directly to grread, giving the application complete control
over the input devices.

If the user presses the pointer button within a screen menu or pull-down menu
box, grread returns a type 6 or type 11 code, but in a subsequent call, it does
not return a type 12 code: the type 12 code follows type 6 or type 11 only when
the pointer button is pressed while it is in the drawing area.

It is important to clear the code 12 data from the buffer before attempting
another operation with a pointer button or an auxiliary button. To accomplish
this, perform a nested grread like this:

(setq code_12 (grread (setq code (grread))))

This sequence captures the value of the code 12 list as streaming input from
the device.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="grtext">grtext</h3>

Writes text to the status line or to screen menu areas

(grtext [box text <span class="Special">[highlight]</span>])

This function displays the supplied text in the menu area; it does not change
the underlying menu item. The grtext function can be called with no arguments
to restore all text areas to their standard values.

<span class="ArgumentsIdentifier">Arguments</span>

box

An integer specifying the location in which to write the text.

text

A string that specifies the text to be written to the screen menu or status
line location. The text argument is truncated if it is too long to fit in the
available area.

highlight

An integer that selects or deselects a screen menu location.

If called without arguments, grtext restores all text areas to their standard
values. If called with only one argument, grtext results in an error.

<span class="ReturnsIdentifier">Return Values</span>

The string passed in the text argument, if successful, and nil if unsuccessful
or no arguments are supplied.

Screen Menu Area

Setting box to a positive or zero value specifies a screen menu location. Valid
box values range from 0 to the highest-numbered screen menu box minus 1. The
SCREENBOXES system variable reports the maximum number of screen menu boxes. If
the highlight argument is supplied as a positive integer, grtext highlights the
text in the designated box. Highlighting a box automatically dehighlights any
other box already highlighted. If highlight is zero, the menu item is
dehighlighted. If highlight is a negative number, it is ignored. On some
platforms, the text must first be written without the highlight argument and
then must be highlighted. Highlighting of a screen menu location works only
when the cursor is not in that area.

Status Line Area

If grtext is called with a box value of -1, it writes the text into the mode
status line area. The length of the mode status line differs from display to
display (most allow at least 40 characters). The following code uses the
$(linelen) DIESEL expression to report the length of the mode status area.

(setq modelen (menucmd &quot;M=$(linelen)&quot;))

If a box value of -2 is used, grtext writes the text into the coordinate status
line area. If coordinate tracking is turned on, values written into this field
are overwritten as soon as the pointer sends another set of coordinates. For
both -1 or -2 box values, the highlight argument is ignored.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="grvecs">grvecs</h3>

Draws multiple vectors in the drawing area

(grvecs vlist <span class="Special">[trans]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

vlist

A vector list is comprised of a series of optional color integers and two point
lists. See  &lt;PARAM name=&quot;Item2&quot; value=&quot;Vector List Format;vlref132.html&quot;&gt; for
details on how to format vlist.

trans

A transformation matrix used to change the location or proportion of the
vectors defined in your vector list. This matrix is a list of four lists of
four real numbers.

<span class="ReturnsIdentifier">Return Values</span>

nil

Vector List Format

The format for vlist is as follows:

([color1] from1 to1 <span class="Special">[color2]</span> from2 to2 ...)

The color value applies to all succeeding vectors until vlist specifies another
color. AutoCAD colors are in the range 0-255. If the color value is greater
than 255, succeeding vectors are drawn in XOR ink, which complements anything
it draws over and which erases itself when overdrawn. If the color value is
less than zero, the vector is highlighted. Highlighting depends on the display
device. Most display devices indicate highlighting by a dashed line, but some
indicate it by using a distinctive color.

A pair of point lists, from and to, specify the endpoints of the vectors,
expressed in the current UCS. These can be 2D or 3D points. You must pass these
points as pairs--two successive point lists--or the grvecs call will fail.

AutoCAD clips the vectors as required to fit on the screen.

<span class="ExamplesIdentifier">Examples</span>

The following code draws five vertical lines in the drawing area, each a
different color:

(grvecs '(1 (1 2)(1 5) Draws a red line from (1,2) to (1,5)

 2 (2 2)(2 5) Draws a yellow line from (2,2) to (2,5)

 3 (3 2)(3 5) Draws a green line from (3,2) to (3,5)

 4 (4 2)(4 5) Draws a cyan line from (4,2) to (4,5)

 5 (5 2)(5 5) Draws a blue line from (5,2) to (5,5)

) )

The following matrix represents a uniform scale of 1.0 and a translation of
5.0,5.0,0.0. If this matrix is applied to the preceding list of vectors, they
will be offset by 5.0,5.0,0.0.

'((1.0 0.0 0.0 5.0)

 (0.0 1.0 0.0 5.0)

 (0.0 0.0 1.0 0.0)

 (0.0 0.0 0.0 1.0)

)

See Also

The <a class="Identifier" href="#nentselp">nentselp</a> function for more information on transformation matrixes and the
<a class="Identifier" href="#grdraw">grdraw</a> function for a routine that draws a vector between two points.

<span class="PreProc">================================ H Functions ===================================</span>

<h3 class="String" id="handent">handent</h3>

Returns an object (entity) name based on its handle

(handent handle)

The handent function returns the entity name of both graphic and nongraphic
entities.

<span class="ArgumentsIdentifier">Arguments</span>

handle

A string identifying an entity handle.

<span class="ReturnsIdentifier">Return Values</span>

If successful, handent returns the entity name associated with handle in the
current editing session. If handent is passed an invalid handle or a handle not
used by any entity in the current drawing, it returns nil.

The handent function returns entities that have been deleted during the current
editing session. You can undelete them with the entdel function.

An entity's name can change from one editing session to the next, but an
entity's handle remains constant.

<span class="ExamplesIdentifier">Examples</span>

Command: (handent &quot;5A2&quot;)

&lt;Entity name: 60004722&gt;

Used with the same drawing but in another editing session, the same call might
return a different entity name. Once the entity name is obtained, you can use
it to manipulate the entity with any of the entity-related functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="help">help</h3>

Invokes the Help facility

(help [helpfile [topic <span class="Special">[command]</span>]])

<span class="ArgumentsIdentifier">Arguments</span>

helpfile

A string naming the Help file. The file extension is not required with the
helpfile argument. If a file extension is provided, AutoCAD looks only for a
file with the exact name specified.

If no file extension is provided, AutoCAD looks for helpfile with an extension
of .chm. If no file of that name is found, AutoCAD looks for a file with an
extension of .hlp.

topic

A string identifying a Help topic ID. If you are calling a topic within a CHM
file, provide the file name without the extension; AutoCAD adds an .htm
extension.

command

A string that specifies the initial state of the Help window. The command
argument is a string used by the uCommand (in HTML Help) or the fuCommand (in
WinHelp) argument of the HtmlHelp() and WinHelp() functions as defined in the
Microsoft Windows SDK.

For HTML Help files, the command parameter can be HH_ALINK_LOOKUP or
HH_DISPLAY_TOPIC. For Windows Help files, the command parameter can be
HELP_CONTENTS, HELP_HELPONHELP, or HELP_PARTIALKEY.

<span class="ReturnsIdentifier">Return Values</span>

The helpfile string, if successful, otherwise nil. If you use help without any
arguments, it returns an empty string (&quot;&quot;) if successful, and nil if it fails.

The only error condition that the help function returns to the application is
the existence of the file specified by helpfile. All other error conditions are
reported to the user through a dialog box.

<span class="ExamplesIdentifier">Examples</span>

The following code calls help to display the information on MYCOMMAND in the
Help file achelp.chm:

(help &quot;achelp.chm&quot; &quot;mycommand&quot;)

See Also

The <a class="Identifier" href="#setfunhelp">setfunhelp</a> function associates context-sensitive Help (when the user
presses F1) with a user-defined command.

<span class="PreProc">================================ I Functions ===================================</span>

<h3 class="String" id="if">if</h3>

Conditionally evaluates expressions

(if testexpr thenexpr <span class="Special">[elseexpr]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

testexpr

Expression to be tested.

thenexpr

Expression evaluated if testexpr is not nil.

elseexpr

Expression evaluated if testexpr is nil.

<span class="ReturnsIdentifier">Return Values</span>

The if function returns the value of the selected expression. If elseexpr is
missing and testexpr is nil, then if returns nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (if (= 1 3) &quot;YES!!&quot; &quot;no.&quot;)

&quot;no.&quot;

Command: (if (= 2 (+ 1 1)) &quot;YES!!&quot;)

&quot;YES!!&quot;

Command: (if (= 2 (+ 3 4)) &quot;YES!!&quot;)

nil

See Also

The <a class="Identifier" href="#progn">progn</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="initdia">initdia</h3>

Forces the display of the next command's dialog box

(initdia <span class="Special">[dialogflag]</span>)

Currently, the following commands make use of the initdia function: ATTDEF,
ATTEXT, BHATCH, BLOCK, COLOR, IMAGE, IMAGEADJUST, INSERT, LAYER, LINETYPE,
MTEXT, PLOT, RENAME, STYLE, TOOLBAR, and VIEW.

<span class="ArgumentsIdentifier">Arguments</span>

dialogflag

An integer. If this argument is not present or is present and nonzero, the next
use (and next use only) of a command will display that command's dialog box
rather than its command line prompts.

If dialogflag is zero, any previous call to this function is cleared, restoring
the default behavior of presenting the command line interface.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

Issue the PLOT command without calling initdia first:

Command: (command &quot;_.PLOT&quot;)

plot

Enter a layout name <span class="Special">&lt;Model&gt;</span>: nil

Enter a layout name <span class="Special">&lt;Model&gt;</span>:

AutoCAD prompts for user input in the command window.

Use the following sequence of function calls to make AutoCAD display the Plot
dialog box:

(initdia)

(command &quot;_.PLOT&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="initget">initget</h3>

Establishes keywords for use by the next user-input function call

(initget <span class="Special">[bits]</span> <span class="Special">[string]</span>)

The functions that honor keywords are getint, getreal, getdist, getangle,
getorient, getpoint, getcorner, getkword, entsel, nentsel, and nentselp. The
getstring function is the only user-input function that does not honor
keywords.

The keywords are checked by the next user-input function call when the user
does not enter the expected type of input (for example, a point to getpoint).
If the user input matches a keyword from the list, the function returns that
keyword as a string result. The application can test for the keywords and
perform the action associated with each one. If the user input is not an
expected type and does not match a keyword, AutoCAD asks the user to try again.
The initget bit values and keywords apply only to the next user-input function
call.

If initget sets a control bit and the application calls a user-input function
for which the bit has no meaning, the bit is ignored.

If the user input fails one or more of the specified conditions (as in a zero
value when zero values are not allowed), AutoCAD displays a message and asks
the user to try again.

<span class="ArgumentsIdentifier">Arguments</span>

bits

A bit-coded integer that allows or disallows certain types of user input. The
bits can be added together in any combination to form a value between 0 and
255. If no bits argument is supplied, zero (no conditions) is assumed. The bit
values are as follows:

1 (bit 0) Prevents the user from responding to the request by entering only
ENTER.

2 (bit 1) Prevents the user from responding to the request by entering zero.

4 (bit 2) Prevents the user from responding to the request by entering a
negative value.

8 (bit 3) Allows the user to enter a point outside the current drawing limits.
This condition applies to the next user-input function even if the AutoCAD
system variable LIMCHECK is currently set.

16 (bit 4) (Not currently used.)

32 (bit 5) Uses dashed lines when drawing a rubber-band line or box. For those
functions with which the user can specify a point by selecting a location in
the drawing area, this bit value causes the rubber-band line or box to be
dashed instead of solid. (Some display drivers use a distinctive color instead
of dashed lines.) If the system variable POPUPS is 0, AutoCAD ignores this bit.

64 (bit 6) Prohibits input of a Z coordinate to the getdist function; lets an
application ensure that this function returns a 2D distance.

128 (bit 7) Allows arbitrary input as if it is a keyword, first honoring any
other control bits and listed keywords. This bit takes precedence over bit 0;
if bits 7 and 0 are set and the user presses ENTER, a null string is returned.

<span class="Todo">Note</span>:  Future versions of AutoLISP may use additional initget control bits, so
avoid setting bits that are not listed here.

string

A string representing a series of keywords. See Keyword Specifications for
information on defining keywords.

<span class="ReturnsIdentifier">Return Values</span>

nil

Function Applicable Control Bits

The special control values are honored only by those getxxx functions for which
they make sense, as indicated in the following table:

+------------+--------+---------+------+----------+--------+--------+----------+-----------+
|                     User-input functions and applicable control bits                     |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
|  Function  | Honors |                        Control bits values                         |
|            |  key   |                    |
|            | words  |                    |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
|            |        |   No    |  No  |    No    |   No   |  Uses  |    2D    | Arbitrary |
|            |        |  null   | zero | negative | limits | dashes | distance |   Input   |
|            |        |   (1)   | (2)  |   (4)    |  (8)   |  (32)  |   (64)   |   (128)   |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getint     | X      | X       | X    | X        |        |        |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getreal    | X      | X       | X    | X        |        |        |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getdist    | X      | X       | X    | X        |        | X      | X        | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getangle   | X      | X       | X    |          |        | X      |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getorient  | X      | X       | X    |          |        | X      |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getpoint   | X      | X       |      |          | X      | X      |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getcorner  | X      | X       |      |          | X      | X      |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| getkword   | X      | X       |      |          |        |        |          | X         |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| entsel     | X      |         |      |          |        |        |          |           |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| nentsel    | X      |         |      |          |        |        |          |           |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
| nentselp   | X      |         |      |          |        |        |          |           |
+------------+--------+---------+------+----------+--------+--------+----------+-----------+
Keyword Specifications

The string argument is interpreted according to the following rules:

<span class="Statement">  </span>* Each keyword is separated from the following keyword by one or more spaces.
    For example, &quot;Width Height Depth&quot; defines three keywords.

<span class="Statement">  </span>* Each keyword can contain only letters, numbers, and hyphens (-).

There are two methods for abbreviating keywords:

<span class="Statement">  </span>* The required portion of the keyword is specified in uppercase characters,
    and the remainder of the keyword is specified in lowercase characters. The
    uppercase abbreviation can be anywhere in the keyword (for example,
    &quot;LType&quot;, &quot;eXit&quot;, or &quot;toP&quot;).

<span class="Statement">  </span>* The entire keyword is specified in uppercase characters, and it is followed
    immediately by a comma, which is followed by the required characters (for
    example, &quot;LTYPE,LT&quot;). The keyword characters in this case must include the
    first letter of the keyword, which means that &quot;EXIT,X&quot; is not valid.

The two brief examples, &quot;LType&quot; and &quot;LTYPE,LT&quot;, are equivalent: if the user
types LT (in either uppercase or lowercase letters), this is sufficient to
identify the keyword. The user can enter characters that follow the required
portion of the keyword, provided they don't conflict with the specification. In
the example, the user could also enter LTY or LTYP, but L would not be
sufficient.

If string shows the keyword entirely in uppercase or lowercase characters with
no comma followed by a required part, AutoCAD recognizes the keyword only if
the user enters all of it.

The initget function provides support for localized keywords. The following
syntax for the keyword string allows input of the localized keyword while it
returns the language independent keyword:

&quot;local1 local2 localn _indep1 indep2 indepn&quot;

where local1 through localn are the localized keywords, and indep1 through
indepn are the language-independent keywords.

There must always be the same number of localized keywords as
language-independent keywords, and the first language-independent keyword is
prefixed by an underscore as shown in the following example:

(initget &quot;Abc Def _Ghi Jkl&quot;)

(getkword &quot;\nEnter an option (Abc/Def): &quot;)

Entering A returns Ghi and entering _J returns Jkl.

See Also

The Control of User-Input Function Conditions topic in the Visual LISP
Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="inters">inters</h3>

Finds the intersection of two lines

(inters pt1 pt2 pt3 pt4 <span class="Special">[onseg]</span>)

All points are expressed in terms of the current UCS. If all four point
arguments are 3D, inters checks for 3D intersection. If any of the points are
2D, inters projects the lines onto the current construction plane and checks
only for 2D intersection.

<span class="ArgumentsIdentifier">Arguments</span>

pt1

One endpoint of the first line.

pt2

The other endpoint of the first line.

pt3

One endpoint of the second line.

pt4

The other endpoint of the second line.

onseg

If specified as nil, the lines defined by the four pt arguments are considered
infinite in length. If the onseg argument is omitted or is not nil, the
intersection point must lie on both lines or inters returns nil.

<span class="ReturnsIdentifier">Return Values</span>

If the onseg argument is present and is nil, inters returns the point where the
lines intersect, even if that point is off the end of one or both of the lines.
If the onseg argument is omitted or is not nil, the intersection point must lie
on both lines or inters returns nil. The inters function returns nil if the two
lines do not intersect.

<span class="ExamplesIdentifier">Examples</span>

(setq a '(1.0 1.0) b '(9.0 9.0))

(setq c '(4.0 1.0) d '(4.0 2.0))

Command: (inters a b c d)

nil

Command: (inters a b c d T)

nil

Command: (inters a b c d nil)

(4.0 4.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="itoa">itoa</h3>

Returns the conversion of an integer into a string

(itoa int)

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer.

<span class="ReturnsIdentifier">Return Values</span>

A string derived from int.

<span class="ExamplesIdentifier">Examples</span>

Command: (itoa 33)

&quot;33&quot;

Command: (itoa -17)

&quot;-17&quot;

See Also

The <a class="Identifier" href="#atoi">atoi</a> function.

<span class="PreProc">================================ L Functions ===================================</span>

<h3 class="String" id="lambda">lambda</h3>

Defines an anonymous function

(lambda arguments expr...)

Use the lambda function when the overhead of defining a new function is not
justified. It also makes the programmer's intention more apparent by laying out
the function at the spot where it is to be used. This function returns the
value of its last expr, and is often used in conjunction with apply and/or
mapcar to perform a function on a list.

<span class="ArgumentsIdentifier">Arguments</span>

arguments

<span class="ArgumentsIdentifier">Arguments</span> passed to an expression.

expr

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

The value of the last expr.

<span class="ExamplesIdentifier">Examples</span>

The following examples demonstrate the lambda function from the Visual LISP
Console window:

_$ (apply '(lambda (x y z)

 (* x (- y z))

 )

 '(5 20 14)

)

30

_$ (setq counter 0)

(mapcar '(lambda (x)

 (setq counter (1+ counter))

 (* x 5)

 )

 '(2 4 -6 10.2)

)

0

(10 20 -30 51.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="last">last</h3>

Returns the last element in a list

(last lst)

<span class="ArgumentsIdentifier">Arguments</span>

lst

A list.

<span class="ReturnsIdentifier">Return Values</span>

An atom or a list.

<span class="ExamplesIdentifier">Examples</span>

Command: (last '(a b c d e))

E

Command: (last '(a b c (d e)))

(D E)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="layoutlist">layoutlist</h3>

Returns a list of all paper space layouts in the current drawing

(layoutlist)

<span class="ReturnsIdentifier">Return Values</span>

A list of strings.

<span class="ExamplesIdentifier">Examples</span>

Command: (layoutlist)

(&quot;Layout1&quot; &quot;Layout2&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="length">length</h3>

Returns an integer indicating the number of elements in a list

(length lst)

<span class="ArgumentsIdentifier">Arguments</span>

lst

A list.

<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

Command: (length '(a b c d))

4

Command: (length '(a b (c d)))

3

Command: (length '())

0

See Also

The <a class="Identifier" href="#vl-list-length">vl-list-length</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="list">list</h3>

Takes any number of expressions, and combines them into one list

(list [expr...])

This function is frequently used to define a 2D or 3D point variable (a list of
two or three reals).

<span class="ArgumentsIdentifier">Arguments</span>

expr

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

A list, unless no expressions are supplied, in which case list returns nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (list 'a 'b 'c)

(A B C)

_$ (list 'a '(b c) 'd)

(A (B C) D)

_$ (list 3.9 6.7)

(3.9 6.7)

As an alternative to using the list function, you can explicitly quote a list
with the quote function if there are no variables or undefined items in the
list. The single quote character (') is defined as the quote function.

_$ '(3.9 6.7) means the same as (list 3.9 6.7)

This can be useful for creating association lists and defining points.

See Also

The <a class="Identifier" href="#quote">quote</a>, and <a class="Identifier" href="#vl-list-length">vl-list-length</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="listp">listp</h3>

Verifies that an item is a list

(listp item)

<span class="ArgumentsIdentifier">Arguments</span>

item

Any atom, list, or expression.

<span class="ReturnsIdentifier">Return Values</span>

T if item is a list, nil otherwise. Because nil is both an atom and a list, the
listp function returns T when passed nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (listp '(a b c))

T

Command: (listp 'a)

nil

Command: (listp 4.343)

nil

Command: (listp nil)

T

Command: (listp (setq v1 '(1 2 43)))

T

See Also

The <a class="Identifier" href="#vl-list_star">vl-list_star</a>and <a class="Identifier" href="#vl-list-lenght">vl-list-length</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="load">load</h3>

Evaluates the AutoLISP expressions in a file

(load filename <span class="Special">[onfailure]</span>)

The load function can be used from within another AutoLISP function, or even
recursively (in the file being loaded).

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string that represents the file name. If the filename argument does not
specify a file extension, load adds an extension to the name when searching for
a file to load. The function will try several extensions, if necessary, in the
following order:

<span class="Statement">  </span>* .vlx
<span class="Statement">  </span>* .fas
<span class="Statement">  </span>* .lsp

As soon as load finds a match, it stops searching and loads the file.

The filename can include a directory prefix, as in &quot;c:/function/test1&quot;. A
forward slash (/) or two backslashes (\\) are valid directory delimiters. If
you don't include a directory prefix in the filename string, load searches the
AutoCAD library path for the specified file. If the file is found anywhere on
this path, load then loads the file.

onfailure

A value returned if load fails.

If the onfailure argument is a valid AutoLISP function, it is evaluated. In
most cases, the onfailure argument should be a string or an atom. This allows
an AutoLISP application calling load to take alternative action upon failure.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified, if successful. If load fails, it returns the value of onfailure;
if onfailure is not defined, failure results in an error message.

<span class="ExamplesIdentifier">Examples</span>

For the following examples, assume that file /fred/test1.lsp contains the
expressions

(defun MY-FUNC1 (x)

 ...function body...

)

(defun MY-FUNC2 (x)

 ...function body...

and that no file named test2 with a .lsp, .fas, or .vlx extension exists:

Command: (load &quot;/fred/test1&quot;)

MY-FUNC2

Command: (load &quot;\\fred\\test1&quot;)

MY-FUNC2

Command: (load &quot;/fred/test1&quot; &quot;bad&quot;)

MY-FUNC2

Command: (load &quot;test2&quot; &quot;bad&quot;)

&quot;bad&quot;

Command: (load &quot;test2&quot;) causes an AutoLISP error

See Also

The <a class="Identifier" href="#defun">defun</a>and <a class="Identifier" href="#vl-load-all">vl-load-all</a> functions in this reference, and Symbol and
Function Handling in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="load_dialog">load_dialog</h3>

Loads a DCL file

(load_dialog dclfile)

The load_dialog function searches for files according to the AutoCAD library
search path.

This function is the complement of unload_dialog. An application can load
multiple DCL files with multiple load_dialog calls.

<span class="ArgumentsIdentifier">Arguments</span>

dclfile

A string that specifies the DCL file to load. If the dclfile argument does not
specify a file extension, .dcl is assumed.

<span class="ReturnsIdentifier">Return Values</span>

A positive integer value (dcl_id) if successful, or a negative integer if
load_dialog can't open the file. The dcl_id is used as a handle in subsequent
new_dialog and unload_dialog calls.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="log">log</h3>

Returns the natural log of a number as a real number

(log num)

<span class="ArgumentsIdentifier">Arguments</span>

num

A positive number.

<span class="ReturnsIdentifier">Return Values</span>

A real number.

<span class="ExamplesIdentifier">Examples</span>

Command: (log 4.5)

1.50408

Command: (log 1.22)

0.198851

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="logand">logand</h3>

Returns the result of the logical bitwise AND of a list of integers

(logand [int int...])

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer.

<span class="ReturnsIdentifier">Return Values</span>

An integer (0, if no arguments are supplied).

<span class="ExamplesIdentifier">Examples</span>

Command: (logand 7 15 3)

3

Command: (logand 2 3 15)

2

Command: (logand 8 3 4)

0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="logior">logior</h3>

Returns the result of the logical bitwise inclusive OR of a list of integers

(logior [int int...])

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer.

<span class="ReturnsIdentifier">Return Values</span>

An integer (0, if no arguments are supplied).

<span class="ExamplesIdentifier">Examples</span>

Command: (logior 1 2 4)

7

Command: (logior 9 3)

11

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="lsh">lsh</h3>

Returns the logical bitwise shift of an integer by a specified number of bits

(lsh [int numbits])

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer.

numbits

Number of bits to shift int.

If numbits is positive, int is shifted to the left; if numbits is negative, int
is shifted to the right. In either case, zero bits are shifted in, and the bits
shifted out are discarded.

If numbits is not specified, no shift occurs.

<span class="ReturnsIdentifier">Return Values</span>

The value of int after the bitwise shift. The returned value is positive if the
significant bit (bit number 31) contains a 0 after the shift operation,
otherwise it is negative. If no arguments are supplied, lsh returns 0.

The behavior is different from other languages (&gt;&gt; &amp; &lt;&lt; of C, C++, or Java)
where more than 32 left shifts (of a 32 bit integer) results 0. In right shift
also the integer appears again on every 32 shifts.

<span class="ExamplesIdentifier">Examples</span>

Command: (lsh 2 1)

4

Command: (lsh 2 -1)

1

Command: (lsh 40 2)

160

<span class="PreProc">================================ M Functions ===================================</span>

<h3 class="String" id="mapcar">mapcar</h3>

Returns a list that is the result of executing a function with a list (or
lists) supplied as arguments to the function

(mapcar function list1... listn)

<span class="ArgumentsIdentifier">Arguments</span>

function

A function.

list1... listn

One or more lists. The number of lists must match the number of arguments
required by function.

<span class="ReturnsIdentifier">Return Values</span>

A list.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 10 b 20 c 30)

30

Command: (mapcar '1+ (list a b c))

(11 21 31)

This is equivalent to the following series of expressions:

(1+ a)

(1+ b)

(1+ c)

except that mapcar returns a list of the results.

The lambda function can specify an anonymous function to be performed by
mapcar. This is useful when some of the function arguments are constant or are
supplied by some other means. The following example, entered from the Visual
LISP Console window, demonstrates the use of lambda with mapcar:

_$ (mapcar '(lambda (x)

 (+ x 3)

 )

 '(10 20 30)

)

(13 23 33)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="max">max</h3>

Returns the largest of the numbers given

(max [number number...])

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

A number. If any of the arguments are real numbers, a real is returned,
otherwise an integer is returned. If no argument is supplied, max returns 0.

<span class="ExamplesIdentifier">Examples</span>

Command: (max 4.07 -144)

4.07

Command: (max -88 19 5 2)

19

Command: (max 2.1 4 8)

8.0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="mem">mem</h3>

Displays the current state of the AutoLISP memory

(mem)

The mem function displays statistics on AutoLISP memory usage. The first line
of this statistics report contains the following information:

GC calls

Number of garbage collection calls since AutoLISP started.

GC run time

Total time spent collecting garbage (in milliseconds).

LISP objects are allocated in dynamic (heap) memory that is organized in
segments and divided into pages. Memory is described under the heading,
&quot;Dynamic memory segments statistics:&quot;

PgSz

Dynamic memory page size (in KB).

Used

Number of pages used.

Free

Number of free (empty) pages.

FMCL

Largest contiguous area of free pages.

Segs

Number of segments allocated.

Type

Internal description of the types of objects allocated in this segment. These
include:

lisp stacks--LISP internal stacks

bytecode area--compiled code function modules

CONS memory--CONS objects

::new--untyped memory requests served using this segment

DM Str--dynamic string bodies

DMxx memory--all other LISP nodes

bstack body--internal structure used for IO operations

The final line in the report lists the minimal segment size and the number of
allocated segments. AutoLISP keeps a list of no more than three free segments,
in order to save system calls for memory requests.

All heap memory is global; that is, all AutoCAD documents share the same heap.
This could change in future releases of AutoCAD.

<span class="Todo">Note</span> that mem does not list all memory requested from the operating system,
only those requests served by the AutoLISP Dynamic Memory (DM) subsystem; some
AutoLISP classes do not use DM for memory allocation.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

Command: (mem)

; GC calls: 23; GC run time: 298 ms

Dynamic memory segments statistic:

PgSz Used Free FMCL Segs Type

 512 79 48 48 1 lisp stacks

 256 3706 423 142 16 bytecode area

4096 320 10 10 22 CONS memory

 32 769 1213 1089 1 ::new

4096 168 12 10 12 DM Str

4096 222 4 4 15 DMxx memory

 128 4 507 507 1 bstack body

Segment size: 65536, total used: 68, free: 0

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="member">member</h3>

Searches a list for an occurrence of an expression and returns the remainder of
the list, starting with the first occurrence of the expression

(member expr lst)

<span class="ArgumentsIdentifier">Arguments</span>

expr

The expression to be searched for.

lst

The list in which to search for expr.

<span class="ReturnsIdentifier">Return Values</span>

A list, or nil, if there is no occurrence of expr in lst.

<span class="ExamplesIdentifier">Examples</span>

Command: (member 'c '(a b c d e))

(C D E)

Command: (member 'q '(a b c d e))

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="menucmd">menucmd</h3>

Issues menu commands, or sets and retrieves menu item status

(menucmd string)

The menucmd function can switch between subpages in an AutoCAD menu. This
function can also force the display of menus. This allows AutoLISP programs to
use image tile menus and to display other menus from which the user can make
selections. AutoLISP programs can also enable, disable, and place marks in menu
items.

<span class="ArgumentsIdentifier">Arguments</span>

string

A string that specifies a menu area and the value to assign to that menu area.
The string argument has the following parameters.

&quot;menu_area=value&quot;

The allowed values of menu_area, shown in the following list, are the same as
they are in menu file submenu references. For more information, see Pull-Down
and Shortcut Menus in the Customization Guide.

B1-B4 BUTTONS menus 1 through 4.

A1-A4 AUX menus 1 through 4.

P0-P16 Pull-down (POP) menus 0 through 16.

I Image tile menus.

S SCREEN menu.

T1-T4 TABLET menus 1 through 4.

M DIESEL string expressions.

Gmenugroup.nametag A menugroup and name tag.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

The following code displays the image tile menu MOREICONS.

(menucmd &quot;I=moreicons&quot;) Loads the MOREICONS image tile menu

(menucmd &quot;I=*&quot;) Displays the menu

The following code checks the status of the third menu item in the pull-down
menu POP11. If the menu item is currently enabled, the menucmd function
disables it.

(setq s (menucmd &quot;P11.3=?&quot;)) Gets the status of the menu item

(if (= s &quot;&quot;) If the status is an empty string,

 (menucmd &quot;P11.3=~&quot;) disable the menu item

)

The previous code is not foolproof. In addition to being enabled or disabled,
menu items can also receive marks. The code (menucmd &quot;P11.3=?&quot;) could return
&quot;!.&quot;, indicating that the menu item is currently checked. This code would
assume that the menu item is disabled and continue without disabling it. If the
code included a call to the wcmatch function, it could check the status for an
occurrence of the tilde (~) character and then take appropriate action.

The menucmd function also allows AutoLISP programs to take advantage of the
DIESEL string expression language. Some things can be done much easier with
DIESEL than with the equivalent AutoLISP code. The following code returns a
string containing the current day and date:

(menucmd &quot;M=$(edtime,$(getvar,date),DDDD\&quot;,\&quot; D MONTH YYYY)&quot;)

 returns &quot;Sunday, 16 July 1995&quot;

See Also

The Customization Guide for more information on using AutoLISP to access menu
label status, and for information on using DIESEL.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="menugroup">menugroup</h3>

Verifies that a menugroup is loaded

(menugroup groupname)

<span class="ArgumentsIdentifier">Arguments</span>

groupname

A string that specifies the menugroup name.

<span class="ReturnsIdentifier">Return Values</span>

If groupname matches a loaded menugroup, the function returns the groupname
string; otherwise, it returns nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="min">min</h3>

Returns the smallest of the numbers given

(min [number number...])

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

A number. If any number argument is a real, a real is returned, otherwise an
integer is returned. If no argument is supplied, min returns 0.

<span class="ExamplesIdentifier">Examples</span>

Command: (min 683 -10.0)

-10.0

Command: (min 73 2 48 5)

2

Command: (min 73.0 2 48 5)

2.0

Command: (min 2 4 6.7)

2.0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="minusp">minusp</h3>

Verifies that a number is negative

(minusp num)

<span class="ArgumentsIdentifier">Arguments</span>

num

A number.

<span class="ReturnsIdentifier">Return Values</span>

T if number is negative, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Command: (minusp -1)

T

Command: (minusp -4.293)

T

Command: (minusp 830.2)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="mode_tile">mode_tile</h3>

Sets the mode of a dialog box tile

(mode_tile key mode)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the tile. The key argument is case-sensitive.

mode

An integer that can be one of the following:

0 Enable tile

1 Disable tile

2 Set focus to tile

3 Select edit box contents

4 Flip image highlighting on or off

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="PreProc">================================ N Functions ===================================</span>

<h3 class="String" id="namedobjdict">namedobjdict</h3>

Returns the entity name of the current drawing's named object dictionary, which
is the root of all nongraphical objects in the drawing

(namedobjdict)

Using the name returned by this function and the dictionary access functions,
an application can access the nongraphical objects in the drawing.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="nentsel">nentsel</h3>

Prompts the user to select an object (entity) by specifying a point, and
provides access to the definition data contained within a complex object

(nentsel <span class="Special">[msg]</span>)

The nentsel function prompts the user to select an object. The current Object
Snap mode is ignored unless the user specifically requests it. To provide
additional support at the Command prompt, nentsel honors keywords defined by a
previous call to initget.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string to be displayed as a prompt. If the msg function is omitted, the
Select object prompt is issued.

<span class="ReturnsIdentifier">Return Values</span>

When the selected object is not complex (i.e., not a 3D polyline or block),
nentsel returns the same information as entsel. However, if the selected object
is a 3D polyline, nentsel returns a list containing the name of the subentity
(vertex) and the pick point. This is similar to the list returned by entsel,
except that the name of the selected vertex is returned instead of the polyline
header. The nentsel function always returns the starting vertex of the selected
3D polyline segment. Picking the third segment of the polyline, for example,
returns the third vertex. The Seqend subentity is never returned by nentsel for
a 3D polyline.

<span class="Todo">Note</span>:  A lightweight polyline (lwpolyline entity) is defined in the drawing
database as a single entity; it does not contain subentities.

Selecting an attribute within a block reference returns the name of the
attribute and the pick point. When the selected object is a component of a
block reference other than an attribute, nentsel returns a list containing four
elements.

The first element of the list returned from picking an object within a block is
the selected entity's name. The second element is a list containing the
coordinates of the point used to pick the object.

The third element is called the Model to World Transformation Matrix. It is a
list consisting of four sublists, each of which contains a set of coordinates.
This matrix can be used to transform the entity definition data points from an
internal coordinate system called the Model Coordinate System (MCS), to the
World Coordinate System (WCS). The insertion point of the block that contains
the selected entity defines the origin of the MCS. The orientation of the UCS
when the block is created determines the direction of the MCS axes.

<span class="Todo">Note</span>:  nentsel is the only AutoLISP function that uses a matrix of this type;
the nentselp function returns a matrix similar to those used by other AutoLISP
and ObjectARX functions.

The fourth element is a list containing the entity name of the block that
contains the selected object. If the selected object is in a nested block (a
block within a block), the list additionally contains the entity names of all
blocks in which the selected object is nested, starting with the innermost
block and continuing outward until the name of the block that was inserted in
the drawing is reported.

For information on converting MCS coordinates to WCS, see Entity Context and
Coordinate Transform Data in the Using AutoLISP to Manipulate AutoCAD Objects
chapter of the Visual LISP Developer's Guide.

<span class="ExamplesIdentifier">Examples</span>

Draw a 3Dpolyline with multiple line segments, then load and run the following
function and select different segments of the line. Pick off of the line and
then pick the same segments again to see the subentity handle. Try it with a
lightweight polyline to see the difference.

(defun c:subent ()

 (while

 (setq Ent (entsel &quot;\nPick an entity: &quot;))

 (print (strcat &quot;Entity handle is: &quot;
          (cdr (assoc 5 (entget (car Ent))))))

 )

 (while

 (setq Ent (nentsel &quot;\nPick an entity or subEntity: &quot;))

 (print (strcat &quot;Entity or subEntity handle is: &quot;
          (cdr (assoc 5 (entget (car Ent))))))

 )

 (prompt &quot;\nDone.&quot;)

 (princ)

)

See Also

The <a class="Identifier" href="#entsel">entsel</a>, and <a class="Identifier" href="#netselp">nentselp</a> functions in this reference and Entity
Name Functions in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="nentselp">nentselp</h3>

Provides similar functionality to that of the nentsel function without the need
for user input

(nentselp <span class="Special">[msg]</span> <span class="Special">[pt]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string to be displayed as a prompt. If the msg argument is omitted, the
Select object prompt is issued.

pt

A selection point. This allows object selection without user input.

<span class="ReturnsIdentifier">Return Values</span>

The nentselp function returns a 4 x 4 transformation matrix, defined as
follows:

The first three columns of the matrix specify scaling and rotation. The fourth
column is a translation vector.

The functions that use a matrix of this type treat a point as a column vector
of dimension 4. The point is expressed in homogeneous coordinates, where the
fourth element of the point vector is a scale factor that is normally set to
1.0. The final row of the matrix, the vector [M30 M31 M32 M33], has the nominal
value of [0 0 0 1]; it is currently ignored by the functions that use this
matrix format. In this convention, applying a transformation to a point is a
matrix multiplication that appears as follows:

This multiplication gives us the individual coordinates of the point as
follows:

As these equations show, the scale factor and the last row of the matrix have
no effect and are ignored.

See Also

The <a class="Identifier" href="#nentsel">nentsel</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="new_dialog">new_dialog</h3>

Begins a new dialog box and displays it, and can also specify a default action

(new_dialog dlgname dcl_id [action <span class="Special">[screen-pt]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

dlgname

A string that specifies the dialog box.

dcl_id

The DCL file identifier obtained by load_dialog.

action

A string that contains an AutoLISP expression to use as the default action. If
you don't want to define a default action, specify an empty string (&quot;&quot;). The
action argument is required if you specify screen-pt.

The default action is evaluated when the user picks an active tile that doesn't
have an action or callback explicitly assigned to it by action_tile or in DCL.

screen-pt

A 2D point list that specifies the X,Y location of the dialog box on the
screen. The point specifies the upper-left corner of the dialog box. If you
pass the point as'(-1 -1), the dialog box is opened in the default position
(the center of the AutoCAD drawing area).

<span class="ReturnsIdentifier">Return Values</span>

T, if successful, otherwise nil.

See Also

The Managing Dialog Boxes chapter of the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="not">not</h3>

Verifies that an item evaluates to nil

(not item)

Typically, the null function is used for lists, and not is used for other data
types along with some types of control functions.

<span class="ArgumentsIdentifier">Arguments</span>

item

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

T if item evaluates to nil, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 123 b &quot;string&quot; c nil)

nil

Command: (not a)

nil

Command: (not b)

nil

Command: (not c)

T

Command: (not '())

T

See Also

The <a class="Identifier" href="#null">null</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="nth">nth</h3>

Returns the nth element of a list

(nth n lst)

<span class="ArgumentsIdentifier">Arguments</span>

n

The number of the element to return from the list (zero is the first element).

lst

The list.

<span class="ReturnsIdentifier">Return Values</span>

The nth element of lst. If n is greater than the highest element number of lst,
nth returns nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (nth 3 '(a b c d e))

D

Command: (nth 0 '(a b c d e))

A

Command: (nth 5 '(a b c d e))

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="null">null</h3>

Verifies that an item is bound to nil

(null item)

<span class="ArgumentsIdentifier">Arguments</span>

item

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

T if item evaluates to nil, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 123 b &quot;string&quot; c nil)

nil

Command: (null a)

nil

Command: (null b)

nil

Command: (null c)

T

Command: (null '())

T

See Also

The <a class="Identifier" href="#not">not</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="numberp">numberp</h3>

Verifies that an item is a real number or an integer

(numberp item)

<span class="ArgumentsIdentifier">Arguments</span>

item

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

T if item evaluates to a real or an integer, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 123 b 'a)

A

Command: (numberp 4)

T

Command: (numberp 3.8348)

T

Command: (numberp &quot;Howdy&quot;)

nil

Command: (numberp a)

T

Command: (numberp b)

nil

Command: (numberp (eval b))

T

<span class="PreProc">================================ O Functions ===================================</span>

<h3 class="String" id="open">open</h3>

Opens a file for access by the AutoLISP I/O functions

(open filename mode)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string that specifies the name and extension of the file to be opened. If you
do not specify the full path name of the file, open assumes you are referring
to the AutoCAD start-up directory.

mode

Indicates whether the file is open for reading, writing, or appending. Specify
a string containing one of the following letters:

r Open for reading.

w Open for writing. If filename does not exist, a new file is created and
opened. If filename already exists, its existing data is overwritten. Data
passed to an open file is not actually written until the file is closed with
the close function.

a Open for appending. If filename does not exist, a new file is created and
opened. If filename already exists, it is opened and the pointer is positioned
at the end of the existing data, so new data you write to the file is appended
to the existing data.

The mode argument can be uppercase or lowercase. <span class="Todo">Note</span> that in releases prior to
AutoCAD 2000, mode had to be specified in lowercase.

<span class="ReturnsIdentifier">Return Values</span>

If successful, open returns a file descriptor that can be used by the other I/O
functions. If mode &quot;r&quot; is specified and filename does not exist, open returns
nil.

<span class="Todo">Note</span>:  On DOS systems, some programs and text editors write text files with an
end-of-file marker (CTRL+Z, decimal ASCII code 26) at the end of the text. When
reading a text file, DOS returns an end-of-file status if a CTRL+Z marker is
encountered, even if that marker is followed by more data. If you intend to use
open's &quot;a&quot; mode to append data to files produced by another program, be certain
the other program does not insert CTRL+Z markers at the end of its text files.

<span class="ExamplesIdentifier">Examples</span>

Open an existing file:

Command: (setq a (open &quot;c:/program files/AutoCAD/help/filelist.txt&quot; &quot;r&quot;))

#&lt;file &quot;c:/program files/AutoCAD/help/filelist.txt&quot;&gt;

The following examples issue open against files that do not exist:

Command: (setq f (open &quot;c:\\my documents\\new.tst&quot; &quot;w&quot;))

#&lt;file &quot;c:\\my documents\\new.tst&quot;&gt;

Command: (setq f (open &quot;nosuch.fil&quot; &quot;r&quot;))

nil

Command: (setq f (open &quot;logfile&quot; &quot;a&quot;))

#&lt;file &quot;logfile&quot;&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="or">or</h3>

Returns the logical OR of a list of expressions

(or [expr...])

The or function evaluates the expressions from left to right, looking for a
non-nil expression.

<span class="ArgumentsIdentifier">Arguments</span>

expr

The expressions to be evaluated.

<span class="ReturnsIdentifier">Return Values</span>

T, if a non-nil expression is found, or nil, if all of the expressions are nil
or no arguments are supplied.

<span class="Todo">Note</span> that or accepts an atom as an argument and returns T if one is supplied.

<span class="ExamplesIdentifier">Examples</span>

Command: (or nil 45 '())

T

Command: (or nil '())

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="osnap">osnap</h3>

Returns a 3D point that is the result of applying an Object Snap mode to a
specified point

(osnap pt mode)

<span class="ArgumentsIdentifier">Arguments</span>

pt

A point.

mode

A string that consists of one or more valid Object Snap identifiers such as
mid, cen, and so on, separated by commas.

<span class="ReturnsIdentifier">Return Values</span>

A point, or nil, if the pick did not return an object (for example, there is no
geometry under the pick aperture, or the geometry is not applicable to the
selected object snap mode). The point returned by osnap depends on the current
3D view, the AutoCAD entity around pt, and the setting of the APERTURE system
variable.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq pt1 (getpoint))

(11.8637 3.28269 0.0)

Command: (setq pt2 (osnap pt1 &quot;_end,_int&quot;))

(12.1424 3.42181 0.0)

<span class="PreProc">================================ P Functions ===================================</span>

<h3 class="String" id="polar">polar</h3>

Returns the UCS 3D point at a specified angle and distance from a point

(polar pt ang dist)

<span class="ArgumentsIdentifier">Arguments</span>

pt

A 2D or 3D point.

ang

An angle expressed in radians relative to the world X axis. Angles increase in
the counterclockwise direction, independent of the current construction plane.

dist

Distance from the specified pt.

<span class="ReturnsIdentifier">Return Values</span>

A 2D or 3D point, depending on the type of point specified by pt.

<span class="ExamplesIdentifier">Examples</span>

Supplying a 3D point to polar:

Command: (polar '(1 1 3.5) 0.785398 1.414214)

(2.0 2.0 3.5)

Supplying a 2D point to polar:

Command: (polar '(1 1) 0.785398 1.414214)

(2.0 2.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="prin1">prin1</h3>

Prints an expression to the command line or writes an expression to an open file

(prin1 [expr <span class="Special">[file-desc]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

expr

A string or AutoLISP expression. Only the specified expr is printed; no newline
or space is included.

file-desc

A file descriptor for a file opened for writing.

<span class="ReturnsIdentifier">Return Values</span>

The value of the evaluated expr. If called with no arguments, prin1 returns a
null symbol.

Used as the last expression in a function, prin1 without arguments results in a
blank line printing when the function completes, allowing the function to exit
&quot;quietly.&quot;

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 123 b '(a))

(A)

Command: (prin1 'a)

AA

The previous command printed A and returned A.

Command: (prin1 a)

123123

The previous command printed 123 and returned 123.

Command: (prin1 b)

(A)(A)

The previous command printed (A) and returned (A).

Each preceding example is displayed on the screen because no file-desc was
specified. Assuming that f is a valid file-descriptor for a file opened for
writing, the following function call writes a string to that file and returns
the string:

Command: (prin1 &quot;Hello&quot; f)

&quot;Hello&quot;

If expr is a string containing control characters, prin1 expands these
characters with a leading \, as shown in the following table:

              +---------------+-----------------------------------+
              |                   Control codes                   |
              +---------------+-----------------------------------+
              |     Code      |            Description            |
              +---------------+-----------------------------------+
              | \\            | \ character                       |
              +---------------+-----------------------------------+
              | \&quot;            | &quot; character                       |
              +---------------+-----------------------------------+
              | \e            | Escape character                  |
              +---------------+-----------------------------------+
              | \n            | Newline character                 |
              +---------------+-----------------------------------+
              | \r            | Return character                  |
              +---------------+-----------------------------------+
              | \t            | TAB character                     |
              +---------------+-----------------------------------+
              | \nnn          | Character whose octal code is nnn |
              +---------------+-----------------------------------+
The following example shows how to use control characters:

Command: (prin1 (chr 2))

&quot;\002&quot;&quot;\002&quot;

See Also

The Displaying Messages topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="princ">princ</h3>

Prints an expression to the command line, or writes an expression to an open
file

(princ [expr <span class="Special">[file-desc]</span>])

This function is the same as prin1, except control characters in expr are
printed without expansion. In general, prin1 is designed to print expressions
in a way that is compatible with load, while princ prints them in a way that is
readable by functions such as read-line.

<span class="ArgumentsIdentifier">Arguments</span>

expr

A string or AutoLISP expression. Only the specified expr is printed; no newline
or space is included.

file-desc

A file descriptor for a file opened for writing.

<span class="ReturnsIdentifier">Return Values</span>

The value of the evaluated expr. If called with no arguments, princ returns a
null symbol.

See Also

The Displaying Messages topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="print">print</h3>

Prints an expression to the command line, or writes an expression to an open
file

(print [expr <span class="Special">[file-desc]</span>])

This function is the same as prin1, except it prints a newline character before
expr, and prints a space following expr.

<span class="ArgumentsIdentifier">Arguments</span>

expr

A string or AutoLISP expression. Only the specified expr is printed; no newline
or space is included.

file-desc

A file descriptor for a file opened for writing.

<span class="ReturnsIdentifier">Return Values</span>

The value of the evaluated expr. If called with no arguments, print returns a
null symbol.

See Also

The Displaying Messages topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="progn">progn</h3>

Evaluates each expression sequentially and returns the value of the last
expression

(progn <span class="Special">[expr]</span>...)

You can use progn to evaluate several expressions where only one expression is
expected.

<span class="ArgumentsIdentifier">Arguments</span>

expr

One or more AutoLISP expressions.

<span class="ReturnsIdentifier">Return Values</span>

The result of the last evaluated expression.

<span class="ExamplesIdentifier">Examples</span>

The if function normally evaluates one then expression if the test expression
evaluates to anything but nil. The following example uses progn to evaluate two
expressions following if:

(if (= a b)

 (progn

 (princ &quot;\nA = B &quot;)

 (setq a (+ a 10) b (- b 10))

 )

)

See Also

The <a class="Identifier" href="#if">if</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="prompt">prompt</h3>

Displays a string on your screen's prompt area

(prompt msg)

On dual-screen AutoCAD configurations, prompt displays msg on both screens and
is, therefore, preferable to princ.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="ExamplesIdentifier">Examples</span>

Command: (prompt &quot;New value: &quot;)

New value: nil

See Also

The Displaying Messages topic in the Visual LISP Developer's Guide.

<span class="PreProc">================================ Q Functions ===================================</span>

<h3 class="String" id="quit">quit</h3>

Forces the current application to quit

(quit)

If quit is called, it returns the error message quit/exit abort and returns to
the AutoCAD Command prompt.

See Also

The <a class="Identifier" href="#exit">exit</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="quote">quote</h3>

Returns an expression without evaluating it

(quote expr)

<span class="ArgumentsIdentifier">Arguments</span>

expr

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

The expr argument.

<span class="ExamplesIdentifier">Examples</span>

Command: (quote a)

A

The previous expression can also be written as 'a. For example:

Command: !'a

A

Command: (quote (a b))

(A B)

See Also

The <a class="Identifier" href="#function">function</a> function.

<span class="PreProc">================================ R Functions ===================================</span>

<h3 class="String" id="read">read</h3>

Returns the first list or atom obtained from a string

(read <span class="Special">[string]</span>)

The read function parses the string representation of any LISP data and returns
the first expression in the string, converting it to a corresponding data type.

<span class="ArgumentsIdentifier">Arguments</span>

string

A string. The string argument should not contain blanks, except within a list
or string.

<span class="ReturnsIdentifier">Return Values</span>

A list or atom. The read function returns its argument converted into the
corresponding data type. If no argument is specified, read returns nil.

If the string contains multiple LISP expressions separated by LISP symbol
delimiters such as blanks, new-line, tabs, or parentheses, only the first
expression is returned.

<span class="ExamplesIdentifier">Examples</span>

Command: (read &quot;hello&quot;)

HELLO

Command: (read &quot;hello there&quot;)

HELLO

Command: (read &quot;\&quot;Hi Y'all\&quot;&quot;)

&quot;Hi Y'all&quot;

Command: (read &quot;(a b c)&quot;)

(A B C)

Command: (read &quot;(a b c) (d)&quot;)

(A B C)

Command: (read &quot;1.2300&quot;)

1.23

Command: (read &quot;87&quot;)

87

Command: (read &quot;87 3.2&quot;)

87

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="read-char">read-char</h3>

Returns the decimal ASCII code representing the character read from the
keyboard input buffer or from an open file

(read-char <span class="Special">[file-desc]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

file-desc

A file descriptor (obtained from open) referring to an open file. If no
file-desc is specified, read-char obtains input from the keyboard input buffer.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the ASCII code for a character. The read-char function
returns a single newline character (ASCII code 10) whenever it detects an
end-of-line character or character sequence.

<span class="ExamplesIdentifier">Examples</span>

The following example omits file-desc, so read-char looks for data in the
keyboard buffer:

Command: (read-char)

The keyboard buffer is empty, so read-char waits for user input.

ABC

65

The user entered ABC; read-char returned the ASCII code representing the first
character entered (A). The next three calls to read-char return the data
remaining in the keyboard input buffer. This data translates to 66 (the ASCII
code for the letter B), 67 (C), and 10 (newline), respectively:

Command: (read-char)

66

Command: (read-char)

67

Command: (read-char)

10

With the keyboard input buffer now empty, read-char waits for user input the
next time it is called:

Command: (read-char)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="read-line">read-line</h3>

Reads a string from the keyboard or from an open file, until an end-of-line
marker is encountered

(read-line <span class="Special">[file-desc]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

file-desc

A file descriptor (obtained from open) referring to an open file. If no
file-desc is specified, read-line obtains input from the keyboard input buffer.

<span class="ReturnsIdentifier">Return Values</span>

The string read by read-line, without the end-of-line marker. If read-line
encounters the end of the file, it returns nil.

<span class="ExamplesIdentifier">Examples</span>

Open a file for reading:

Command: (setq f (open &quot;c:\\my documents\\new.tst&quot; &quot;r&quot;))

#&lt;file &quot;c:\\my documents\\new.tst&quot;&gt;

Use read-line to read a line from the file:

Command: (read-line f)

&quot;To boldly go where nomad has gone before.&quot;

Obtain a line of input from the user:

Command: (read-line)

To boldly go

&quot;To boldly go&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="redraw">redraw</h3>

Redraws the current viewport or a specified object (entity) in the current
viewport

(redraw [ename <span class="Special">[mode]</span>])

If redraw is called with no arguments, the function redraws the current
viewport. If called with an entity name argument, redraw redraws the specified
entity.

The redraw function has no effect on highlighted or hidden entities, however a
REGEN command forces the entities to redisplay in their normal manner.

<span class="ArgumentsIdentifier">Arguments</span>

ename

The name of the entity name to be redrawn.

mode

An integer value that controls the visibility and highlighting of the entity.
The mode can be one of the following values:

1 Show entity

2 Hide entity (blank it out)

3 Highlight entity

4 Unhighlight entity

The use of entity highlighting (mode 3) must be balanced with entity
unhighlighting (mode 4).

If ename is the header of a complex entity (a polyline or a block reference
with attributes), redraw processes the main entity and all its subentities if
the mode argument is positive. If the mode argument is negative, redraw
operates on only the header entity.

<span class="ReturnsIdentifier">Return Values</span>

The redraw function always returns nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="regapp">regapp</h3>

Registers an application name with the current AutoCAD drawing in preparation
for using extended object data

(regapp application)

<span class="ArgumentsIdentifier">Arguments</span>

application

A string naming the application. The name must be a valid symbol table name.
See the description of snvalid for the rules AutoLISP uses to determine if a
symbol name is valid.

<span class="ReturnsIdentifier">Return Values</span>

If an application of the same name has already been registered, this function
returns nil; otherwise it returns the name of the application.

If registered successfully, the application name is entered into the APPID
symbol table. This table maintains a list of the applications that are using
extended data in the drawing.

<span class="ExamplesIdentifier">Examples</span>

(regapp &quot;ADESK_4153322344&quot;)

(regapp &quot;DESIGNER-v2.1-124753&quot;)

<span class="Todo">Note</span>:  It is recommended that you pick a unique application name. One way of
ensuring this is to adopt a naming scheme that uses the company or product name
and a unique number (like your telephone number or the current date/ time). The
product version number can be included in the application name or stored by the
application in a separate integer or real-number field; for example, (1040
2.1).

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="rem">rem</h3>

Divides the first number by the second, and returns the remainder

(rem [number number...])

<span class="ArgumentsIdentifier">Arguments</span>

number

Any number.

If you provide more than two numbers, rem divides the result of dividing the
first number by the second with the third, and so on.

If you provide more than two numbers, rem evaluates the arguments from left to
right. For example, if you supply three numbers, rem divides the first number
by the second, then takes the result and divides it by the third number,
returning the remainder of that operation.

<span class="ReturnsIdentifier">Return Values</span>

A number. If any number argument is a real, rem returns a real, otherwise rem
returns an integer. If no arguments are supplied, rem returns 0. If a single
number argument is supplied, rem returns number.

<span class="ExamplesIdentifier">Examples</span>

Command: (rem 42 12)

6

Command: (rem 12.0 16)

12.0

Command: (rem 26 7 2)

1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="repeat">repeat</h3>

Evaluates each expression a specified number of times, and returns the value of
the last expression

(repeat int [expr...])

<span class="ArgumentsIdentifier">Arguments</span>

int

An integer. Must be a positive number.

expr

One or more atoms or expressions.

<span class="ReturnsIdentifier">Return Values</span>

The value of the last expression or atom evaluated. If expr is not supplied,
repeat returns nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq a 10 b 100)

100

Command: (repeat 4 (setq a (+ a 10)) (setq b (+ b 100)))

500

After evaluation, a is 50, b is 500, and repeat returns 500.

If strings are supplied as arguments, repeat returns the last string:

Command: (repeat 100 &quot;Me&quot; &quot;You&quot;)

&quot;You&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="reverse">reverse</h3>

Returns a copy of a list with its elements reversed

(reverse lst)

<span class="ArgumentsIdentifier">Arguments</span>

lst

A list.

<span class="ReturnsIdentifier">Return Values</span>

A list.

<span class="ExamplesIdentifier">Examples</span>

Command: (reverse '((a) b c))

(C B (A))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="rtos">rtos</h3>

Converts a number into a string

(rtos number [mode <span class="Special">[precision]</span>])

The rtos function returns a string that is the representation of number
according to the settings of mode, precision, and the system variables
UNITMODE, DIMZIN, LUNITS, and LUPREC.

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

mode

An integer specifying the linear units mode. The mode corresponds to the values
allowed for the LUNITS AutoCAD system variable. The mode can be one of the
following numbers:

1 Scientific

2 Decimal

3 Engineering (feet and decimal inches)

4 Architectural (feet and fractional inches)

5 Fractional

precision

An integer specifying the precision.

The mode and precision arguments correspond to the system variables LUNITS and
LUPREC. If you omit the arguments, rtos uses the current settings of LUNITS and
LUPREC.

<span class="ReturnsIdentifier">Return Values</span>

A string. The UNITMODE system variable affects the returned string when
engineering, architectural, or fractional units are selected (mode values 3, 4,
or 5).

<span class="ExamplesIdentifier">Examples</span>

Set variable x:

Command: (setq x 17.5)

17.5

Convert the value of x to a string in scientific format, with a precision of 4:

Command: (setq fmtval (rtos x 1 4))

&quot;1.7500E+01&quot;

Convert the value of x to a string in decimal format, with 2 decimal places:

Command: (setq fmtval (rtos x 2 2))

&quot;17.50&quot;

Convert the value of x to a string in engineering format, with a precision of
2:

Command: (setq fmtval (rtos x 3 2))

&quot;1'-5.50\&quot;&quot;

Convert the value of x to a string in architectural format:

Command: (setq fmtval (rtos x 4 2))

&quot;1'-5 1/2\&quot;&quot;

Convert the value of x to a string in fractional format:

Command: (setq fmtval (rtos x 5 2))

&quot;17 1/2&quot;

Setting UNITMODE to 1 causes units to be displayed as entered. This affects the
values returned by rtos for engineering, architectural, and fractional formats,
as shown in the following examples:

Command: (setvar &quot;unitmode&quot; 1)

1

Command: (setq fmtval (rtos x 3 2))

&quot;1'5.50\&quot;&quot;

Command: (setq fmtval (rtos x 4 2))

&quot;1'5-1/2\&quot;&quot;

Command: (setq fmtval (rtos x 5 2))

&quot;17-1/2&quot;

See Also

The String Conversions topic in the Visual LISP Developer's Guide.

<span class="PreProc">================================ S Functions ===================================</span>

<h3 class="String" id="set">set</h3>

Sets the value of a quoted symbol name to an expression

(set sym expr)

The set function is similar to setq except that set evaluates both of its
arguments whereas setq only evaluates its second argument.

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol.

expr

An AutoLISP expression.

<span class="ReturnsIdentifier">Return Values</span>

The value of the expression.

<span class="ExamplesIdentifier">Examples</span>

Each of the following commands sets symbol a to 5.0:

(set 'a 5.0)

(set (read &quot;a&quot;) 5.0)

(setq a 5.0)

Both set and setq expect a symbol as their first argument, but set accepts an
expression that returns a symbol, whereas setq does not, as the following
shows:

Command: (set (read &quot;a&quot;) 5.0)

5.0

Command: (setq (read &quot;a&quot;) 5.0)

ERROR: syntax error

See Also

The <a class="Identifier" href="#setq">setq</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="set_tile">set_tile</h3>

Sets the value of a dialog box tile

(set_tile key value)

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the tile.

value

A string that names the new value to assign (initially set by the value
attribute).

<span class="ReturnsIdentifier">Return Values</span>

The value the tile was set to.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setcfg">setcfg</h3>

Writes application data to the AppData section of the acad.cfg file

(setcfg cfgname cfgval)

<span class="ArgumentsIdentifier">Arguments</span>

cfgname

A string that specifies the section and parameter to set with the value of
cfgval. The cfgname argument must be a string of the following form:

AppData/application_name/section_name/.../param_name

The string can be up to 496 characters long.

cfgval

A string. The string can be up to 512 characters in length. Larger strings are
accepted by setcfg, but cannot be returned by getcfg.

<span class="ReturnsIdentifier">Return Values</span>

If successful, setcfg returns cfgval. If cfgname is not valid, setcfg returns
nil.

<span class="ExamplesIdentifier">Examples</span>

The following code sets the WallThk parameter in the AppData/ArchStuff section
to 8, and returns the string &quot;8&quot;:

Command: (setcfg &quot;AppData/ArchStuff/WallThk&quot; &quot;8&quot;)

&quot;8&quot;

See Also

The <a class="Identifier" href="#getcfg">getcfg</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setenv">setenv</h3>

Sets a system environment variable to a specified value

(setenv varname value)

<span class="ArgumentsIdentifier">Arguments</span>

varname

A string specifying the name of the environment variable to be set. Environment
variable names must be spelled and cased exactly as they are stored in the
system registry.

value

A string specifying the value to set varname to.

<span class="ReturnsIdentifier">Return Values</span>

value

<span class="ExamplesIdentifier">Examples</span>

The following command sets the value of the MaxArray environment variable to
10000:

Command: (setenv &quot;MaxArray&quot; &quot;10000&quot;)

&quot;10000&quot;

<span class="Todo">Note</span> that changes to settings might not take effect until the next time AutoCAD
is started.

See Also

The <a class="Identifier" href="#getenv">getenv</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setfunhelp">setfunhelp</h3>

Registers a user-defined command with the Help facility so the appropriate Help
file and topic are called when the user requests help on that command

(setfunhelp c:fname [helpfile [topic <span class="Special">[command]</span>]])

<span class="ArgumentsIdentifier">Arguments</span>

c:fname

A string specifying the user-defined command (the C:XXX function). You must
include the c: prefix.

helpfile

A string naming the Help file. The file extension is not required with the
helpfile argument. If a file extension is provided, AutoCAD looks only for a
file with the exact name specified.

If no file extension is provided, AutoCAD looks for helpfile with an extension
of .chm. If no file of that name is found, AutoCAD looks for file with an
extension of .hlp.

topic

A string identifying a Help topic ID. If you are calling a topic within a CHM
file, provide the file name without the extension; AutoCAD adds an .htm
extension.

command

A string that specifies the initial state of the Help window. The command
argument is a string used by the uCommand (in HTML Help) or the fuCommand (in
WinHelp) argument of the HtmlHelp() and WinHelp() functions as defined in the
Microsoft Windows SDK.

For HTML Help files, the command parameter can be HH_ALINK_LOOKUP or
HH_DISPLAY_TOPIC. For Windows Help files, the command parameter can be
HELP_CONTENTS, HELP_HELPONHELP, or HELP_PARTIALKEY.

<span class="ReturnsIdentifier">Return Values</span>

The string passed as c:fname, if successful, otherwise, nil.

This function verifies only that the c:fname argument has the c: prefix. It
does not verify that the c:fname function exists, nor does it verify the
correctness of the other arguments supplied.

<span class="ExamplesIdentifier">Examples</span>

The following example illustrates the use of setfunhelp by defining a simple
function and issuing setfunhelp to associate the function with the circle topic
in the AutoCAD Help file (acad.chm):

(defun c:foo ()

 (getstring &quot;Press F1 for help on the foo command:&quot;)

)

(setfunhelp &quot;c:foo&quot; &quot;acad.chm&quot; &quot;circle&quot;)

After this code is loaded, issuing the foo command and then pressing F1
displays the circle topic.

This example works, but serves no real purpose. In the real world, you would
create your own Help file and associate that help file and topic with your
function.

Define a function named test:

Command: (defun c:test()(getstring &quot;\nTEST: &quot; )(princ))

C:TEST

Associate the function with a call to Help with the string &quot;line&quot;:

Command: (setfunhelp &quot;c:test&quot; &quot;acad.chm&quot; &quot;line&quot;)

&quot;c:test&quot;

Run the test command and at the prompt, press F1; you should see the Help topic
for the AutoCAD LINE command.

<span class="Todo">Note</span>:  When you use the defun function to define a C:XXX function, it removes
that function's name from those registered by setfunhelp (if one exists).
Therefore, setfunhelp should only be called after the defun call, which defines
the user-defined command.

See Also

The <a class="Identifier" href="#defun">defun</a>and <a class="Identifier" href="#help">help</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setq">setq</h3>

Sets the value of a symbol or symbols to associated expressions

(setq sym expr [sym expr]...)

This is the basic assignment function in AutoLISP. The setq function can assign
multiple symbols in one call to the function.

<span class="ArgumentsIdentifier">Arguments</span>

sym

A symbol. This argument is not evaluated.

expr

An expression.

<span class="ReturnsIdentifier">Return Values</span>

The result of the last expr evaluated.

<span class="ExamplesIdentifier">Examples</span>

The following function call sets variable a to 5.0:

Command: (setq a 5.0)

5.0

Whenever a is evaluated, it returns the real number 5.0.

The following command sets two variables, b and c:

Command: (setq b 123 c 4.7)

4.7

setq returns the value of the last variable set.

In the following example, s is set to a string:

Command: (setq s &quot;it&quot;)

&quot;it&quot;

The following example assigns a list to x:

Command: (setq x '(a b))

(A B)

See Also

The AutoLISP Variables topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setvar">setvar</h3>

Sets an AutoCAD system variable to a specified value

(setvar varname value)

<span class="ArgumentsIdentifier">Arguments</span>

varname

A string or symbol naming a variable.

value

An atom or expression whose evaluated result is to be assigned to varname. For
system variables with integer values, the supplied value must be between
-32,768 and +32,767.

<span class="ReturnsIdentifier">Return Values</span>

If successful, setvar returns value.

<span class="ExamplesIdentifier">Examples</span>

Set the AutoCAD fillet radius to 0.5 units:

Command: (setvar &quot;FILLETRAD&quot; 0.50)

0.5

<span class="Todo">Notes</span> on Using setvar

Some AutoCAD commands obtain the values of system variables before issuing any
prompts. If you use setvar to set a new value while a command is in progress,
the new value might not take effect until the next AutoCAD command.

When using the setvar function to change the AutoCAD system variable ANGBASE,
the value argument is interpreted as radians. This differs from the AutoCAD
SETVAR command, which interprets this argument as degrees. When using the
setvar function to change the AutoCAD system variable SNAPANG, the value
argument is interpreted as radians relative to the AutoCAD default direction
for angle 0, which is east or 3 o'clock. This also differs from the SETVAR
command, which interprets this argument as degrees relative to the ANGBASE
setting.

<span class="Todo">Note</span>:  The UNDO command does not undo changes made to the CVPORT system
variable by the setvar function.

You can find a list of the current AutoCAD system variables in the Command
Reference.

See Also

The <a class="Identifier" href="#getvar">getvar</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setview">setview</h3>

Establishes a view for a specified viewport

(setview view_descriptor <span class="Special">[vport_id]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

view_descriptor

An entity definition list similar to that returned by tblsearch when applied to
the VIEW symbol table.

vport_id

An integer identifying the viewport to receive the new view. If vport_id is 0,
the current viewport receives the new view.

You can obtain the vport_id number from the CVPORT system variable.

<span class="ReturnsIdentifier">Return Values</span>

If successful, the setview function returns the view_descriptor.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="sin">sin</h3>

Returns the sine of an angle as a real number expressed in radians

(sin ang)

<span class="ArgumentsIdentifier">Arguments</span>

ang

An angle, in radians.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing the sine of ang, in radians.

<span class="ExamplesIdentifier">Examples</span>

Command: (sin 1.0)

0.841471

Command: (sin 0.0)

0.0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="slide_image">slide_image</h3>

Displays an AutoCAD slide in the currently active dialog box image tile

(slide_image x1 y1 width height sldname)

<span class="ArgumentsIdentifier">Arguments</span>

x1

X-offset from the upper-left corner of the tile, in pixels. Must be a positive
value.

y1

Y-offset from the upper-left corner of the tile, in pixels. Must be a positive
value.

width

Width of the image, in pixels.

height

Height of the image, in pixels.

sldname

Identifies the slide. This argument can be a slide file (.sld) or a slide in a
slide library file (.slb). Specify sldname the same way you would specify it
for the VSLIDE command or for a menu file (see the Creating Images topic in the
Visual LISP Developer's Guide). Use one of the following formats for sldname:

sldname or libname(sldname)

The first (upper-left) corner of the slide--its insertion point--is located at
(x1,y1), and the second (lower-right) corner is located at the relative
distance (wid,hgt) from the first (wid and hgt must be positive values). The
origin (0,0) is the upper-left corner of the image. You obtain the coordinates
of the lower-right corner by calling the dimension functions (dimx_tile and
dimy_tile).

<span class="ReturnsIdentifier">Return Values</span>

A string containing sldname.

<span class="ExamplesIdentifier">Examples</span>

(slide_image

 0

 0

 (dimx_tile &quot;slide_tile&quot;)

 (dimy_tile &quot;slide_tile&quot;)

 &quot;myslide&quot;

)

(end_image)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="snvalid">snvalid</h3>

Checks the symbol table name for valid characters

(snvalid sym_name <span class="Special">[flag]</span>)

The snvalid function inspects the system variable EXTNAMES to determine the
rules to enforce for the active drawing. If EXTNAMES is 0, snvalid validates
using the symbol name rules in effect prior to AutoCAD 2000. If EXTNAMES is 1
(the default value), snvalid validates using the rules for extended symbol
names introduced with AutoCAD 2000. The following are not allowed in any symbol
names, regardless of the setting of EXTNAMES:

<span class="Statement">  </span>* Control and graphic characters

<span class="Statement">  </span>* Null strings

<span class="Statement">  </span>* Vertical bars as the first or last character of the name

AutoLISP does not enforce restrictions on the length of symbol table names if
extnames is 1.

<span class="ArgumentsIdentifier">Arguments</span>

sym_name

A string that specifies a symbol table name.

flag

An integer that specifies whether the vertical bar character is allowed within
sym_name. The flag argument can be one of the following:

0 Do not allow vertical bar characters anywhere in sym_name. This is the
default.

1 Allow vertical bar characters in sym_name, as long as they are not the first
or last characters in the name.

<span class="ReturnsIdentifier">Return Values</span>

T, if sym_name is a valid symbol table name, otherwise nil.

If extnames is 1, all characters are allowed except control and graphic
characters and the following:

+------------------------------------------+-----------------------------------+
|                 Characters disallowed in symbol table names                  |
+------------------------------------------+-----------------------------------+
| &lt; &gt;                                      | less-than and greater-than symbol |
+------------------------------------------+-----------------------------------+
| / \                                      | forward slash and backslash       |
+------------------------------------------+-----------------------------------+
| &quot;                                        | quotation mark                    |
+------------------------------------------+-----------------------------------+
| :                                        | colon                             |
+------------------------------------------+-----------------------------------+
| ?                                        | question mark                     |
+------------------------------------------+-----------------------------------+
| *                                        | asterisk                          |
+------------------------------------------+-----------------------------------+
| |                                        | vertical bar                      |
+------------------------------------------+-----------------------------------+
| ,                                        | comma                             |
+------------------------------------------+-----------------------------------+
| =                                        | equal sign                        |
+------------------------------------------+-----------------------------------+
| `                                        | backquote                         |
+------------------------------------------+-----------------------------------+
| ;                                        | Semi-colon (ASCII 59)             |
+------------------------------------------+-----------------------------------+
A symbol table name may contain spaces.

If extnames is 0, symbol table names can consist of upper- and lowercase
alphabetic letters (e.g., A-Z), numeric digits (e.g., 0-9), and the dollar sign
($), underscore (_), and hyphen (-) characters.

<span class="ExamplesIdentifier">Examples</span>

The following examples assume EXTNAMES is set to 1:

Command: (snvalid &quot;hocus-pocus&quot;)

T

Command: (snvalid &quot;hocus pocus&quot;)

T

Command: (snvalid &quot;hocus%pocus&quot;)

T

The following examples assume EXTNAMES is set to 0:

Command: (snvalid &quot;hocus-pocus&quot;)

T

Command: (snvalid &quot;hocus pocus&quot;)

nil

Command: (snvalid &quot;hocus%pocus&quot;)

nil

The following example includes a vertical bar in the symbol table name:

Command: (snvalid &quot;hocus|pocus&quot;)

nil

By default, the vertical bar character is considered invalid in all symbol
table names.

In the following example, the flag argument is set to 1, so snvalid considers
the vertical bar character to be valid in sym_name, as long as it is not the
first or last character in the name:

Command: (snvalid &quot;hocus|pocus&quot; 1)

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="sqrt">sqrt</h3>

Returns the square root of a number as a real number

(sqrt num)

<span class="ArgumentsIdentifier">Arguments</span>

num

A number (integer or real).

<span class="ReturnsIdentifier">Return Values</span>

A real number.

<span class="ExamplesIdentifier">Examples</span>

Command: (sqrt 4)

2.0

Command: (sqrt 2.0)

1.41421

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssadd">ssadd</h3>

Adds an object (entity) to a selection set, or creates a new selection set

(ssadd [ename <span class="Special">[ss]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

ename

An entity name.

ss

A selection set.

If called with no arguments, ssadd constructs a new selection set with no
members. If called with the single entity name argument ename, ssadd constructs
a new selection set containing that single entity. If called with an entity
name and the selection set ss, ssadd adds the named entity to the selection
set.

<span class="ReturnsIdentifier">Return Values</span>

The new or modified selection set.

<span class="ExamplesIdentifier">Examples</span>

When adding an entity to a set, the new entity is added to the existing set,
and the set passed as ss is returned as the result. Thus, if the set is
assigned to other variables, they also reflect the addition. If the named
entity is already in the set, the ssadd operation is ignored and no error is
reported.

Set e1 to the name of the first entity in drawing:

Command: (setq e1 (entnext))

&lt;Entity name: 1d62d60&gt;

Set ss to a null selection set:

Command: (setq ss (ssadd))

&lt;Selection set: 2&gt;

The following command adds the e1 entity to the selection set referenced by ss:

Command: (ssadd e1 ss)

&lt;Selection set: 2&gt;

Get the entity following e1:

Command: (setq e2 (entnext e1))

&lt;Entity name: 1d62d68&gt;

Add e2 to the ss entity:

Command: (ssadd e2 ss)

&lt;Selection set: 2&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssdel">ssdel</h3>

Deletes an object (entity) from a selection set

(ssdel ename ss)

<span class="ArgumentsIdentifier">Arguments</span>

ename

An entity name.

ss

A selection set.

<span class="ReturnsIdentifier">Return Values</span>

The name of the selection set, or nil, if the specified entity is not in the
set.

<span class="Todo">Note</span> that the entity is actually deleted from the existing selection set, as
opposed to a new set being returned with the element deleted.

<span class="ExamplesIdentifier">Examples</span>

In the following examples, entity name e1 is a member of selection set ss,
while entity name e3 is not a member of ss:

Command: (ssdel e1 ss)

&lt;Selection set: 2&gt;

Selection set ss is returned with entity e1 removed.

Command: (ssdel e3 ss)

nil

The function returns nil because e3 is not a member of selection set ss.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssget">ssget</h3>

Creates a selection set from the selected object

(ssget <span class="Special">[sel-method]</span> [pt1 <span class="Special">[pt2]</span>] <span class="Special">[pt-list]</span> <span class="Special">[filter-list]</span>)

Selection sets can contain objects from both paper and model space, but when
the selection set is used in an operation, ssget filters out objects from the
space not currently in effect. Selection sets returned by ssget contain main
entities only (no attributes or polyline vertices).

<span class="ArgumentsIdentifier">Arguments</span>

sel-method

A string that specifies the object selection method. Valid selection methods
are:

C Crossing selection.

CP Cpolygon selection (all objects crossing and inside of the specified
polygon).

F Fence selection.

I Implied selection (objects selected while PICKFIRST is in effect).

L Last visible object added to the database.

P Last selection set created.

W Window selection.

WP WPolygon (all objects within the specified polygon).

X Entire database. If you specify the X selection method and do not provide a
filter-list, ssget selects all entities in the database, including entities on
layers that are off, frozen, and out of the visible screen.

:E Everything within the cursor's object selection pickbox.

:<span class="Special">N</span> Call ssnamex for additional information on container blocks and
transformation matrices for any entities selected during the ssget operation.
This additional information is available only for entities selected via
graphical selection methods such as Window, Crossing, and point picks.

Unlike the other object selection methods, :<span class="Special">N</span> may return multiple entities with
the same entity name in the selection set. For example, if the user selects a
subentity of a complex entity such as a BlockReference, PolygonMesh, or old
style polyline, ssget looks at the subentity that is selected when determining
if it has already been selected. However, ssget actually adds the main entity
(BlockReference, PolygonMesh, etc.) to the selection set. The result could be
multiple entries with the same entity name in the selection set (each will have
different subentity information for ssnamex to report).

:S  Allow single selection only.

pt1

A point relative to the selection.

pt2

A point relative to the selection.

pt-list

A list of points.

filter-list

An association list that specifies object properties. Objects that match the
filter-list are added to the selection set.

If you omit all arguments, ssget prompts the user with the Select objects
prompt, allowing interactive construction of a selection set.

If you supply a point but do not specify an object selection method, AutoCAD
assumes the user is selecting an object by picking a single point.

<span class="ReturnsIdentifier">Return Values</span>

The name of the created selection set if successful, or nil if no objects were
selected.

<span class="Todo">Notes</span> on the Object Selection Methods

<span class="Statement">  </span>* When using the :<span class="Special">N</span> selection method, if the user selects a subentity of a
    complex entity such as a BlockReference, PolygonMesh, or old style
    polyline, ssget looks at the subentity that is selected when determining if
    it has already been selected. However, ssget actually adds the main entity
    (BlockReference, PolygonMesh, etc.) to the selection set. It is therefore
    possible to have multiple entries with the same entity name in the
    selection set (each will have different subentity information for ssnamex
    to report). Because the :<span class="Special">N</span> method does not guarantee that each entry will
    be unique, code that relies on uniqueness should not use selection sets
    created using this option.

<span class="Statement">  </span>* When using the L selection method in an MDI environment, you cannot always
    count on the last object drawn to remain visible. For example, if your
    application draws a line, and the user subsequently minimizes or cascades
    the AutoCAD drawing window, the line may no longer be visible. If this
    occurs, ssget with the &quot;L&quot; option will return nil.

<span class="ExamplesIdentifier">Examples</span>

Prompt the user to select the objects to be placed in a selection set:

Command: (ssget)

&lt;Selection set: 2&gt;

Create a selection set of the object passing through (2,2):

Command: (ssget '(2 2))

nil

Create a selection set of the most recently selected objects:

Command: (ssget &quot;_P&quot;)

&lt;Selection set: 4&gt;

Create a selection set of the objects crossing the box from (0,0) to (1,1):

Command: (ssget &quot;_C&quot; '(0 0) '(1 1))

&lt;Selection set: b&gt;

Create a selection set of the objects inside the window from (0,0):

Command: (ssget &quot;_W&quot; '(0 0) '(5 5))

&lt;Selection set: d&gt;

By specifying filters, you can obtain a selection set that includes all objects
of a given type, on a given layer, or of a given color. The following example
returns a selection set that consists only of blue lines that are part of the
implied selection set (those objects selected while PICKFIRST is in effect):

Command: (ssget &quot;_I&quot; '((0 . &quot;LINE&quot;) (62 . 5)))

&lt;Selection set: 4&gt;

The following examples of ssget require that a list of points be passed to the
function. The pt_list variable cannot contain points that define zero-length
segments.

Create a list of points:

Command: (setq pt_list '((1 1)(3 1)(5 2)(2 4)))

((1 1) (3 1) (5 2) (2 4))

Create a selection set of all objects crossing and inside the polygon defined
by pt_list:

Command: (ssget &quot;_CP&quot; pt_list)

&lt;Selection set: 13&gt;

Create a selection set of all blue lines inside the polygon defined by pt_list:

Command: (ssget &quot;_WP&quot; pt_list '((0 . &quot;LINE&quot;) (62 . 5)))

&lt;Selection set: 8&gt;

The selected objects are highlighted only when ssget is used with no arguments.
Selection sets consume AutoCAD temporary file slots, so AutoLISP is not
permitted to have more than 128 open at one time. If this limit is reached,
AutoCAD refuses to create any more selection sets and returns nil to all ssget
calls. To close an unnecessary selection set variable, set it to nil.

A selection set variable can be passed to AutoCAD in response to any Select
objects prompt at which selection by Last is valid. AutoCAD then selects all
the objects in the selection set variable.

The current setting of Object Snap mode is ignored by ssget unless you
specifically request it while you are in the function.

See Also

The Selection Set Handling and Selection Set Filter Lists topics in the Visual
LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssgetfirst">ssgetfirst</h3>

Determines which objects are selected and gripped

(ssgetfirst)

Returns a list of two selection sets similar to those passed to sssetfirst. The
first element in the list is a selection set of entities that are gripped but
not selected. The second element is a selection set of entities that are both
gripped and selected. Either (or both) elements of the list can be nil.

<span class="Todo">Note</span>:  Only entities from the current drawing's model space and paper space,
not nongraphical objects or entities in other block definitions, can be
analyzed by this function.

See Also

The <a class="Identifier" href="#ssget">ssget</a>and <a class="Identifier" href="#sssetfirst">sssetfirst</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="sslength">sslength</h3>

Returns an integer containing the number of objects (entities) in a selection
set

(sslength ss)

<span class="ArgumentsIdentifier">Arguments</span>

ss

A selection set.

<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

Add the last object to a new selection set:

Command: (setq sset (ssget &quot;L&quot;))

&lt;Selection set: 8&gt;

Use sslength to determine the number of objects in the new selection set:

Command: (sslength sset)

1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssmemb">ssmemb</h3>

Tests whether an object (entity) is a member of a selection set

(ssmemb ename ss)

<span class="ArgumentsIdentifier">Arguments</span>

ename

An entity name.

ss

A selection set.

<span class="ReturnsIdentifier">Return Values</span>

If ename is a member of ss, ssmemb returns the entity name. If ename is not a
member, ssmemb returns nil.

<span class="ExamplesIdentifier">Examples</span>

In the following examples, entity name e2 is a member of selection set ss,
while entity name e1 is not a member of ss:

Command: (ssmemb e2 ss)

&lt;Entity name: 1d62d68&gt;

Command: (ssmemb e1 ss)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssname">ssname</h3>

Returns the object (entity) name of the indexed element of a selection set

(ssname ss index)

Entity names in selection sets obtained with ssget are always names of main
entities. Subentities (attributes and polyline vertices) are not returned. (The
entnext function allows access to them.)

<span class="ArgumentsIdentifier">Arguments</span>

ss

A selection set.

index

An integer (or real) indicating an element in a selection set. The first
element in the set has an index of zero. To access entities beyond the 32767th
one in a selection set, you must supply the index argument as a real.

<span class="ReturnsIdentifier">Return Values</span>

An entity name, if successful. If index is negative or greater than the highest
numbered entity in the selection set, ssname returns nil.

<span class="ExamplesIdentifier">Examples</span>

Get the name of the first entity in a selection set:

Command: (setq ent1 (ssname ss 0))

&lt;Entity name: 1d62d68&gt;

Get the name of the fourth entity in a selection set:

Command: (setq ent4 (ssname ss 3))

&lt;Entity name: 1d62d90&gt;

To access entities beyond the 32767th one in a selection set, you must supply
the index argument as a real, as in the following example:

(setq entx (ssname sset 50843.0))

See Also

The <a class="Identifier" href="#entnext">entnext</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ssnamex">ssnamex</h3>

Retrieves information about how a selection set was created

(ssnamex ss <span class="Special">[index]</span>)

Only selection sets with entities from the current drawing's model space and
paper space--not nongraphical objects or entities in other block
definitions--can be retrieved by this function.

<span class="ArgumentsIdentifier">Arguments</span>

ss

A selection set.

index

An integer (or real) indicating an element in a selection set. The first
element in the set has an index of zero.

<span class="ReturnsIdentifier">Return Values</span>

If successful, ssnamex returns the name of the entity at index, along with data
describing how the entity was selected. If the index argument is not supplied,
this function returns a list containing the entity names of all of the elements
in the selection set, along with data that describes how each entity was
selected. If index is negative or greater than the highest numbered entity in
the selection set, ssnamex returns nil.

The data returned by ssnamex takes the form of a list of lists that contains
information that either describes an entity and its selection method or a
polygon used to select one or more entities. Each sublist that describes the
selection of a particular entity comprises three parts: the selection method ID
(an integer &gt;= 0), the entity name of the selected entity, and selection method
specific data that describes how the entity was selected.

((sel_id1 ename1 (data))(sel_id2 ename2 (data)) ... )

The following table lists the selection method IDs:

          +----------------------+-----------------------------------+
          |                   Selection method IDs                   |
          +----------------------+-----------------------------------+
          |          ID          |            Description            |
          +----------------------+-----------------------------------+
          | 0                    | nonspecific (i.e., Last All etc.) |
          +----------------------+-----------------------------------+
          | 1                    | Pick                              |
          +----------------------+-----------------------------------+
          | 2                    | Window or WPolygon                |
          +----------------------+-----------------------------------+
          | 3                    | Crossing or CPolygon              |
          +----------------------+-----------------------------------+
          | 4                    | Fence                             |
          +----------------------+-----------------------------------+
Each sublist that describes a polygon and is used during entity selection takes
the form of a polygon ID (an integer &lt; 0), followed by point descriptions.

(polygon_id point_description_1 point_description_n... )

Polygon ID numbering starts at -1 and each additional polygon ID is incremented
by -1. Depending on the viewing location, a point is represented as one of the
following: an infinite line, a ray, or a line segment. A point descriptor
comprises three parts: a point descriptor ID (the type of item being
described), the start point of the item, and an optional unit vector that
describes either the direction in which the infinite line travels or a vector
that describes the offset to the other side of the line segment.

(point_descriptor_id base_point <span class="Special">[unit_or_offset_vector]</span>)

The following table lists the valid point descriptor IDs:

                    +----------------------+---------------+
                    |         Point descriptor IDs         |
                    +----------------------+---------------+
                    |          ID          |  Description  |
                    +----------------------+---------------+
                    | 0                    | Infinite line |
                    +----------------------+---------------+
                    | 1                    | Ray           |
                    +----------------------+---------------+
                    | 2                    | Line segment  |
                    +----------------------+---------------+
The unit_or_offset_vector is returned when the view point is something other
than 0,0,1.

<span class="ExamplesIdentifier">Examples</span>

The data associated with Pick (type 1) entity selections is a single point
description. For example, the following record is returned for the selection of
an entity picked at 1,1 in plan view of the WCS:

Command: (ssnamex ss3 0)

((1 &lt;Entity name: 1d62da0&gt; 0 (0 (1.0 1.0 0.0))))

The data associated with an entity selected with the Window, WPolygon,
Crossing, or CPolygon method is the integer ID of the polygon that selected the
entity. It is up to the application to associate the polygon identifiers and
make the connection between the polygon and the entities it selected. For
example, the following returns an entity selected by Crossing (<span class="Todo">note</span> that the
polygon ID is -1):

Command: (ssnamex ss4 0)

((3 &lt;Entity name: 1d62d60&gt; 0 -1) (-1 (0 (-1.80879 8.85536 0.0)) (0 (13.4004
8.85536 0.0)) (0 (13.4004 1.80024 0.0)) (0 (-1.80879 1.80024 0.0))))

The data associated with Fence selections is a list of points and descriptions
for the points where the fence and entity visually intersect. For example, the
following command returns information for a nearly vertical line intersected
three times by a Z-shaped fence:

Command: (ssnamex ss5 0)

((4 &lt;Entity name: 1d62d88&gt; 0 (0 (5.28135 6.25219 0.0) ) (0 (5.61868 2.81961
0.0) ) (0 (5.52688 3.75381 0.0) ) ) )

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="sssetfirst">sssetfirst</h3>

Sets which objects are selected and gripped

(sssetfirst gripset <span class="Special">[pickset]</span>)

The selection set of objects specified by the gripset argument are gripped, and
the selection set of objects specified by pickset are both gripped and
selected. If any objects are common to both selection sets, sssetfirst grips
and selects the selection set specified by pickset only (it does not grip the
gripset set).

You are responsible for creating a valid selection set. For example, you may
need to verify that a background paper space viewport (DXF group code 69) is
not included in the selection set. You may also need to ensure that selected
objects belong to the current layout, as in the following code:

(setq ss (ssget (list (cons 410 (getvar &quot;ctab&quot;)))))

<span class="ArgumentsIdentifier">Arguments</span>

gripset

A selection set to be gripped. If gripset is nil and pickset is specified,
sssetfirst grips and selects pickset. If gripset is nil and no pickset is
specified, sssetfirst turns off the grip handles and selections it previously
turned on.

pickset

A selection set to be selected.

<span class="ReturnsIdentifier">Return Values</span>

The selection set or sets specified.

<span class="ExamplesIdentifier">Examples</span>

First, draw a square and build three selection sets. Begin by drawing side 1
and creating a selection set to include the line drawn:

Command: (entmake (list (cons 0 &quot;line&quot;) '(10 0.0 0.0 0.0)'(11 0.0 10.0 0.0)))

((0 . &quot;line&quot;) (10 0.0 0.0 0.0) (11 0.0 10.0 0.0))

Command: (setq gripset (ssget &quot;_l&quot;))

&lt;Selection set: a5&gt;

Variable gripset points to the selection set created.

Draw side 2 and add it to the gripset selection set:

Command: (entmake (list (cons 0 &quot;line&quot;) '(10 0.0 10.0 0.0)'(11 10.0 10.0 0.0)))

((0 . &quot;line&quot;) (10 0.0 10.0 0.0) (11 10.0 10.0 0.0))

Command: (ssadd (entlast) gripset)

&lt;Selection set: a5&gt;

Create another selection set to include only side 2:

Command: (setq 2onlyset (ssget &quot;_l&quot;))

&lt;Selection set: a8&gt;

Draw side 3 and add it to the gripset selection set:

Command: (entmake (list (cons 0 &quot;line&quot;) '(10 10.0 10.0 0.0)'(11 10.0 0.0 0.0)))

((0 . &quot;line&quot;) (10 10.0 10.0 0.0) (11 10.0 0.0 0.0))

Command: (ssadd (entlast) gripset)

&lt;Selection set: a5&gt;

Create another selection and include side 3 in the selection set:

Command: (setq pickset (ssget &quot;_l&quot;))

&lt;Selection set: ab&gt;

Variable pickset points to the new selection set.

Draw side 4 and add it to the gripset and pickset selection sets:

Command: (entmake (list (cons 0 &quot;line&quot;) '(10 10.0 0.0 0.0)'(11 0.0 0.0 0.0)))

((0 . &quot;line&quot;) (10 10.0 0.0 0.0) (11 0.0 0.0 0.0))

Command: (ssadd (entlast) gripset)

&lt;Selection set: a5&gt;

Command: (ssadd (entlast) pickset)

&lt;Selection set: ab&gt;

At this point, gripset contains sides 1-4, pickset contains sides 3 and 4, and
2onlyset contains only side 2.

Turn grip handles on for all objects in the gripset selection set:

Command: (sssetfirst gripset)

(&lt;Selection set: a5&gt;)

Turn grip handles off for all objects in gripset:

Command: (sssetfirst nil)

(nil)

Turn grip handles on and select all objects in pickset:

Command: (sssetfirst nil pickset)

(nil &lt;Selection set: ab&gt;)

Turn on grip handles for all objects in 2onlyset, and select all objects in
pickset:

Command: (sssetfirst 2onlyset pickset)

(&lt;Selection set: a8&gt; &lt;Selection set: ab&gt;)

Each sssetfirst call replaces the gripped and selected selection sets from the
previous sssetfirst call. For example, after the following command is issued,
grips are turned on in 2onlyset, and no selection set is selected:

Command: (sssetfirst 2onlyset

(&lt;Selection set: a8&gt;)

<span class="Todo">Note</span>:  Do not call sssetfirst when AutoCAD is in the middle of executing a
command.

See Also

The <a class="Identifier" href="#ssget">ssget</a> and <a class="Identifier" href="#ssgetfirst">ssgetfirst</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="startapp">startapp</h3>

Starts a Windows application

(startapp appcmd <span class="Special">[file]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

appcmd

A string that specifies the application to execute. If appcmd does not include
a full path name, startapp searches the directories in the PATH environment
variable for the application.

file

A string that specifies the file name to be opened.

<span class="ReturnsIdentifier">Return Values</span>

An integer greater than 0, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following code starts the Windows Notepad and opens the acad.lsp file.

Command: (startapp &quot;notepad&quot; &quot;acad.lsp&quot;)

33

If an argument has embedded spaces, it must be surrounded by literal double
quotes. For example, to edit the file my stuff.txt with Notepad, use the
following syntax:

Command: (startapp &quot;notepad.exe&quot; &quot;\&quot;my stuff.txt\&quot;&quot;)

33

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="start_dialog">start_dialog</h3>

Displays a dialog box and begins accepting user input

(start_dialog)

You must first initialize the dialog box by a previous new_dialog call. The
dialog box remains active until an action expression or callback function calls
done_dialog. Usually done_dialog is associated with the tile whose key is
&quot;accept&quot; (typically the OK button) and the tile whose key is &quot;cancel&quot;
(typically the Cancel button).

The start_dialog function has no arguments.

<span class="ReturnsIdentifier">Return Values</span>

The start_dialog function returns the optional status passed to done_dialog.
The default value is 1 if the user presses OK, 0 if the user presses Cancel, or
-1 if all dialog boxes are terminated with term_dialog. If done_dialog is
passed an integer status greater than 1, start_dialog returns this value, whose
meaning is determined by the application.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="start_image">start_image</h3>

Starts the creation of an image in the dialog box tile

(start_image key)

Subsequent calls to fill_image, slide_image, and vector_image affect the
created image until the application calls end_image.

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the dialog box tile. The key argument is
case-sensitive.

<span class="ReturnsIdentifier">Return Values</span>

The key argument, if successful, nil otherwise.

<span class="Todo">Note</span>:  Do not use the set_tile function between start_image and end_image
function calls.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="start_list">start_list</h3>

Starts the processing of a list in the list box or in the pop-up list dialog
box tile

(start_list key [operation <span class="Special">[index]</span>])

Subsequent calls to add_list affect the list started by start_list until the
application calls end_list.

<span class="ArgumentsIdentifier">Arguments</span>

key

A string that specifies the dialog box tile. The key argument is
case-sensitive.

operation

An integer indicating the type of list operation to perform. You can specify
one of the following:

1 Change selected list contents

2 Append new list entry

3 Delete old list and create new list (the default)

index

A number indicating the list item to change by the subsequent add_list call.
The first item in the list is index 0. If not specified, index defaults to 0.

The index argument is ignored if start_list is not performing a change
operation.

<span class="ReturnsIdentifier">Return Values</span>

The name of the list that was started.

<span class="Todo">Note</span>:  Do not use the set_tile function between start_list and end_list
function calls.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="strcase">strcase</h3>

Returns a string where all alphabetic characters have been converted to
uppercase or lowercase

(strcase string <span class="Special">[which]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

which

If specified as T, all alphabetic characters in string are converted to
lowercase. Otherwise, characters are converted to uppercase.

<span class="ReturnsIdentifier">Return Values</span>

A string.

<span class="ExamplesIdentifier">Examples</span>

Command: (strcase &quot;Sample&quot;)

&quot;SAMPLE&quot;

Command: (strcase &quot;Sample&quot; T)

&quot;sample&quot;

The strcase function will correctly handle case mapping of the currently
configured character set.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="strcat">strcat</h3>

Returns a string that is the concatenation of multiple strings

(strcat [string <span class="Special">[string]</span>...])

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

<span class="ReturnsIdentifier">Return Values</span>

A string. If no arguments are supplied, strcat returns a zero-length string.

<span class="ExamplesIdentifier">Examples</span>

Command: (strcat &quot;a&quot; &quot;bout&quot;)

&quot;about&quot;

Command: (strcat &quot;a&quot; &quot;b&quot; &quot;c&quot;)

&quot;abc&quot;

Command: (strcat &quot;a&quot; &quot;&quot; &quot;c&quot;)

&quot;ac&quot;

Command: (strcat)

&quot;&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="strlen">strlen</h3>

Returns an integer that is the number of characters in a string

(strlen <span class="Special">[string]</span>...)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

<span class="ReturnsIdentifier">Return Values</span>

An integer. If multiple string arguments are provided, strlen returns the sum
of the lengths of all arguments. If you omit the arguments or enter an empty
string, strlen returns 0.

<span class="ExamplesIdentifier">Examples</span>

Command: (strlen &quot;abcd&quot;)

4

Command: (strlen &quot;ab&quot;)

2

Command: (strlen &quot;one&quot; &quot;two&quot; &quot;four&quot;)

10

Command: (strlen)

0

Command: (strlen &quot;&quot;)

0

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="subst">subst</h3>

Searches a list for an old item and returns a copy of the list with a new item
substituted in place of every occurrence of the old item

(subst newitem olditem lst)

<span class="ArgumentsIdentifier">Arguments</span>

newitem

An atom or list.

olditem

An atom or list.

lst

A list.

<span class="ReturnsIdentifier">Return Values</span>

A list, with newitem replacing all occurrences of olditem. If olditem is not
found in lst, subst returns lst unchanged.

<span class="ExamplesIdentifier">Examples</span>

Command: (setq sample '(a b (c d) b))

(A B (C D) B)

Command: (subst 'qq 'b sample)

(A QQ (C D) QQ)

Command: (subst 'qq 'z sample)

(A B (C D) B)

Command: (subst 'qq '(c d) sample)

(A B QQ B)

Command: (subst '(qq rr) '(c d) sample)

(A B (QQ RR) B)

Command: (subst '(qq rr) 'z sample)

(A B (C D) B)

When used in conjunction with assoc, subst provides a convenient means of
replacing the value associated with one key in an association list, as
demonstrated by the following function calls.

Set variable who to an association list:

Command: (setq who '((first john) (mid q) (last public)))

((FIRST JOHN) (MID Q) (LAST PUBLIC))

The following sets old to (FIRST JOHN) and new to (FIRST J):

Command: (setq old (assoc 'first who) new '(first j))

(FIRST J)

Finally, replace the value of the first item in the association list:

Command: (subst new old who)

((FIRST J) (MID Q) (LAST PUBLIC))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="substr">substr</h3>

Returns a substring of a string

(substr string start <span class="Special">[length]</span>)

The substr function starts at the start character position of string and
continues for length characters.

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

start

A positive integer indicating the starting position in string. The first
character in the string is position 1.

length

A positive integer specifying the number of characters to search through in
string. If length is not specified, the substring continues to the end of
string.

<span class="Todo">Note</span>:  The first character of string is character number 1. This differs from
other functions that process elements of a list (like nth and ssname) that
count the first element as 0.

<span class="ReturnsIdentifier">Return Values</span>

A string.

<span class="ExamplesIdentifier">Examples</span>

Command: (substr &quot;abcde&quot; 2)

&quot;bcde&quot;

Command: (substr &quot;abcde&quot; 2 1)

&quot;b&quot;

Command: (substr &quot;abcde&quot; 3 2)

&quot;cd&quot;

<span class="PreProc">================================ T Functions ===================================</span>

<h3 class="String" id="tablet">tablet</h3>

Retrieves and sets digitizer (tablet) calibrations

(tablet code [row1 row2 row3 direction])

<span class="ArgumentsIdentifier">Arguments</span>

code

An integer that can be one of the following:

0 Return the current digitizer calibration. In this case, the remaining
arguments must be omitted.

1 Set the calibration according to the arguments that follow. In this case, you
must provide the new calibration settings (row1, row2, row3, and direction).

row1, row2, row3

Three 3D points. These three arguments specify the three rows of the tablet's
transformation matrix.

The third element in row3 (Z) should always equal 1: tablet returns it as 1
even if you specify a different value in row3.

direction

One 3D point. This is the vector (expressed in the World Coordinate System, or
WCS) that is normal to the plane that represents the surface of the tablet.

If the specified direction isn't normalized, tablet corrects it, so the
direction it returns when you set the calibration may differ from the value you
passed.

<span class="ReturnsIdentifier">Return Values</span>

If tablet fails, it returns nil and sets the ERRNO system variable to a value
that indicates the reason for the failure (see appendix C, AutoLISP Error Codes
in the Visual LISP Developer's Guide). This can happen if the digitizer is not
a tablet.

<span class="ExamplesIdentifier">Examples</span>

A very simple transformation that can be established with tablet is the
identity transformation:

(tablet 1 '(1 0 0) '(0 1 0) '(0 0 1) '(0 0 1))

With this transformation in effect, AutoCAD will receive, effectively, raw
digitizer coordinates from the tablet. For example, if you pick the point with
digitizer coordinates (5000,15000), AutoCAD will see it as the point in your
drawing with those same coordinates.

The TABMODE system variable allows AutoLISP routines to toggle the tablet on
and off.

See Also

The Calibrating Tablets topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="tblnext">tblnext</h3>

Finds the next item in a symbol table

(tblnext table-name <span class="Special">[rewind]</span>)

When tblnext is used repeatedly, it normally returns the next entry in the
specified table each time. The tblsearch function can set the next entry to be
retrieved. If the rewind argument is present and is not nil, the symbol table
is rewound and the first entry in it is retrieved.

<span class="ArgumentsIdentifier">Arguments</span>

table-name

A string that identifies a symbol table. Valid table-name values are &quot;LAYER&quot;,
&quot;LTYPE&quot;, &quot;VIEW&quot;, &quot;STYLE&quot;, &quot;BLOCK&quot;, &quot;UCS&quot;, &quot;APPID&quot;, &quot;DIMSTYLE&quot;, and &quot;VPORT&quot;. The
argument is not case sensitive.

rewind

If this argument is present and is not nil, the symbol table is rewound and the
first entry in it is retrieved.

<span class="ReturnsIdentifier">Return Values</span>

If a symbol table entry is found, the entry is returned as a list of dotted
pairs of DXF-type codes and values. If there are no more entries in the table,
nil is returned. Deleted table entries are never returned.

<span class="ExamplesIdentifier">Examples</span>

Retrieve the first layer in the symbol table:

Command: (tblnext &quot;layer&quot; T)

((0 . &quot;LAYER&quot;) (2 . &quot;0&quot;) (70 . 0) (62 . 7) (6 . &quot;CONTINUOUS&quot;))

The return values represent the following:

(0 . &quot;LAYER&quot;) Symbol type

(2 . &quot;0&quot;) Symbol name

(70 . 0) Flags

(62 . 7) Color number, negative if off

(6 . &quot;CONTINUOUS&quot;) Linetype name

<span class="Todo">Note</span> that there is no -1 group. The last entry returned from each table is
stored, and the next one is returned each time tblnext is called for that
table. When you begin scanning a table, be sure to supply a non-nil second
argument to rewind the table and to return the first entry.

Entries retrieved from the block table include a -2 group with the entity name
of the first entity in the block definition (if any). For example, the
following command obtains information about a block called BOX:

Command: (tblnext &quot;block&quot;)

((0 . &quot;BLOCK&quot;) (2 . &quot;BOX&quot;) (70 . 0) (10 9.0 2.0 0.0) (-2 . &lt;Entity name:
1dca370&gt;))

The return values represent the following:

(0 . &quot;BLOCK&quot;) Symbol type

(2 . &quot;BOX&quot;) Symbol name

(70 . 0) Flags

(10 9.0 2.0 0.0) Origin X,Y,Z

(-2 . &lt;Entity name: 1dca370&gt;) First entity

The entity name in the -2 group is accepted by entget and entnext, but not by
other entity access functions. For example, you cannot use ssadd to put it in a
selection set. By providing the -2 group entity name to entnext, you can scan
the entities comprising a block definition; entnext returns nil after the last
entity in the block definition.

If a block contains no entities, the -2 group returned by tblnext is the entity
name of its endblk entity.

<span class="Todo">Note</span>:  The vports function returns current VPORT table information, therefore
it may be easier to use vports as opposed to tblnext to retrieve this
information.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="tblobjname">tblobjname</h3>

Returns the entity name of a specified symbol table entry

(tblobjname table-name symbol)

<span class="ArgumentsIdentifier">Arguments</span>

table-name

A string that identifies the symbol table to be searched. The argument is not
case sensitive.

symbol

A string identifying the symbol to be searched for.

<span class="ReturnsIdentifier">Return Values</span>

The entity name of the symbol table entry, if found.

The entity name returned by tblobjname can be used in entget and entmod
operations.

<span class="ExamplesIdentifier">Examples</span>

The following command searches for the entity name of the block entry &quot;ESC-01&quot;:

Command: (tblobjname &quot;block&quot; &quot;ESC-01&quot;)

&lt;Entity name: 1dca368&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="tblsearch">tblsearch</h3>

Searches a symbol table for a symbol name

(tblsearch table-name symbol <span class="Special">[setnext]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

table-name

A string that identifies the symbol table to be searched. This argument is not
case sensitive.

symbol

A string identifying the symbol name to be searched for. This argument is not
case sensitive.

setnext

If this argument is supplied and is not nil, the tblnext entry counter is
adjusted so the following tblnext call returns the entry after the one returned
by this tblsearch call. Otherwise, tblsearch has no effect on the order of
entries retrieved by tblnext.

<span class="ReturnsIdentifier">Return Values</span>

If tblsearch finds an entry for the given symbol name, it returns that entry in
the format described for tblnext . If no entry is found, tblsearch returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following command searches for a text style named &quot;standard&quot;:

Command: (tblsearch &quot;style&quot; &quot;standard&quot;)

((0 . &quot;STYLE&quot;) (2 . &quot;STANDARD&quot;) (70 . 0) (40 . 0.0) (41 . 1.0) (50 . 0.0) (71 .
0) (42 . 0.3) (3 . &quot;txt&quot;) (4 . &quot;&quot;))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="term_dialog">term_dialog</h3>

Terminates all current dialog boxes as if the user had canceled each of them

(term_dialog)

If an application is terminated while any DCL files are open, AutoCAD
automatically calls term_dialog. This function is used mainly for aborting
nested dialog boxes.

<span class="ReturnsIdentifier">Return Values</span>

The term_dialog function always returns nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="terpri">terpri</h3>

Prints a newline to the command line

(terpri)

The terpri function is not used for file I/O. To write a newline to a file, use
prin1, princ, or print.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="textbox">textbox</h3>

Measures a specified text object, and returns the diagonal coordinates of a box
that encloses the text

(textbox elist)

<span class="ArgumentsIdentifier">Arguments</span>

elist

An entity definition list defining a text object, in the format returned by
entget.

If fields that define text parameters other than the text itself are omitted
from elist, the current (or default) settings are used.

The minimum list accepted by textbox is that of the text itself.

<span class="ReturnsIdentifier">Return Values</span>

A list of two points, if successful, otherwise nil.

The points returned by textbox describe the bounding box of the text object as
if its insertion point is located at (0,0,0) and its rotation angle is 0. The
first list returned is generally the point (0.0 0.0 0.0) unless the text object
is oblique or vertical, or it contains letters with descenders (such as g and
p). The value of the first point list specifies the offset from the text
insertion point to the lower-left corner of the smallest rectangle enclosing
the text. The second point list specifies the upper-right corner of that box.
Regardless of the orientation of the text being measured, the point list
returned always describes the bottom-left and upper-right corners of this
bounding box.

<span class="ExamplesIdentifier">Examples</span>

The following command supplies the text and accepts the current defaults for
the remaining parameters:

Command: (textbox '((1 . &quot;Hello world.&quot;)))

((0.000124126 -0.00823364 0.0) (3.03623 0.310345 0.0))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="textpage">textpage</h3>

Switches focus from the drawing area to the text screen

(textpage)

The textpage function is equivalent to textscr.

<span class="ReturnsIdentifier">Return Values</span>

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="textscr">textscr</h3>

Switches focus from the drawing area to the text screen (like the AutoCAD Flip
Screen function key)

(textscr)

<span class="ReturnsIdentifier">Return Values</span>

The textscr function always returns nil.

See Also

The <a class="Identifier" href="#graphscr">graphscr</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="trace">trace</h3>

Aids in AutoLISP debugging

(trace [function...])

The trace function sets the trace flag for the specified functions. Each time a
specified function is evaluated, a trace display appears showing the entry of
the function (indented to the level of calling depth) and prints the result of
the function.

If Visual LISP is active, trace output is sent to the Visual LISP Trace window.
If Visual LISP is not active, trace output goes to the AutoCAD command window.

<span class="Todo">Note</span>:  Once you start Visual LISP during an AutoCAD session, it remains active
until you exit AutoCAD. Therefore, all trace output prints in the Visual LISP
Trace window for the remainder of that AutoCAD session. Exiting or closing
Visual LISP while AutoCAD is running only closes the IDE windows and places
Visual LISP in a quiescent state; it does not result in a true shutdown. You
must reopen Visual LISP to view the output in the Trace window.

Use untrace to turn off the trace flag.

<span class="ArgumentsIdentifier">Arguments</span>

function

A symbol that names a function. If no argument is supplied, trace has no
effect.

<span class="ReturnsIdentifier">Return Values</span>

The last function name passed to trace. If no argument is supplied, trace
returns nil.

<span class="ExamplesIdentifier">Examples</span>

Define a function named foo and set the trace flag for the function:

Command: (defun foo (x) (if (&gt; x 0) (foo (1- x))))

FOO

Command: (trace foo)

FOO

Invoke foo and observe the results:

Command: (foo 3)

Entering (FOO 3)

 Entering (FOO 2)

  Entering (FOO 1)

   Entering (FOO 0)

   Result: nil

  Result: nil

 Result: nil

Result: nil

Clear the trace flag by invoking untrace:

Command: (untrace foo)

FOO

See Also

The <a class="Identifier" href="#untrace">untrace</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="trans">trans</h3>

Translates a point (or a displacement) from one coordinate system to another

(trans pt from to <span class="Special">[disp]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

pt

A list of three reals that can be interpreted as either a 3D point or a 3D
displacement (vector).

from

An integer code, entity name, or 3D extrusion vector identifying the coordinate
system in which pt is expressed. The integer code can be one of the following:

0 World (WCS)

1 User (current UCS)

2 If used with code 0 or 1, this indicates the Display Coordinate System (DCS)
of the current viewport. When used with code 3, it indicates the DCS of the
current model space viewport.

3 Paper space DCS (used only with code 2)

to

An integer code, entity name, or 3D extrusion vector identifying the coordinate
system of the returned point. See the from argument for a list of valid integer
codes.

disp

If present and is not nil, this argument specifies that pt is to be treated as
a 3D displacement rather than as a point.

If you use an entity name for the from or to arguments, it must be passed in
the format returned by the entnext, entlast, entsel, nentsel, and ssname
functions. This format lets you translate a point to and from the Object
Coordinate System (OCS) of a particular object. (For some objects, the OCS is
equivalent to the WCS; for these objects, conversion between OCS and WCS is a
null operation.) A 3D extrusion vector (a list of three reals) is another
method of converting to and from an object's OCS. However, this does not work
for those objects whose OCS is equivalent to the WCS.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point (or displacement) in the requested to coordinate system.

<span class="ExamplesIdentifier">Examples</span>

In the following examples, the UCS is rotated 90 degrees counterclockwise
around the World Z axis:

Command: (trans '(1.0 2.0 3.0) 0 1)

(2.0 -1.0 3.0)

Command: (trans '(1.0 2.0 3.0) 1 0)

(-2.0 1.0 3.0)

The coordinate systems are discussed in greater detail in the Visual LISP
Developer's Guide, under the topic, Coordinate System Transformations.

For example, to draw a line from the insertion point of a piece of text
(without using Osnap), you convert the text object's insertion point from the
text object's OCS to the UCS.

(trans text-insert-point text-ename 1)

You can then pass the result to the From point prompt.

Conversely, you must convert point (or displacement) values to their
destination OCS before feeding them to entmod. For example, if you want to move
a circle (without using the MOVE command) by the UCS-relative offset (1,2,3),
you need to convert the displacement from the UCS to the circle's OCS:

(trans '(1 2 3) 1 circle-ename)

Then you add the resulting displacement to the circle's center point.

For example, if you have a point entered by the user and want to find out which
end of a line it looks closer to, you convert the user's point from the UCS to
the DCS.

(trans user-point 1 2)

Then you convert each of the line's endpoints from the OCS to the DCS.

(trans endpoint line-ename 2)

From there you can compute the distance between the user's point and each
endpoint of the line (ignoring the Z coordinates) to determine which end looks
closer.

The trans function can also transform 2D points. It does this by setting the Z
coordinate to an appropriate value. The Z component used depends on the from
coordinate system that was specified and on whether the value is to be
converted as a point or as a displacement. If the value is to be converted as a
displacement, the Z value is always 0.0; if the value is to be converted as a
point, the filled-in Z value is determined as shown in the following table.

+-----------------------------+------------------------------------------------+
|                         Converted 2D point Z values                          |
+-----------------------------+------------------------------------------------+
|            From             |               Filled-in Z value                |
+-----------------------------+------------------------------------------------+
| WCS                         | 0.0                                            |
+-----------------------------+------------------------------------------------+
| UCS                         | Current elevation                              |
+-----------------------------+------------------------------------------------+
| OCS                         | 0.0                                            |
+-----------------------------+------------------------------------------------+
| DCS                         | Projected to the current construction          |
|                             | plane(UCS XY plane + current elevation)        |
+-----------------------------+------------------------------------------------+
| PSDCS                       | Projected to the current construction          |
|                             | plane(UCS XY plane + current elevation)        |
+-----------------------------+------------------------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="type">type</h3>

Returns the type of a specified item

(type item)

<span class="ArgumentsIdentifier">Arguments</span>

item

A symbol.

<span class="ReturnsIdentifier">Return Values</span>

The data type of item. Items that evaluate to nil (such as unassigned symbols)
return nil. The data type is returned as one of the atoms listed in the
following table:

+-------------------------------------+----------------------------------------+
|                   Data types returned by the type function                   |
+-------------------------------------+----------------------------------------+
|              Data type              |              Description               |
+-------------------------------------+----------------------------------------+
| ENAME                               | Entity names                           |
+-------------------------------------+----------------------------------------+
| EXRXSUBR                            | External ObjectARX applications        |
+-------------------------------------+----------------------------------------+
| FILE                                | File descriptors                       |
+-------------------------------------+----------------------------------------+
| INT                                 | Integers                               |
+-------------------------------------+----------------------------------------+
| LIST                                | Lists                                  |
+-------------------------------------+----------------------------------------+
| PAGETB                              | Function paging table                  |
+-------------------------------------+----------------------------------------+
| PICKSET                             | Selection sets                         |
+-------------------------------------+----------------------------------------+
| REAL                                | Floating-point numbers                 |
+-------------------------------------+----------------------------------------+
| SAFEARRAY                           | Safearray                              |
+-------------------------------------+----------------------------------------+
| STR                                 | Strings                                |
+-------------------------------------+----------------------------------------+
| SUBR                                | Internal AutoLISP functions or         |
|                                     | functions loaded from compiled (FAS    |
|                                     | or VLX) files. Functions in LISP       |
|                                     | source files loaded from the AutoCAD   |
|                                     | Command prompt may also appear as      |
|                                     | SUBR.                                  |
+-------------------------------------+----------------------------------------+
| SYM                                 | Symbols                                |
+-------------------------------------+----------------------------------------+
| VARIANT                             | Variant                                |
+-------------------------------------+----------------------------------------+
| USUBR                               | User-defined functions loaded from     |
|                                     | LISP source files                      |
+-------------------------------------+----------------------------------------+
| VLA-object                          | ActiveX objects                        |
+-------------------------------------+----------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

For example, given the following assignments:

(setq a 123 r 3.45 s &quot;Hello!&quot; x '(a b c))

(setq f (open &quot;name&quot; &quot;r&quot;))

then

(type 'a) returns SYM

(type a) returns INT

(type f) returns FILE

(type r) returns REAL

(type s) returns STR

(type x) returns LIST

(type +) returns SUBR

(type nil) returns nil

The following code example uses the type function on the argument passed to it:

(defun isint (a)

 (if (= (type a) 'INT) is TYPE integer?

 T yes, return T

 nil no, return nil

 )

)

<span class="PreProc">================================ U Functions ===================================</span>

<h3 class="String" id="unload_dialog">unload_dialog</h3>

Unloads a DCL file

(unload_dialog dcl_id)

Unloads the DCL file associated with dcl_id (obtained from a previous
new_dialog call) from memory.

It is generally not necessary to unload a DCL definition from memory, unless
you are running low on memory or need to update the DCL dialog definition from
a new file.

<span class="ArgumentsIdentifier">Arguments</span>

dcl_id

A DCL file identifier obtained from a previous load_dialog call.

<span class="ReturnsIdentifier">Return Values</span>

The unload_dialog function always returns nil.

See Also

The <a class="Identifier" href="#load_dialog">load_dilog</a> and <a class="Identifier" href="#new_dialog">new_dialog</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="untrace">untrace</h3>

Clears the trace flag for the specified functions

(untrace [function...])

<span class="ArgumentsIdentifier">Arguments</span>

function

A symbol that names a function. If function is not specified, untrace has no
effect.

<span class="ReturnsIdentifier">Return Values</span>

The last function name passed to untrace. If function was not specified,
untrace returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following command clears the trace flag for function foo:

Command: (untrace foo)

FOO

See Also

The <a class="Identifier" href="#trace">trace</a> function.

<span class="PreProc">================================ V Functions ===================================</span>

<h3 class="String" id="vector_image">vector_image</h3>

Draws a vector in the currently active dialog box image

(vector_image x1 y1 x2 y2 color)

This function draws a vector in the currently active dialog box image (opened
by start_image) from the point (x1,y1) to (x2,y2). The origin (0,0) is the
upper-left corner of the image. You can obtain the coordinates of the
lower-right corner by calling the dimension functions (dimx_tile and
dimy_tile).

<span class="ArgumentsIdentifier">Arguments</span>

x1

X coordinate of the first point.

y1

Y coordinate of the first point.

x2

X coordinate of the second point.

y2

Y coordinate of the second point.

color

An AutoCAD color number, or one of the logical color numbers shown in the
following table:

+------------------------------+--------------+--------------------------------+
|                      Symbolic names for color attribute                      |
+------------------------------+--------------+--------------------------------+
|         Color number         | ADI mnemonic |          Description           |
+------------------------------+--------------+--------------------------------+
| -2                           | BGLCOLOR     | Current background of the      |
|                              |              | AutoCAD drawing area           |
+------------------------------+--------------+--------------------------------+
| -15                          | DBGLCOLOR    | Current dialog box background  |
|                              |              | color                          |
+------------------------------+--------------+--------------------------------+
| -16                          | DFGLCOLOR    | Current dialog box foreground  |
|                              |              | color (text)                   |
+------------------------------+--------------+--------------------------------+
| -18                          | LINELCOLOR   | Current dialog box line color  |
+------------------------------+--------------+--------------------------------+
<span class="ReturnsIdentifier">Return Values</span>

An integer representing the color of the vector.

<span class="ExamplesIdentifier">Examples</span>

(setq color -2) ;; color of AutoCAD drawing area

(vector_image

 0

 0

 (dimx_tile &quot;slide_tile&quot;)

 (dimy_tile &quot;slide_tile&quot;)

 color

)

(end_image)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="ver">ver</h3>

Returns a string that contains the current AutoLISP version number

(ver)

The ver function can be used to check the compatibility of programs.

<span class="ReturnsIdentifier">Return Values</span>

The string returned takes the following form:

&quot;Visual LISP version (nn)&quot;

where version is the current version number and nn is a two-letter language
description.

<span class="ExamplesIdentifier">Examples</span> of the two-letter language descriptions are as follows:

(de) German
(en) US/UK
(es) Spanish
(fr) French
(it) Italian

<span class="ExamplesIdentifier">Examples</span>

Command: (ver)

&quot;Visual LISP 2002 (en)&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-acad-defun">vl-acad-defun</h3>

Defines an AutoLISP function symbol as an external subroutine

(vl-acad-defun 'symbol)

symbol

A symbol identifying a function.

If a function does not have the c: prefix, and you want to be able to invoke
this function from an external ObjectARX application, you can use vl-acad-defun
to make the function accessible.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-acad-undefun">vl-acad-undefun</h3>

Undefines an AutoLISP function symbol so it is no longer available to ObjectARX
applications

(vl-acad-undefun 'symbol)

symbol

A symbol identifying a function.

You can use vl-acad-undefun to undefine a c: function or a function that was
exposed via vl-acad-defun.

<span class="ReturnsIdentifier">Return Values</span>

T if successful, nil if unsuccessful (for example, the function was not defined
in AutoLISP).

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-arx-import">vl-arx-import</h3>

Imports ObjectARX/ADSRX functions into a separate-namespace VLX

(vl-arx-import ['function | &quot;application&quot;])

By default, separate-namespace VLX applications do not import any functions
from ObjectARX/ADSRX applications. Use vl-arx-import to explicitly import
functions from ObjectARX/ADSRX applications.

<span class="ArgumentsIdentifier">Arguments</span>

function

A symbol naming the function to import.

application

A string naming the application whose functions are to be imported.

If no argument (or nil) is specified, vl-arx-import imports all function names
from the current document namespace.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

If executed from a document VLX, this function does nothing and returns nil, as
all ADS-DEFUN function names are automatically imported to document VLX
applications.

<span class="ExamplesIdentifier">Examples</span>

To see how vl-arx-import works, try the following:

<span class="Statement">  </span>* Copy the following code into the VLISP editor and save the file:

(vl-doc-export 'testarx)

(defun testarx ()

 (princ &quot;This function tests invoking an ARX app &quot;)

 (vl-arx-import 'c:cal)

 (c:cal)

)
<span class="Statement">  </span>* Use Make Application to build a VLX with this code. Select Separate-
    Namespace Application Options.
<span class="Statement">  </span>* Load geomcal.arx, if it is not already loaded.

<span class="Statement">  </span>* Load and run the application.

To verify the effect of vl-arx-import, comment out the vl-arx-import call in
the code, save the change, then rebuild and run the application. Without the
vl-arx-import call, the c:cal function will not be found.

In the example above, you could have replaced the vl-arx-import call with the
following:

(vl-arx-import &quot;geomcal.arx&quot;)

This would import all functions defined in geomcal.arx, including c:cal.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-bb-ref">vl-bb-ref</h3>

Returns the value of a variable from the blackboard namespace

(vl-bb-ref 'variable)

<span class="ArgumentsIdentifier">Arguments</span>

'variable

A symbol identifying the variable to be retrieved.

<span class="ReturnsIdentifier">Return Values</span>

The value of the variable named by symbol.

<span class="ExamplesIdentifier">Examples</span>

Set a variable in the blackboard:

Command: (vl-bb-set 'foobar &quot;Root toot toot&quot;)

&quot;Root toot toot&quot;

Use vl-bb-ref to retrieve the value of foobar from the blackboard:

Command: (vl-bb-ref 'foobar)

&quot;Root toot toot&quot;

See Also

The <a class="Identifier" href="#vl-bb-set">vl-bb-set</a> function. Also, see Sharing Data between Namespaces in the
Visual LISP Developer's Guide for a description of the blackboard namespace.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-bb-set">vl-bb-set</h3>

Sets a variable in the blackboard namespace

(vl-bb-set 'symbol value)

<span class="ArgumentsIdentifier">Arguments</span>

'symbol

A symbol naming the variable to be set.

value

Any value, except a function.

<span class="ReturnsIdentifier">Return Values</span>

The value you assigned to symbol.

<span class="ExamplesIdentifier">Examples</span>

Command: (vl-bb-set 'foobar &quot;Root toot toot&quot;)

&quot;Root toot toot&quot;

Command: (vl-bb-ref 'foobar)

&quot;Root toot toot&quot;

See Also

The <a class="Identifier" href="#vl-bb-ref">vl-bb-ref</a> function. Also, see Sharing Data between Namespaces in the
Visual LISP Developer's Guide for a description of the blackboard namespace.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-catch-all-apply">vl-catch-all-apply</h3>

Passes a list of arguments to a specified function and traps any exceptions

(vl-catch-all-apply 'function list)

<span class="ArgumentsIdentifier">Arguments</span>

'function

A function. The function argument can be either a symbol identifying a defun,
or a lambda expression.

list

A list containing arguments to be passed to the function.

<span class="ReturnsIdentifier">Return Values</span>

The result of the function call, if successful. If an error occurs,
vl-catch-all-apply returns an error object.

<span class="ExamplesIdentifier">Examples</span>

If the function invoked by vl-catch-all-apply completes successfully, it is the
same as using apply, as the following examples show:

_$ (setq catchit (apply '/ '(50 5)))

10

_$ (setq catchit (vl-catch-all-apply '/ '(50 5)))

10

The benefit of using vl-catch-all-apply is that it allows you to intercept
errors and continue processing. Look at what happens when you try to divide by
zero using apply:

_$ (setq catchit (apply '/ '(50 0)))

; error: divide by zero

When you use apply, an exception occurs and an error message displays.

Here is the same operation using vl-catch-all-apply

_$ (setq catchit (vl-catch-all-apply '/ '(50 0)))

#&lt;%catch-all-apply-error%&gt;

The vl-catch-all-apply function traps the error and returns an error object.
Use vl-catch-all-error-message to see the error message contained in the error
object:

_$ (vl-catch-all-error-message catchit)

&quot;divide by zero&quot;

See Also

The <a class="Identifier" href="#vl-catch-all-error-message">vl-catch-all-error-message</a> and <a class="Identifier" href="#vl-catch-all-error-p">vl-catch-all-error-p</a> functions in this
reference and Error Handling in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-catch-all-error-message">vl-catch-all-error-message</h3>

Returns a string from an error object

(vl-catch-all-error-message error-obj)

<span class="ArgumentsIdentifier">Arguments</span>

error-obj

An error object returned by vl-catch-all-apply.

<span class="ReturnsIdentifier">Return Values</span>

A string containing an error message.

<span class="ExamplesIdentifier">Examples</span>

Divide by zero using vl-catch-all-apply:

_$ (setq catchit (vl-catch-all-apply '/ '(50 0)))

#&lt;%catch-all-apply-error%&gt;

The vl-catch-all-apply function traps the error and returns an error object.
Use vl-catch-all-error-message to see the error message contained in the error
object:

_$ (vl-catch-all-error-message catchit)

&quot;divide by zero&quot;

See Also

The <a class="Identifier" href="#vl-catch-all-apply">vl-catch-all-apply</a> and <a class="Identifier" href="#vl-catch-all-error-p">vl-catch-all-error-p</a> functions in this reference
and Error Handling in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-catch-all-error-p">vl-catch-all-error-p</h3>

Determines whether an argument is an error object returned from
vl-catch-all-apply

(vl-catch-all-error-p arg)

<span class="ArgumentsIdentifier">Arguments</span>

arg

Any argument.

<span class="ReturnsIdentifier">Return Values</span>

T, if the supplied argument is an error object returned from
vl-catch-all-apply, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Divide by zero using vl-catch-all-apply:

_$ (setq catchit (vl-catch-all-apply '/ '(50 0)))

#&lt;%catch-all-apply-error%&gt;

Use vl-catch-all-error-p to determine if the value returned by
vl-catch-all-apply is an error object:

_$ (vl-catch-all-error-p catchit)

T

See Also

The <a class="Identifier" href="#vl-catch-all-apply">vl-catch-all-apply</a> and <a class="Identifier" href="#vl-catch-all-error-message">vl-catch-all-error-message</a> functions, and Error
Handling in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-cmdf">vl-cmdf</h3>

Executes an AutoCAD command

<span class="ArgumentsIdentifier">Arguments</span>

(vl-cmdf  <span class="Special">[arguments]</span> ...)

The vl-cmdf function is similar to the command function, but differs from
command in the way it evaluates the arguments passed to it. The vl-cmdf
function evaluates all the supplied arguments before executing the AutoCAD
command, and will not execute the AutoCAD command if it detects an error during
argument evaluation. In contrast, the command function passes each argument in
turn to AutoCAD, so the command may be partially executed before an error is
detected.

If your command call includes a call to another function, vl-cmdf executes the
call before it executes your command, while command executes the call after it
begins executing your command.

Some AutoCAD commands may work correctly when invoked through vl-cmdf, while
failing when invoked through command. The vl-cmdf function mainly overcomes the
limitation of not being able to use getxxx functions inside command.

<span class="ArgumentsIdentifier">Arguments</span>

arguments

AutoCAD commands and their options.

The arguments to the vl-cmdf function can be strings, reals, integers, or
points, as expected by the prompt sequence of the executed command. A null
string (&quot;&quot;) is equivalent to pressing ENTER on the keyboard. Invoking vl-cmdf
with no argument is equivalent to pressing ESC and cancels most AutoCAD
commands.

<span class="ReturnsIdentifier">Return Values</span>

T

<span class="Todo">Note</span> that if you issue vl-cmdf from Visual LISP, focus does not change to the
AutoCAD window. If the command requires user input, you'll see the return value
(T) in the Console window, but AutoCAD will be waiting for input. You must
manually activate the AutoCAD window and respond to the prompts. Until you do
so, any subsequent commands will fail.

<span class="ExamplesIdentifier">Examples</span>

The differences between command and vl-cmdf are easier to see if you enter the
following calls at the AutoCAD Command prompt, rather than the VLISP Console
prompt:

Command: (command &quot;line&quot; (getpoint &quot;point?&quot;) '(0 0) &quot;&quot;)

line Specify first point: point?

Specify next point or <span class="Special">[Undo]</span>:

Command: nil

Using command, the LINE command executes first, then the getpoint function is
called.

Command: (VL-CMDF &quot;line&quot; (getpoint &quot;point?&quot;) '(0 0) &quot;&quot;)

point?line Specify first point:

Specify next point or <span class="Special">[Undo]</span>:

Command: T

Using vl-cmdf, the getpoint function is called first (notice the &quot;point?&quot;
prompt from getpoint), then the LINE command executes.

The following examples show the same commands, but pass an invalid point list
argument to the LINE command. Notice how the results differ:

Command: (command &quot;line&quot; (getpoint &quot;point?&quot;) '(0) &quot;&quot;)

line Specify first point: point?

Specify next point or <span class="Special">[Undo]</span>:

Command: ERASE nil

objects: Specify opposite corner: <h3 class="String" id="Cancel">Cancel</h3>

0 found

The command function passes each argument in turn to AutoCAD, without
evaluating the argument, so the invalid point list is undetected.

Command: (VL-CMDF &quot;line&quot; (getpoint &quot;point?&quot;) '(0) &quot;&quot;)

point?Application ERROR: Invalid entity/point list.

nil

Because vl-cmdf evaluates each argument before passing the command to AutoCAD,
the invalid point list is detected and the command is not executed.

See Also

The <a class="Identifier" href="#command">command</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-consp">vl-consp</h3>

Determines whether or not a list is nil

(vl-consp list-variable)

The vl-consp function determines whether a variable contains a valid list
definition.

<span class="ArgumentsIdentifier">Arguments</span>

list-variable

A list.

<span class="ReturnsIdentifier">Return Values</span>

T, if list-variable is a list and is not nil, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-consp nil)

nil

_$ (vl-consp t)

nil

_$ (vl-consp (cons 0 &quot;LINE&quot;))

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-copyobjects">vl-copyobjects</h3>


Duplicates multiple objects (deep cloning).


Signature

RetVal = object.CopyObjects(Objects[, Owner][, IDPairs])

Object

Database, Document
The object or objects this method applies to.

Objects

Variant (array of objects); input-only
The array of primary objects to be copied. All the objects must have the same owner,
and the owner must belong to the database or document that is calling this method.

Owner

Variant (a single object); input-only; optional
The new owner for the copied objects. If no owner is specified, the objects will be
created with the same owner as the objects in the Objects array.

IDPairs

Variant (array of IDPair objects); input-output; optional
Information on what happened during the copy and translation process.
Input: an empty variant.
Output: an array of IDPair objects.

RetVal

Variant (array of objects)
An array of newly created duplicate objects. Only primary objects are returned in
this array. For more information on what occured during the CopyObjects operation, or
a list of objects owned by primary objects that were also copied, consult the IDPairs
array.

Remarks

To copy objects to another open drawing, set the Owner parameter to the other
drawing's model space.

During the CopyObjects operation, objects that are owned or referenced by the primary
objects in the Objects parameter will also be copied.

<span class="Todo">NOTE</span> You cannot execute this method while simultaneously iterating through a
collection. An iteration will open the work space for a read-only operation, while
this method attempts to perform a read-write operation. Complete any iteration before
you call this method.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-directory-files">vl-directory-files</h3>

Lists all files in a given directory

(vl-directory-files  [directory pattern directories])

<span class="ArgumentsIdentifier">Arguments</span>

directory

A string naming the directory to collect files for; if nil or absent,
vl-directory-files uses the current directory.

pattern

A string containing a DOS pattern for the file name; if nil or absent,
vl-directory-files assumes &quot;*.*&quot;

directories

An integer that indicates whether the returned list should include directory
names. Specify one of the following:

-1 List directories only.

0 List files and directories (the default).

1 List files only.

<span class="ReturnsIdentifier">Return Values</span>

A list of file and path names, or nil if no files match the specified pattern.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-directory-files &quot;c:/acadwin&quot; &quot;acad*.exe&quot;)

(&quot;ACAD.EXE&quot; &quot;ACADAPP.EXE&quot; &quot;ACADL.EXE&quot; &quot;ACADPS.EXE&quot;)

_$ (vl-directory-files &quot;e:/acadwin&quot; nil -1)

(&quot;.&quot; &quot;..&quot; &quot;SUPPORT&quot; &quot;SAMPLE&quot; &quot;ADS&quot; &quot;FONTS&quot; &quot;IGESFONT&quot; &quot;SOURCE&quot;
&quot;ASE&quot;)

_$ (vl-directory-files &quot;E:/acad13c4&quot; nil -1)

(&quot;.&quot; &quot;..&quot; &quot;WIN&quot; &quot;COM&quot; &quot;DOS&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-doc-export">vl-doc-export</h3>

Makes a function available to the current document

(vl-doc-export 'function)

When issued from a VLX that runs in its own namespace, vl-doc-export exposes
the specified function to any document namespace that loads the VLX.

The vl-doc-export function should only be used at the top-level in a file,
never inside other forms (for example, not within a defun).

<span class="ArgumentsIdentifier">Arguments</span>

'function

A symbol naming the function to be exported.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="ExamplesIdentifier">Examples</span>

The following code shows the contents of a file named kertrats.lsp. This file
is compiled into a VLX that runs in its own namespace. The VLX file is named
kertrats.vlx. The vl-doc-export call makes the kertrats function visible to any
document that loads kertrats.vlx:

(vl-doc-export 'kertrats)

(defun kertrats ()

 (princ &quot;This function goes nowhere&quot;)

)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-doc-import">vl-doc-import</h3>

Imports a previously exported function into a VLX namespace

(vl-doc-import application ['function...])

This function can be used in a separate-namespace VLX to import a function that
was previously exported from another VLX loaded from the same document.

The vl-doc-import function should only be used at the top-level in a file,
never inside other forms (for example, not within a defun).

<span class="ArgumentsIdentifier">Arguments</span>

application

A string naming the VLX application whose functions are to be imported. Do not
include the .vlx extension in the name.

function

One or more symbols naming functions to be imported. If no functions are
specified, all functions exported by application will be imported.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="ExamplesIdentifier">Examples</span>

Import function ldataget from the ldatatest application:

(vl-doc-import &quot;ldatatest&quot; 'ldataget)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-doc-ref">vl-doc-ref</h3>

Retrieves the value of a variable from the current document's namespace

This function can be used by a separate-namespace VLX application to retrieve
the value of a variable from the current document's namespace.

(vl-doc-ref 'symbol)

<span class="ArgumentsIdentifier">Arguments</span>

'symbol

A symbol naming a variable.

<span class="ReturnsIdentifier">Return Values</span>

The value of the variable identified by symbol.

<span class="ExamplesIdentifier">Examples</span>

Command: (vl-doc-ref 'foobar)

&quot;Rinky dinky stinky&quot;

See Also

The <a class="Identifier" href="#vl-doc-set">vl-doc-set</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-doc-set">vl-doc-set</h3>

Sets the value of a variable in the current document's namespace

(vl-doc-set 'symbol value)

This function can be used by a VLX application to set the value of a variable
that resides in the current document's namespace.

If executed within a document namespace, vl-doc-set is equivalent to set.

<span class="ArgumentsIdentifier">Arguments</span>

'symbol

A symbol naming a variable.

value

Any value.

<span class="ReturnsIdentifier">Return Values</span>

The value set.

<span class="ExamplesIdentifier">Examples</span>

Command: (vl-doc-set 'foobar &quot;Rinky dinky stinky&quot;)

&quot;Rinky dinky stinky&quot;

See Also

The <a class="Identifier" href="#vl-doc-ref">vl-doc-ref</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-every">vl-every</h3>

Checks whether the predicate is true for every element combination

(vl-every  predicate-function list <span class="Special">[list]</span>...)

The vl-every function passes the first element of each supplied list as an
argument to the test function, followed by the next element from each list, and
so on. Evaluation stops as soon as one of the lists runs out.

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts as many arguments as
there are lists provided with vl-every, and returns T on any user-specified
condition. The predicate-function value can take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T, if predicate-function returns a non-nil value for every element combination,
nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Check whether there are any empty files in the current directory:

_$ (vl-every

'(lambda (fnm) (&gt; (vl-file-size fnm) 0))

 (vl-directory-files nil nil 1) )

T

Check whether the list of numbers in NLST is ordered by '&lt;=:

_$ (setq nlst (list 0 2 pi pi 4))

(0 2 3.14159 3.14159 4)

_$ (vl-every '&lt;= nlst (cdr nlst))

T

Compare the results of the following expressions:

_$ (vl-every '= '(1 2) '(1 3))

nil

_$ (vl-every '= '(1 2) '(1 2 3))

T

The first expression returned nil because vl-every compared the second element
in each list and they were not numerically equal. The second expression
returned T because vl-every stopped comparing elements after it had processed
all the elements in the shorter list (1 2), at which point the lists were
numerically equal. If the end of a list is reached, vl-every returns a non-nil
value.

The following example demonstrates the result when vl-every evaluates one list
that contains integer elements and another list that is nil:

_$ (setq alist (list 1 2 3 4))

(1 2 3 4)

_$ (setq junk nil)

nil

_$ (vl-every '= junk alist)

T

The return value is T because vl-every responds to the nil list as if it has
reached the end of the list (even though the predicate hasn't yet been applied
to any elements). And since the end of a list has been reached, vl-every
returns a non-nil value.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-exit-with-error">vl-exit-with-error</h3>
<span class="Todo">NOTE</span>: +error+ = (*error*)
control from a VLX error handler to the +error+ function of the calling
namespace

(vl-exit-with-error msg)

This function is used by VLX applications that run in their own namespace. When
vl-exit-with-error executes, it calls the +error+ function, the stack is
unwound, and control returns to a command prompt.

<span class="ArgumentsIdentifier">Arguments</span>

msg

A string.

<span class="ReturnsIdentifier">Return Values</span>

None.

<span class="ExamplesIdentifier">Examples</span>

The following code illustrates the use of vl-exit-with-error to pass a string
the +error+ function of the calling namespace:

(defun +error+ (msg)

 ... ; processing in VLX namespace/execution context

(vl-exit-with-error (strcat &quot;My application bombed! &quot; msg)))

See Also

The <a class="Identifier" href="#vl-exit-with-value">vl-exit-with-value</a> function and Handling Errors in an MDI Environment in
the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-exit-with-value">vl-exit-with-value</h3>

<span class="Todo">NOTE</span>: +error+ = (*error*)
Returns a value to the function that invoked the VLX from another namespace

(vl-exit-with-value value)

VLX +error+ handler can use the vl-exit-with-value function to return a value
to the program that called the VLX.

<span class="ArgumentsIdentifier">Arguments</span>

value

Any value.

<span class="ReturnsIdentifier">Return Values</span>

value

<span class="ExamplesIdentifier">Examples</span>

The following example uses vl-exit-with-value to return the integer value 3 to
the function that invoked the VLX:

(defun +error+ (msg)

 ... ; processing in VLX-T namespace/execution context

 (vl-exit-with-value 3))

See Also

The <a class="Identifier" href="#vl-exit-with-error">vl-exit-with-error</a> function and the Handling Errors in an MDI Environment
topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-file-copy">vl-file-copy</h3>

Copies or appends the contents of one file to another file

(vl-file-copy source-file  destination-file <span class="Special">[append]</span>)

Copy or append the contents of one file to another file. The vl-file-copy
function will not overwrite an existing file, only append to it.

<span class="ArgumentsIdentifier">Arguments</span>

source-file

A string naming the file to be copied. If you do not specify a full path name,
vl-file-copy looks in the AutoCAD start-up directory.

destination-file

A string naming the destination file. If you do not specify a path name,
vl-file-copy writes to the AutoCAD start-up directory.

append

If specified and not nil, source-file is appended to destination-file (that is,
copied to the end of the destination file).

<span class="ReturnsIdentifier">Return Values</span>

An integer, if the copy was successful, otherwise nil.

Some typical reasons for returning nil are:

<span class="Statement">  </span>* source-file is not readable

<span class="Statement">  </span>* source-file is a directory
<span class="Statement">  </span>* append? is absent or nil and destination-file exists
<span class="Statement">  </span>* destination-file cannot be opened for output (that is, it is an illegal
    file name or a write-protected file)

<span class="Statement">  </span>* source-file is the same as destination-file

<span class="ExamplesIdentifier">Examples</span>

Copy autoexec.bat to newauto.bat:

_$ (vl-file-copy &quot;c:/autoexec.bat&quot; &quot;c:/newauto.bat&quot;)

1417

Copy test.bat to newauto.bat:

_$ (vl-file-copy &quot;c:/test.bat&quot; &quot;c:/newauto.bat&quot;)

nil

The copy fails because newauto.bat already exists, and the append argument was
not specified.

Repeat the previous command, but specify append:

_$ (vl-file-copy &quot;c:/test.bat&quot; &quot;c:/newauto.bat&quot; T)

185

The copy is successful because T was specified for the append argument.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-file-delete">vl-file-delete</h3>

Deletes a file

(vl-file-delete  filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing the name of the file to be deleted. If you do not specify a
full path name, vl-file-delete searches the AutoCAD start-up directory.

<span class="ReturnsIdentifier">Return Values</span>

T if successful, nil if delete failed.

<span class="ExamplesIdentifier">Examples</span>

Delete newauto.bat:

_$ (vl-file-delete &quot;newauto.bat&quot;)

nil

Nothing was deleted because there is no newauto.bat file in the AutoCAD
start-up directory.

Delete the newauto.bat file in the c:\ directory:

_$ (vl-file-delete &quot;c:/newauto.bat&quot;)

T

The delete was successful because the full path name identified an existing
file.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-file-directory-p">vl-file-directory-p</h3>

Determines if a file name refers to a directory

(vl-file-directory-p filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing a file name. If you do not specify a full path name,
vl-file-directory-p searches only the AutoCAD start-up directory.

<span class="ReturnsIdentifier">Return Values</span>

T, if filename is the name of a directory, nil if it is not.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-file-directory-p &quot;sample&quot;)

T

_$ (vl-file-directory-p &quot;yinyang&quot;)

nil

_$ (vl-file-directory-p &quot;c:/program files/AutoCAD&quot;)

T

_$ (vl-file-directory-p &quot;c:/program files/AutoCAD/visuallisp/
yinyang.lsp&quot;)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-file-rename">vl-file-rename</h3>

Renames a file

(vl-file-rename  old-filename new-filename)

<span class="ArgumentsIdentifier">Arguments</span>

old-filename

A string containing the name of the file you want to rename. If you do not
specify a full path name, vl-file-rename looks in the AutoCAD start-up
directory.

new-filename

A string containing the new name to be assigned to the file.

<span class="Todo">Note</span>:  If you do not specify a path name, vl-file-rename writes the renamed
file to the AutoCAD start-up directory.

<span class="ReturnsIdentifier">Return Values</span>

T, if renaming completed successfully, nil if renaming failed.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-file-rename &quot;c:/newauto.bat&quot; &quot;c:/myauto.bat&quot;)

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-file-size">vl-file-size</h3>

Determines the size of a file, in bytes

(vl-file-size filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string naming the file to be sized. If you do not specify a full path name,
vl-file-size searches the AutoCAD start-up directory for the file.

<span class="ReturnsIdentifier">Return Values</span>

If successful, vl-file-size returns an integer showing the size of filename. If
the file is not readable, vl-file-size returns nil. If filename is a directory
or an empty file, vl-file-size returns 0.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-file-size &quot;c:/autoexec.bat&quot;)

1417

_$ (vl-file-size &quot;c:/&quot;)

0

In the preceding example, vl-file-size returned 0 because c:/ names a
directory.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-file-systime">vl-file-systime</h3>

Returns last modification time of the specified file

(vl-file-systime filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing the name of the file to be checked.

<span class="ReturnsIdentifier">Return Values</span>

A list containing the modification date and time, or nil, if the file is not
found.

The list returned contains the following elements:

<span class="Statement">  </span>* year

<span class="Statement">  </span>* month
<span class="Statement">  </span>* day-of-week
<span class="Statement">  </span>* day-of-month
<span class="Statement">  </span>* hours
<span class="Statement">  </span>* minutes

<span class="Statement">  </span>* seconds

<span class="Todo">Note</span> that Monday is day 1 of day-of-week, Tuesday is day 2, etc.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-file-systime
   &quot;c:/program files/AutoCAD/sample/visuallisp/yinyang.lsp&quot;)

(1998 4 3 8 10 6 52)

The returned value shows that the file was last modified in 1998, in the 4th
month of the year (April), the 3rd day of the week (Wednesday), on the 8th day
of the month, at 10:6:52.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-filename-base">vl-filename-base</h3>

Returns the name of a file, after stripping out the directory path and extension

(vl-filename-base  filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing a file name. The vl-filename-base function does not check
to see if the file exists.

<span class="ReturnsIdentifier">Return Values</span>

A string containing filename in uppercase, with any directory and extension
stripped from the name.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-filename-base &quot;c:\\acadwin\\acad.exe&quot;)

&quot;ACAD&quot;

_$ (vl-filename-base &quot;c:\\acadwin&quot;)

&quot;ACADWIN&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-filename-directory">vl-filename-directory</h3>

Returns the directory path of a file, after stripping out the name and extension

(vl-filename-directory  filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing a complete file name, including the path. The
vl-filename-directory function does not check to see if the specified file
exists. Slashes (/) and backslashes (\) are accepted as directory delimiters.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the directory portion of filename, in uppercase.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-filename-directory &quot;c:\\acadwin\\acad.exe&quot;)

&quot;C:\\ACADWIN&quot;

_$ (vl-filename-directory &quot;acad.exe&quot;)

&quot;&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-filename-extension">vl-filename-extension</h3>

Returns the extension from a file name, after stripping out the rest of the name

(vl-filename-extension  filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string containing a file name, including the extension. The
vl-filename-extension function does not check to see if the specified file
exists.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the extension of filename. The returned string starts with
a period (.) and is in uppercase. If filename does not contain an extension,
vl-filename-extension returns nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-filename-extension &quot;c:\\acadwin\\acad.exe&quot;)

&quot;.EXE&quot;

_$ (vl-filename-extension &quot;c:\\acadwin\\acad&quot;)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-filename-mktemp">vl-filename-mktemp</h3>

Calculates a unique file name to be used for a temporary file

(vl-filename-mktemp [pattern directory extension])

<span class="ArgumentsIdentifier">Arguments</span>

pattern

A string containing a file name pattern; if nil or absent, vl-filename-mktemp
uses &quot;$VL~~&quot;.

directory

A string naming the directory for temporary files; if nil or absent,
vl-filename-mktemp chooses a directory in the following order:

<span class="Statement">  </span>* The directory specified in pattern, if any.
<span class="Statement">  </span>* The directory specified in the TMP environment variable.
<span class="Statement">  </span>* The directory specified in the TEMP environment variable.
<span class="Statement">  </span>* The current directory.

extension

A string naming the extension to be assigned to the file; if nil or absent,
vl-filename-mktemp uses the extension part of pattern (which may be an empty
string).

<span class="ReturnsIdentifier">Return Values</span>

A string containing a file name, in the following format:

directory\base<span class="Special">&lt;XXX&gt;</span>&lt;.extension&gt;

where:

base is up to 5 characters, taken from pattern

XXX is a 3 character unique combination

All file names generated by vl-filename-mktemp during a VLISP session are
deleted when you exit VLISP.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-filename-mktemp)

&quot;C:\\TMP\\$VL~~004&quot;

_$ (vl-filename-mktemp &quot;myapp.del&quot;)

&quot;C:\\TMP\\MYAPP005.DEL&quot;

_$ (vl-filename-mktemp &quot;c:\\acadwin\\myapp.del&quot;)

&quot;C:\\ACADWIN\\MYAPP006.DEL&quot;

_$ (vl-filename-mktemp &quot;c:\\acadwin\\myapp.del&quot;)

&quot;C:\\ACADWIN\\MYAPP007.DEL&quot;

_$ (vl-filename-mktemp &quot;myapp&quot; &quot;c:\\acadwin&quot;)

&quot;C:\\ACADWIN\\MYAPP008&quot;

_$ (vl-filename-mktemp &quot;myapp&quot; &quot;c:\\acadwin&quot; &quot;.del&quot;)

&quot;C:\\ACADWIN\\MYAPP00A.DEL&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-get-resource">vl-get-resource</h3>

Returns the text stored in a .txt file packaged in a VLX

(vl-get-resource text-file)

<span class="ArgumentsIdentifier">Arguments</span>

text-file

A string naming a .txt file packaged with the VLX. Do not include the .txt
extension when specifying the file name.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the text in text-file.

<span class="ExamplesIdentifier">Examples</span>

Assume the getres.vlx file contains a LISP program defining a function named
print-readme, and a text file named readme.txt. The print-readme function is
defined as follows:

(defun print-readme ()

 (princ (vl-get-resource &quot;readme&quot;))

 (princ)

 )

After loading getres.vlx, invoke print-readme:

_$ (print-readme)

There is very important information here!

Be sure to thoroughly read the following!

Are you ready?

Here it comes...

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-list_star">vl-list_star</h3>

Constructs and returns a list

(vl-list*  object <span class="Special">[object]</span>...)

<span class="ArgumentsIdentifier">Arguments</span>

object

Any LISP object.

<span class="ReturnsIdentifier">Return Values</span>

The vl-list* function is similar to list, but it will place the last object in
the final cdr of the result list. If the last argument to vl-list* is an atom,
the result is a dotted list. If the last argument is a list, its elements are
appended to all previous arguments added to the constructed list. The possible
return values from vl-list* are:

<span class="Statement">  </span>* An atom, if a single atom object is specified.

<span class="Statement">  </span>* A dotted pair, if all object arguments are atoms.
<span class="Statement">  </span>* A dotted list if the last argument is an atom and neither of the previous
    conditions is true.

<span class="Statement">  </span>* A list, if none of the previous statements is true.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-list* 1)

1

_$ (vl-list* 0 &quot;text&quot;)

(0 . &quot;TEXT&quot;)

_$ (vl-list* 1 2 3)

(1 2 . 3)

_$ (vl-list* 1 2 '(3 4))

(1 2 3 4)

See Also

The <a class="Identifier" href="#list">list</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-list-&gt;string">vl-list-&gt;string</h3>

Combines the characters associated with a list of integers into a string

(vl-list-&gt;string  char-codes-list)

<span class="ArgumentsIdentifier">Arguments</span>

char-codes-list

A list of non-negative integers. Each integer must be less than 256.

<span class="ReturnsIdentifier">Return Values</span>

A string of characters, with each character based on one of the integers
supplied in char-codes-list.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-list-&gt;string nil)

&quot;&quot;

_$ (vl-list-&gt;string '(49 50))

&quot;12&quot;

See Also

The <a class="Identifier" href="#vl-string-&gt;list">vl-string-&gt;list</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-list-exported-functions">vl-list-exported-functions</h3>

Lists exported functions

(vl-list-exported-functions <span class="Special">[appname]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

appname

A string naming a loaded VLX application. Do not include the .vlx extension.

<span class="ReturnsIdentifier">Return Values</span>

A list of strings naming exported functions, or nil, if there are no functions
exported from the specified VLX. If appname is omitted or is nil,
vl-list-exported-functions returns a list of all exported functions (for
example, c: functions) except those exported from VLX namespaces.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-list-exported-functions &quot;whichexpns&quot;)

(&quot;WHICHNAMESPACE&quot;)

See Also

The <a class="Identifier" href="#vl-list-loaded-vlx">vl-list-loaded-vlx</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-list-length">vl-list-length</h3>

Calculates list length of a true list

(vl-list-length  list-or-cons-object)

<span class="ArgumentsIdentifier">Arguments</span>

list-or-cons-object

A true or dotted list.

<span class="ReturnsIdentifier">Return Values</span>

An integer containing the list length if the argument is a true list, or nil if
list-or-cons-object is a dotted list.

Compatibility <span class="Todo">note</span>: The vl-list-length function returns nil for a dotted list,
while the corresponding Common Lisp function issues an error message if the
argument is a dotted list.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-list-length nil)

0

_$ (vl-list-length '(1 2))

2

_$ (vl-list-length '(1 2 . 3))

nil

See Also

The <a class="Identifier" href="#listp">listp</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-list-loaded-vlx">vl-list-loaded-vlx</h3>

Returns a list of all separate-namespace VLX files associated with the current
document

(vl-list-loaded-vlx)

<span class="ReturnsIdentifier">Return Values</span>

A list of symbols identifying separate-namespace VLX applications associated
with the current AutoCAD document, or nil if there are no VLX applications
associated with the current document.

The vl-list-loaded-vlx function does not identify VLX applications that are
loaded in the current document's namespace.

<span class="ExamplesIdentifier">Examples</span>

Test for loaded VLX files associated with the current AutoCAD document:

_$ (vl-list-loaded-vlx)

nil

No VLX files are associated with the current document.

Load two VLX files; both VLX applications have been compiled to run in their
own namespace:

_$ (load &quot;c:/my documents/visual lisp/examples/foo1.vlx&quot;)

nil

_$ (load &quot;c:/my documents/visual lisp/examples/foo2.vlx&quot;)

nil

Test for loaded VLX files associated with the current AutoCAD document:

_$ (vl-list-loaded-vlx)

(FOO1 FOO2)

The two VLX files just loaded are identified by vl-list-loaded-vlx.

Load a VLX that was compiled to run in a document's namespace:

_$ (load &quot;c:/my documents/visual lisp/examples/foolocal.vlx&quot;)

nil

Test for loaded VLX files:

_$ (vl-list-loaded-vlx)

(FOO1 FOO2))

The last VLX loaded (foolocal.vlx) is not returned by vl-list-loaded-vlx
because the application was loaded into the document's namespace; the VLX does
not have its own namespace.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-load-all">vl-load-all</h3>

Loads a file into all open AutoCAD documents, and into any document
subsequently opened during the current AutoCAD session

(vl-load-all filename)

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string naming the file to be loaded. If the file is in the AutoCAD Support
File Search Path, you can omit the path name, but you must always specify the
file extension; vl-load-all does not assume a file type.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified. If filename is not found, vl-load-all issues an error message.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-load-all &quot;c:/my documents/visual lisp/examples/whichns.lsp&quot;)

nil

_$ (vl-load-all &quot;yinyang.lsp&quot;)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-load-com">vl-load-com</h3>

Loads Visual LISP extensions to AutoLISP

(vl-load-com)

This function loads the extended AutoLISP functions provided with Visual LISP.
The Visual LISP extensions implement ActiveX and AutoCAD reactor support
through AutoLISP, and also provide ActiveX utility and data conversion
functions, dictionary handling functions, and curve measurement functions.

If the extensions are already loaded, vl-load-com does nothing.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

See Also

The <a class="Identifier" href="#load">load</a> function in this reference and the Using Extended AutoLISP Functions
topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-load-reactors">vl-load-reactors</h3>

Loads reactor support functions

(vl-load-reactors)

This function is identical to vl-load-com and is maintained for backward
compatibility.

See Also

The <a class="Identifier" href="#vl-load-com">vl-load-com</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-member-if">vl-member-if</h3>

Determines if the predicate is true for one of the list members

(vl-member-if  predicate-function list)

The vl-member-if function passes each element in list to the function specified
in predicate-function. If predicate-function returns a non-nil value,
vl-member-if returns the rest of the list in the same manner as the member
function.

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts a single argument and
returns T for any user-specified condition. The predicate-function value can
take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

<span class="ReturnsIdentifier">Return Values</span>

A list, starting with the first element that passes the test and containing all
elements following this in the original argument. If none of the elements
passes the test condition, vl-member-if returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following command draws a line:

_$ (COMMAND &quot;_.LINE&quot; '(0 10) '(30 50) nil)

nil

The following command uses vl-member-if to return association lists describing
an entity, if the entity is a line:

_$ (vl-member-if

'(lambda (x) (= (cdr x) &quot;AcDbLine&quot;))

 (entget (entlast)))

((100 . &quot;AcDbLine&quot;) (10 0.0 10.0 0.0) (11 30.0 50.0 0.0) (210 0.0
0.0 1.0))

See Also

The <a class="Identifier" href="#vl-member-if-not">vl-member-if-not</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-member-if-not">vl-member-if-not</h3>

Determines if the predicate is nil for one of the list members

(vl-member-if-not  predicate-function list)

The vl-member-if-not function passes each element in list to the function
specified in predicate-function. If the function returns nil, vl-member-if-not
returns the rest of the list in the same manner as the member function.

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts a single argument and
returns T for any user-specified condition. The predicate-function value can
take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

<span class="ReturnsIdentifier">Return Values</span>

A list, starting with the first element that fails the test and containing all
elements following this in the original argument. If none of the elements fails
the test condition, vl-member-if-not returns nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-member-if-not 'atom '(1 &quot;Str&quot; (0 . &quot;line&quot;) nil t))

((0 . &quot;line&quot;) nil T)

See Also

The <a class="Identifier" href="#vl-member-if">vl-member-if</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-position">vl-position</h3>

Returns the index of the specified list item

(vl-position  symbol list)

<span class="ArgumentsIdentifier">Arguments</span>

symbol

Any AutoLISP symbol.

list

A true list.

<span class="ReturnsIdentifier">Return Values</span>

An integer containing the index position of symbol in list, or nil if symbol
does not exist in the list.

<span class="Todo">Note</span> that the first list element is index 0, the second element is index 1, and
so on.

<span class="ExamplesIdentifier">Examples</span>

_$ (setq stuff (list &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;))

(&quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;)

_$ (vl-position &quot;c&quot; stuff)

2

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-prin1-to-string">vl-prin1-to-string</h3>

Returns the string representation of LISP data as if it were output by the
prin1 function

(vl-prin1-to-string  data)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the printed representation of data as if displayed by
prin1.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-prin1-to-string &quot;abc&quot;)

&quot;\&quot;abc\&quot;&quot;

_$ (vl-prin1-to-string &quot;c:\\acadwin&quot;)

&quot;\&quot;C:\\\\ACADWIN\&quot;&quot;

_$ (vl-prin1-to-string 'my-var)

&quot;MY-VAR&quot;

See Also

The <a class="Identifier" href="#vl-princ-to-string">vl-princ-to-string</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-princ-to-string">vl-princ-to-string</h3>

Returns the string representation of LISP data as if it were output by the
princ function

(vl-princ-to-string  data)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the printed representation of data as if displayed by
princ.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-princ-to-string &quot;abc&quot;)

&quot;abc&quot;

_$ (vl-princ-to-string &quot;c:\\acadwin&quot;)

&quot;C:\\ACADWIN&quot;

_$ (vl-princ-to-string 'my-var)

&quot;MY-VAR&quot;

See Also

The <a class="Identifier" href="#vl-prin1-to-string">vl-prin1-to-string</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-propagate">vl-propagate</h3>

Copies the value of a variable into all open document namespaces (and sets its
value in any subsequent drawings opened during the current AutoCAD session)

(vl-propagate 'symbol)

<span class="ArgumentsIdentifier">Arguments</span>

symbol

A symbol naming an AutoLISP variable.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="ExamplesIdentifier">Examples</span>

Command: (vl-propagate 'radius)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-registry-delete">vl-registry-delete</h3>

Deletes the specified key or value from the Windows registry

(vl-registry-delete reg-key <span class="Special">[val-name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

reg-key

A string specifying a Windows registry key.

val-name

A string containing the value of the reg-key entry.

If val-name is supplied and is not nil, the specified value will be purged from
the registry. If val-name is absent or nil, the function deletes the specified
key and all of its values.

<span class="ReturnsIdentifier">Return Values</span>

T if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-registry-write &quot;HKEY_CURRENT_USER\\Test&quot; &quot;&quot; &quot;test data&quot;)

&quot;test data&quot;

_$ (vl-registry-read &quot;HKEY_CURRENT_USER\\Test&quot;)

&quot;test data&quot;

_$ (vl-registry-delete &quot;HKEY_CURRENT_USER\\Test&quot;)

T

<span class="Todo">Note</span>:  This function cannot delete a key that has subkeys. To delete a subtree
you must use vl-registry-descendents to enumerate all subkeys and delete all of
them.

See Also

The <a class="Identifier" href="#vl-registry-descendents">vl-registry-descendents</a> and <a class="Identifier" href="#vl-registry-write">vl-registry-write</a>
functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-registry-descendents">vl-registry-descendents</h3>

Returns a list of subkeys or value names for the specified registry key

(vl-registry-descendents reg-key <span class="Special">[val-names]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

reg-key

A string specifying a Windows registry key.

val-names

A string containing the values for the reg-key entry.

If val-names is supplied and is not nil, the specified value names will be
listed from the registry. If val-name is absent or nil, the function displays
all subkeys of reg-key.

<span class="ReturnsIdentifier">Return Values</span>

A list of strings, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-registry-descendents &quot;HKEY_LOCAL_MACHINE\\SOFTWARE&quot;)

(&quot;Description&quot; &quot;Program Groups&quot; &quot;ORACLE&quot; &quot;ODBC&quot; &quot;Netscape&quot;
&quot;Microsoft&quot;)

See Also

The <a class="Identifier" href="#vl-registry-delete">vl-registry-delete</a> and <a class="Identifier" href="#vl-registry-write">vl-registry-write</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-registry-read">vl-registry-read</h3>

Returns data stored in the Windows registry for the specified key/value pair

(vl-registry-read reg-key <span class="Special">[val-name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

reg-key

A string specifying a Windows registry key.

val-name

A string containing the value of a registry entry.

If val-name is supplied and is not nil, the specified value will be read from
the registry. If val-name is absent or nil, the function reads the specified
key and all of its values.

<span class="ReturnsIdentifier">Return Values</span>

A string containing registry data, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-registry-read &quot;HKEY_CURRENT_USER\\Test&quot;)

nil

_$ (vl-registry-write &quot;HKEY_CURRENT_USER\\Test&quot; &quot;&quot; &quot;test data&quot;)

&quot;test data&quot;

_$ (vl-registry-read &quot;HKEY_CURRENT_USER\\Test&quot;)

&quot;test data&quot;

See Also

The <a class="Identifier" href="#vl-registry-delete">vl-registry-delete</a> and <a class="Identifier" href="#vl-registry-write">vl-registry-write</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-registry-write">vl-registry-write</h3>

Creates a key in the Windows registry

(vl-registry-write reg-key [val-name val-data])

<span class="ArgumentsIdentifier">Arguments</span>

reg-key

A string specifying a Windows registry key.

<span class="Todo">Note</span>:  You cannot use vl-registry-write for HKEY_USERS or KEY_LOCAL_MACHINE.

val-name

A string containing the value of a registry entry.

val-data

A string containing registry data.

If val-name is not supplied or is nil, a default value for the key is written.
If val-name is supplied and val-data is not specified, an empty string is
stored.

<span class="ReturnsIdentifier">Return Values</span>

vl-registry-write returns val-data, if successful, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-registry-write &quot;HKEY_CURRENT_USER\\Test&quot; &quot;&quot; &quot;test data&quot;)

&quot;test data&quot;

_$ (vl-registry-read &quot;HKEY_CURRENT_USER\\Test&quot;)

&quot;test data&quot;

See Also


The <a class="Identifier" href="#vl-registry-delete">vl-registry-delete</a> and <a class="Identifier" href="#vl-registry-read">vl-registry-read</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-remove">vl-remove</h3>

Removes elements from a list

(vl-remove  element-to-remove list)

<span class="ArgumentsIdentifier">Arguments</span>

element-to-remove

The value of the element to be removed; may be any LISP data type.

list

Any list.

<span class="ReturnsIdentifier">Return Values</span>

The list with all elements except those equal to element-to-remove.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-remove pi (list pi t 0 &quot;abc&quot;))

(T 0 &quot;abc&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-remove-if">vl-remove-if</h3>

Returns all elements of the supplied list that fail the test function

(vl-remove-if  predicate-function list)

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts a single argument and
returns T for any user-specified condition. The predicate-function value can
take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

<span class="ReturnsIdentifier">Return Values</span>

A list containing all elements of list for which predicate-function returns
nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-remove-if 'vl-symbolp (list pi t 0 &quot;abc&quot;))

(3.14159 0 &quot;abc&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-remove-if-not">vl-remove-if-not</h3>

Returns all elements of the supplied list that pass the test function

(vl-remove-if-not  predicate-function list)

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts a single argument and
returns T for any user-specified condition. The predicate-function value can
take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

<span class="ReturnsIdentifier">Return Values</span>

A list containing all elements of list for which predicate-function returns a
non-nil value

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-remove-if-not 'vl-symbolp (list pi t 0 &quot;abc&quot;))

(T)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-some">vl-some</h3>

Checks whether the predicate is not nil for one element combination

(vl-some  predicate-function list <span class="Special">[list]</span>...)

<span class="ArgumentsIdentifier">Arguments</span>

predicate-function

The test function. This can be any function that accepts as many arguments as
there are lists provided with vl-some, and returns T on a user-specified
condition. The predicate-function value can take one of the following forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

list

A list to be tested.

The vl-some function passes the first element of each supplied list as an
argument to the test function, then the next element from each list, and so on.
Evaluation stops as soon as the predicate function returns a non-nil value for
an argument combination, or until all elements have been processed in one of
the lists.

<span class="ReturnsIdentifier">Return Values</span>

The predicate value, if predicate-function returned a value other than nil,
otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following example checks whether nlst (a number list) has equal elements in
sequence:

_$ (setq nlst (list 0 2 pi pi 4))

(0 2 3.14159 3.14159 4)

_$ (vl-some '= nlst (cdr nlst))

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-sort">vl-sort</h3>

Sorts the elements in a list according to a given compare function

(vl-sort  list comparison-function)

<span class="ArgumentsIdentifier">Arguments</span>

list

Any list.

comparison-function

A comparison function. This can be any function that accepts two arguments and
returns T (or any non-nil value) if the first argument precedes the second in
the sort order. The comparison-function value can take one of the following
forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

<span class="ReturnsIdentifier">Return Values</span>

A list containing the elements of list in the order specified by
comparison-function. Duplicate elements may be eliminated from the list.

<span class="ExamplesIdentifier">Examples</span>

Sort a list of numbers:

_$ (vl-sort '(3 2 1 3) '&lt;)

(1 2 3) ;

<span class="Todo">Note</span> that the result list contains only one 3.

Sort a list of 2D points by Y coordinate:

_$ (vl-sort '((1 3) (2 2) (3 1))

 (function (lambda (e1 e2)

 (&lt; (cadr e1) (cadr e2)) ) ) )

((3 1) (2 2) (1 3))

Sort a list of symbols:

_$ (vl-sort

 '(a d c b a)

 '(lambda (s1 s2)

 (&lt; (vl-symbol-name s1) (vl-symbol-name s2)) ) )

(A B C D) ; <span class="Todo">Note</span> that only one A remains in the result list

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-sort-i">vl-sort-i</h3>

Sorts the elements in a list according to a given compare function, and returns
the element index numbers

(vl-sort-i  list comparison-function)

<span class="ArgumentsIdentifier">Arguments</span>

list

Any list.

comparison-function

A comparison function. This can be any function that accepts two arguments and
returns T (or any non-nil value) if the first argument precedes the second in
the sort order. The comparison-function value can take one of the following
forms:

<span class="Statement">  </span>* A symbol (function name)
<span class="Statement">  </span>* '(LAMBDA (A1 A2) ...)
<span class="Statement">  </span>* (FUNCTION (LAMBDA (A1 A2) ...))

<span class="ReturnsIdentifier">Return Values</span>

A list containing the index values of the elements of list, sorted in the order
specified by comparison-function. Duplicate elements will be retained in the
result.

<span class="ExamplesIdentifier">Examples</span>

Sort a list of characters in descending order:

_$ (vl-sort-i '(&quot;a&quot; &quot;d&quot; &quot;f&quot; &quot;c&quot;) '&gt;)

(2 1 3 0)

The sorted list order is &quot;f&quot; &quot;d&quot; &quot;c&quot; &quot;a&quot;; &quot;f&quot; is the 3rd element (index 2) in
the original list, &quot;d&quot; is the 2nd element (index 1) in the list, and so on.

Sort a list of numbers in ascending order:

_$ (vl-sort-i '(3 2 1 3) '&lt;)

(2 1 3 0)

<span class="Todo">Note</span> that both occurrences of 3 are accounted for in the result list.

Sort a list of 2D points by Y coordinate:

_$ (vl-sort-i '((1 3) (2 2) (3 1))

 (function (lambda (e1 e2)

 (&lt; (cadr e1) (cadr e2)) ) ) )

(2 1 0)

Sort a list of symbols:

_$ (vl-sort-i

 '(a d c b a)

 '(lambda (s1 s2)

 (&lt; (vl-symbol-name s1) (vl-symbol-name s2)) ) )

(4 0 3 2 1)

<span class="Todo">Note</span> that both a's are accounted for in the result list.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vl-string-&gt;list">vl-string-&gt;list</h3>

Converts a string into a list of character codes

(vl-string-&gt;list  string)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

<span class="ReturnsIdentifier">Return Values</span>

A list, each element of which is an integer representing the character code of
the corresponding character in string.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-&gt;list &quot;&quot;)

nil

_$ (vl-string-&gt;list &quot;12&quot;)

(49 50)

See Also

The <a class="Identifier" href="#vl-list-&gt;string">vl-list-&gt;string</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-elt">vl-string-elt</h3>

Returns the ASCII representation of the character at a specified position in a
string

(vl-string-elt string position)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string to be inspected.

position

A displacement in the string; the first character is displacement 0. <span class="Todo">Note</span> that
an error occurs if position is outside of the range of the string.

<span class="ReturnsIdentifier">Return Values</span>

An integer denoting the ASCII representation of the character at the specified
position

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-elt &quot;May the Force be with you&quot; 8)

70

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-string-left-trim">vl-string-left-trim</h3>

Removes the specified characters from the beginning of a string

(vl-string-left-trim character-set string)

<span class="ArgumentsIdentifier">Arguments</span>

character-set

A string listing the characters to be removed.

string

The string to be stripped of character-set.

<span class="ReturnsIdentifier">Return Values</span>

A string containing a substring of string with all leading characters in
character-set removed

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-left-trim &quot; \t\n&quot; &quot;\n\t STR &quot;)

&quot;STR &quot;

_$ (vl-string-left-trim &quot;12456789&quot; &quot;12463CPO is not R2D2&quot;)

&quot;3CPO is not R2D2&quot;

_$ (vl-string-left-trim &quot; &quot; &quot; There are too many spaces here&quot;)

&quot;There are too many spaces here&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-mismatch">vl-string-mismatch</h3>

Returns the length of the longest common prefix for two strings, starting at
specified positions

(vl-string-mismatch str1 str2 [pos1 pos2 ignore-case-p])

<span class="ArgumentsIdentifier">Arguments</span>

str1

The first string to be matched.

str2

The second string to be matched.

pos1

An integer identifying the position to search from in the first string; 0 if
omitted.

pos2

An integer identifying the position to search from in the second string; 0 if
omitted.

ignore-case-p

If T is specified for this argument, case is ignored, otherwise case is
considered.

<span class="ReturnsIdentifier">Return Values</span>

An integer.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-mismatch &quot;VL-FUN&quot; &quot;VL-VAR&quot;)

3

_$ (vl-string-mismatch &quot;vl-fun&quot; &quot;avl-var&quot;)

0

_$ (vl-string-mismatch &quot;vl-fun&quot; &quot;avl-var&quot; 0 1)

3

_$ (vl-string-mismatch &quot;VL-FUN&quot; &quot;Vl-vAR&quot;)

1

_$ (vl-string-mismatch &quot;VL-FUN&quot; &quot;Vl-vAR&quot; 0 0 T)

3

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-position">vl-string-position</h3>

Looks for a character with the specified ASCII code in a string

(vl-string-position char-code str [start-pos <span class="Special">[from-end-p]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

char-code

The integer representation of the character to be searched.

str

The string to be searched.

start-pos

The position to begin searching from in the string (first character is 0); 0 if
omitted.

from-end-p

If T is specified for this argument, the search begins at the end of the string
and continues backward to pos.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the displacement at which char-code was found from the
beginning of the string; nil if the character was not found.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-position (ascii &quot;z&quot;) &quot;azbdc&quot;)

1

_$ (vl-string-position 122 &quot;azbzc&quot;)

1

_$ (vl-string-position (ascii &quot;x&quot;) &quot;azbzc&quot;)

nil

The search string used in the following example contains two &quot;z&quot; characters.
Reading from left to right, with the first character being displacement 0,
there is one z at displacement 1 and another z at displacement 3:

_$ (vl-string-position (ascii &quot;z&quot;) &quot;azbzlmnqc&quot;)

1

Searching from left to right (the default), the &quot;z&quot; in position 1 is the first
one vl-string-position encounters. But when searching from right to left, as in
the following example, the &quot;z&quot; in position 3 is the first one encountered:

_$ (vl-string-position (ascii &quot;z&quot;) &quot;azbzlmnqc&quot; nil t)

3

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-string-right-trim">vl-string-right-trim</h3>

Removes the specified characters from the end of a string

(vl-string-right-trim character-set string)

<span class="ArgumentsIdentifier">Arguments</span>

character-set

A string listing the characters to be removed.

string

The string to be stripped of character-set.

<span class="ReturnsIdentifier">Return Values</span>

A string containing a substring of string with all trailing characters in
character-set removed.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-right-trim &quot; \t\n&quot; &quot; STR \n\t &quot;)

&quot; STR&quot;

_$ (vl-string-right-trim &quot;1356789&quot; &quot;3CPO is not R2D267891&quot;)

&quot;3CPO is not R2D2&quot;

_$ (vl-string-right-trim &quot; &quot; &quot;There are too many spaces here &quot;)

&quot;There are too many spaces here&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-search">vl-string-search</h3>

Searches for the specified pattern in a string

(vl-string-search pattern string <span class="Special">[start-pos]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

pattern

A string containing the pattern to be searched for.

string

The string to be searched for pattern.

start-pos

An integer identifying the starting position of the search; 0, if omitted.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the position in the string where the specified pattern
was found, or nil if the pattern is not found; the first character of the
string is position 0.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-search &quot;foo&quot; &quot;pfooyey on you&quot;)

1

_$ (vl-string-search &quot;who&quot; &quot;pfooyey on you&quot;)

nil

_$ (vl-string-search &quot;foo&quot; &quot;fooey-more-fooey&quot; 1)

11

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-subst">vl-string-subst</h3>

Substitutes one string for another, within a string

(vl-string-subst new-str pattern string <span class="Special">[start-pos]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

new-str

The string to be substituted for pattern.

pattern

A string containing the pattern to be replaced.

string

The string to be searched for pattern.

start-pos

An integer identifying the starting position of the search; 0, if omitted.

<span class="Todo">Note</span> that the search is case-sensitive, and vl-string-subst only substitutes
the first occurrence it finds of the string.

<span class="ReturnsIdentifier">Return Values</span>

The value of string after any substitutions have been made

<span class="ExamplesIdentifier">Examples</span>

Replace the string &quot;Ben&quot; with &quot;Obi-wan&quot;:

_$ (vl-string-subst &quot;Obi-wan&quot; &quot;Ben&quot; &quot;Ben Kenobi&quot;)

&quot;Obi-wan Kenobi&quot;

Replace &quot;Ben&quot; with &quot;Obi-wan&quot;:

_$ (vl-string-subst &quot;Obi-wan&quot; &quot;Ben&quot; &quot;ben Kenobi&quot;)

&quot;ben Kenobi&quot;

Nothing was substituted because vl-string-subst did not find a match for &quot;Ben&quot;;
the &quot;ben&quot; in the string that was searched begins with a lowercase &quot;b&quot;.

Replace &quot;Ben&quot; with &quot;Obi-wan&quot;:

_$ (vl-string-subst &quot;Obi-wan&quot; &quot;Ben&quot; &quot;Ben Kenobi Ben&quot;)

&quot;Obi-wan Kenobi Ben&quot;

<span class="Todo">Note</span> that there are two occurrences of &quot;Ben&quot; in the string that was searched,
but vl-string-subst only replaces the first occurrence.

Replace &quot;Ben&quot; with &quot;Obi-wan,&quot; but start the search at the fourth character in
the string:

_$ (vl-string-subst &quot;Obi-wan&quot; &quot;Ben&quot; &quot;Ben \&quot;Ben\&quot; Kenobi&quot; 3)

&quot;Ben \&quot;Obi-wan\&quot; Kenobi&quot;

There are two occurrences of &quot;Ben&quot; in the string that was searched, but because
vl-string-subst was instructed to begin searching at the fourth character, it
found and replaced the second occurrence, not the first.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-translate">vl-string-translate</h3>

Replaces characters in a string with a specified set of characters

(vl-string-translate source-set dest-set str)

<span class="ArgumentsIdentifier">Arguments</span>

source-set

A string of characters to be matched.

dest-set

A string of characters to be substituted for those in source-set.

str

A string to be searched and translated.

<span class="ReturnsIdentifier">Return Values</span>

The value of str after any substitutions have been made

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-translate &quot;abcABC&quot; &quot;123123&quot; &quot;A is a, B is b, C is C&quot;)

&quot;1 is 1, 2 is 2, 3 is 3&quot;

_$ (vl-string-translate &quot;abc&quot; &quot;123&quot; &quot;A is a, B is b, C is C&quot;)

&quot;A is 1, B is 2, C is 3&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-string-trim">vl-string-trim</h3>

Removes the specified characters from the beginning and end of a string

(vl-string-trim char-set str)

<span class="ArgumentsIdentifier">Arguments</span>

char-set

A string listing the characters to be removed.

str

The string to be trimmed of char-set.

<span class="ReturnsIdentifier">Return Values</span>

The value of str, after any characters have been trimmed.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-string-trim &quot; \t\n&quot; &quot; \t\n STR \n\t &quot;)

&quot;STR&quot;

_$ (vl-string-trim &quot;this is junk&quot; &quot;this is junk Don't call this
junk! this is junk&quot;)

&quot;Don't call this junk!&quot;

_$ (vl-string-trim &quot; &quot; &quot; Leave me alone &quot;)

&quot;Leave me alone&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-symbol-name">vl-symbol-name</h3>

Returns a string containing the name of a symbol

(vl-symbol-name  symbol)

<span class="ArgumentsIdentifier">Arguments</span>

symbol

Any LISP symbol.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the name of the supplied symbol argument, in uppercase.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-symbol-name 'S::STARTUP)

&quot;S::STARTUP&quot;

_$ (progn (setq sym 'my-var) (vl-symbol-name sym))

&quot;MY-VAR&quot;

_$ (vl-symbol-name 1)

ERROR: bad argument type: symbolp 1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-symbol-value">vl-symbol-value</h3>

Returns the current value bound to a symbol

(vl-symbol-value  symbol)

This function is equivalent to the eval function, but does not call the LISP
evaluator.

<span class="ArgumentsIdentifier">Arguments</span>

symbol

Any LISP symbol.

<span class="ReturnsIdentifier">Return Values</span>

The value of symbol, after evaluation.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-symbol-value 't)

T

_$ (vl-symbol-value 'PI)

3.14159

_$ (progn (setq sym 'PAUSE) (vl-symbol-value sym))

&quot;\\&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-symbolp">vl-symbolp</h3>

Identifies whether or not a specified object is a symbol

<span class="ArgumentsIdentifier">Arguments</span>

(vl-symbolp  object)

object

Any LISP object.

<span class="ReturnsIdentifier">Return Values</span>

T if object is a symbol, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-symbolp t)

T

_$ (vl-symbolp nil)

nil

_$ (vl-symbolp 1)

nil

_$ (vl-symbolp (list 1))

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-unload-vlx">vl-unload-vlx</h3>

Unload a VLX application that is loaded in its own namespace

(vl-unload-vlx appname)

<span class="ArgumentsIdentifier">Arguments</span>

appname

A string naming a VLX application that is loaded in its own namespace. Do not
include the .vlx extension.

The vl-unload-vlx function does not unload VLX applications that are loaded in
the current document's namespace.

<span class="ReturnsIdentifier">Return Values</span>

T if successful, otherwise vl-unload-vlx results in an error.

<span class="ExamplesIdentifier">Examples</span>

Assuming that vlxns is an application that is loaded in its own namespace, the
following command unloads vlxns:

Command: (vl-unload-vlx &quot;vlxns&quot;)

T

Try unloading vlxns again:

Command: (vl-unload-vlx &quot;vlxns&quot;)

; ERROR: LISP Application is not found VLXNS

The vl-unload-vlx command fails this time, because the application was not
loaded.

See Also

The <a class="Identifier" href="#load">load</a> and <a class="Identifier" href="#vl-vlx-loaded-p">vl-vlx-loaded-p</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-vbaload">vl-vbaload</h3>

Loads a Visual Basic project

<span class="ArgumentsIdentifier">Arguments</span>

(vl-vbaload  filename)

filename

A string naming the Visual Basic project file to be loaded.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified, if successful.

<span class="ExamplesIdentifier">Examples</span>

_$ (vl-vbaload &quot;c:/program files/AutoCAD/sample/vba/
drawline.dvb&quot;)

&quot;c:\\program files\\AutoCAD\\sample\\vba\\drawline.dvb&quot;

See Also

The <a class="Identifier" href="#vl-vbarun">vl-vbarun</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vl-vbarun">vl-vbarun</h3>

Runs a Visual Basic macro

<span class="ArgumentsIdentifier">Arguments</span>

(vl-vbarun  macroname)

macroname

A string naming a loaded Visual Basic macro.

<span class="ReturnsIdentifier">Return Values</span>

macroname

<span class="ExamplesIdentifier">Examples</span>

Load a VBA project file:

_$ (vl-vbaload &quot;c:/program files/AutoCAD/sample/vba/
drawline.dvb&quot;)

&quot;c:\\program files\\AutoCAD\\sample\\vba\\drawline.dvb&quot;

Run a macro from the loaded project:

_$ (vl-vbarun &quot;drawline&quot;)

&quot;drawline&quot;

See Also

The <a class="Identifier" href="#vl-vbaload">vl-vbaload</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement">        </span><h3 class="String" id="vl-vlx-loaded-p">vl-vlx-loaded-p</h3>

Determines whether a separate-namespace VLX is currently loaded

(vl-vlx-loaded-p appname)

<span class="ArgumentsIdentifier">Arguments</span>

appname

A string naming a VLX application.

<span class="ReturnsIdentifier">Return Values</span>

T if the application is loaded, nil if it is not loaded.

<span class="ExamplesIdentifier">Examples</span>

Check to see if the vlxns application is loaded in its own namespace:

Command: (vl-vlx-loaded-p &quot;vlxns&quot;)

nil

The application is not loaded in its own namespace.

Now load vlxns:

Command: (load &quot;vlxns.vlx&quot;)

nil

Check to see if the vlxns application loaded successfully:

Command: (vl-vlx-loaded-p &quot;vlxns&quot;)

T

This example assumes vlxns was defined to run in its own namespace. If the
application was not defined to run in its own namespace, it would load into the
current document's namespace and vl-vlx-loaded-p would return nil.

See Also

The <a class="Identifier" href="#load">load</a> and <a class="Identifier" href"#vl-unload-vlx">vl-unload-vlx</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-3D-point">vlax-3D-point</h3>

Creates ActiveX-compatible (variant) 3D point structure

(vlax-3D-point list) or (vlax-3D-point x y [z])

<span class="ArgumentsIdentifier">Arguments</span>

list

A list of 2 or 3 numbers, representing points.

x, y

Numbers representing X and Y coordinates of a point.

z

A number representing the Z coordinate of a point.

<span class="ReturnsIdentifier">Return Values</span>

A variant containing a three-element array of doubles.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-3D-point 5 20)

#&lt;variant 8197 ...&gt;

_$ (vlax-3D-point '(33.6 44.0 90.0))

&lt;variant 8197 ...&gt;

See Also

The <a class="Identifier" href="#vlax-make-safearray">vlax-make-safe-array</a>, <a class="Identifier" href="#vlax-safearray-fill">vlax-safearray-fill</a>, and
<a class="Identifier" href="#vlax-safearray-put-element">vlax-safearray-put-element</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-add-cmd">vlax-add-cmd</h3>

Adds commands to the AutoCAD built-in command set

(vlax-add-cmd global-name func-sym [local-name cmd-flags])

With vlax-add-cmd you can define a function as an AutoCAD command, without
using the c: prefix in the function name. You can also define a transparent
AutoLISP command, which is not possible with a c: function.

Warning!  You cannot use the command function call in a transparently-defined
vlax-add-cmd function. Doing so can cause AutoCAD to close unexpectedly.

The vlax-add-cmd function makes an AutoLISP function visible as an
ObjectARX-style command at the AutoCAD Command prompt during the current
AutoCAD session. The function provides access to the ObjectARX acedRegCmds
macro, which provides a pointer to the ObjectARX system AcEdCommandStack
object.

The vlax-add-cmd function automatically assigns commands to command groups.
When issued from a document namespace, vlax-add-cmd adds the command to a group
named doc-ID; doc-ID is a hexadecimal value identifying the document. If issued
from a separate-namespace VLX, vlax-add-cmd adds the command to a group named
VLC-Ddoc-ID:VLX-name, where VLX-name is the name of the application that issued
vlax-add-cmd.

It is recommended that you use the vlax-add-cmd function from a
separate-namespace VLX. You should then explicitly load the VLX using the
APPLOAD command, rather than by placing it in one of the startup LISP files.

<span class="Todo">Note</span>:  You cannot use vlax-add-cmd to expose functions that create reactor
objects or serve as reactor callbacks.

<span class="ArgumentsIdentifier">Arguments</span>

global-name

A string.

func-sym

A symbol naming an AutoLISP function with zero arguments.

local-name

A string (defaults to global-name).

cmd-flags

An integer (defaults to ACRX_CMD_MODAL + ACRX_CMD_REDRAW)

The primary flags are:

ACRX_CMD_MODAL (0) Command cannot be invoked while another command is active.

ACRX_CMD_TRANSPARENT (1) Command can be invoked while another command is
active.

The secondary flags are:

ACRX_CMD_USEPICKSET (2) When the pickfirst set is retrieved it is cleared
within AutoCAD. Command will be able to retrieve the pickfirst set. Command
cannot retrieve or set grips.

ACRX_CMD_REDRAW (4) When the pickfirst set or grip set is retrieved, neither
will be cleared within AutoCAD. Command can retrieve the pickfirst set and the
grip set.

If both ACRX_CMD_USEPICKSET and ACRX_CMD_REDRAW are set, the effect is the same
as if just ACRX_CMD_REDRAW is set. For more information on the flags, refer to
the Command Stack topic in the ObjectARX Reference manual.

<span class="ReturnsIdentifier">Return Values</span>

The global-name argument, if successful. The function returns nil, if
acedRegCmds-&gt;addCommand(...) returns an error condition.

<span class="ExamplesIdentifier">Examples</span>

The hello-autocad function in the following example has no c: prefix, but
vlax-add-cmd makes it visible as an ObjectARX-style command at the AutoCAD
Command prompt:

_$ (defun hello-autocad () (princ &quot;hello Visual LISP&quot;))

HELLO-AUTOCAD

_$ (vlax-add-cmd &quot;hello-autocad&quot; 'hello-autocad)

&quot;hello-autocad&quot;

See Also

The <a class="Identifier" href="#vlax-remove-cmd">vlax-remove-cmd</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-create-object">vlax-create-object</h3>

Creates a new instance of an application object

(vlax-create-object prog-id)

Use vlax-create-object when you want a new instance of an application to be
started, and an object of the type specified by <span class="Special">&lt;Component&gt;</span> (see the argument
description) to be created. To use the current instance, use vlax-get-object.
However, if an application object has registered itself as a single-instance
object, only one instance of the object is created, no matter how many times
you call vlax-create-object.

<span class="ArgumentsIdentifier">Arguments</span>

prog-id

A string containing the programmatic identifier of the desired ActiveX object.
The format of prog-id is:

<span class="Special">&lt;Vendor&gt;</span>.<span class="Special">&lt;Component&gt;</span>.<span class="Special">&lt;Version&gt;</span>

For example:

AutoCAD.Drawing.15

<span class="ReturnsIdentifier">Return Values</span>

The application object (VLA-object).

<span class="ExamplesIdentifier">Examples</span>

Create an instance of an Excel application:

_$ (vlax-create-object &quot;Excel.Application&quot;)

#&lt;VLA-OBJECT _Application 0017b894&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getArea">vlax-curve-getArea</h3>

Returns the area inside the curve

(vlax-curve-getArea curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing the area of the curve, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assume the curve being measured is the ellipse in the following drawing:

Sample curve (ellipse) for vlax-curve-getarea

The ellipseObj variable points to the ellipse VLA-object.

The following command obtains the area of the curve:

_$ (vlax-curve-getArea ellipseObj)

4.712393

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getClosestPointTo">vlax-curve-getClosestPointTo</h3>

Returns the point (in WCS) on a curve that is nearest to the specified point

(vlax-curve-getClosestPointTo curve-obj givenPnt <span class="Special">[extend]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

givenPnt

A point (in WCS) for which to find the nearest point on the curve.

extend

If specified and not nil, vlax-curve-getClosestPointTo extends the curve when
searching for the nearest point.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing a point on the curve, if successful, otherwise
nil.

<span class="ExamplesIdentifier">Examples</span>

Assume that the curve being measured is the arc in the following drawing:

Return the closest point on the arc to the coordinates 6.0, 0.5:

_$ (vlax-curve-getClosestPointTo arcObj '(6.0 0.5 0.0))

(6.0 1.5 0.0)

Return the closest point on the arc to the coordinates 6.0, 0.5, after
extending the arc:

_$ (vlax-curve-getClosestPointTo arcObj '(6.0 0.5 0.0) T)

(5.7092 0.681753 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getClosestPointToProjection">vlax-curve-getClosestPointToProjection</h3>

Returns the closest point (in WCS) on a curve after projecting the curve onto a
plane

(vlax-curve-getClosestPointToProjection curve-obj  givenPnt normal <span class="Special">[extend]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

givenPnt

A point (in WCS) for which to find the nearest point on the curve.

normal

A normal vector (in WCS) for the plane to project onto.

extend

If specified and not nil, vlax-curve-getClosestPointToProjection extends the
curve when searching for the nearest point.

vlax-curve-getClosestPointToProjection projects the curve onto the plane
defined by the givenPnt and normal, then calculates the nearest point on that
projected curve to givenPnt. The resulting point is then projected back onto
the original curve, and vlax-curve-getClosestPointToProjection returns that
projected point.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing a point on the curve, if successful, otherwise
nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getDistAtParam">vlax-curve-getDistAtParam</h3>

Returns the length of the curve's segment from the curve's beginning to the
specified parameter

(vlax-curve-getDistAtParam curve-obj param)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

param

A number specifying a parameter on the curve.

<span class="ReturnsIdentifier">Return Values</span>

A real number that is the length up to the specified parameter, if successful,
otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assume that splineObj points to the spline in the following drawing:

Sample curve (spline) for vlax-curve-getDistAtParam

Obtain the start parameter of the curve:

_$ (setq startSpline (vlax-curve-getStartParam splineObj))

0.0

The curve starts at parameter 0.

Obtain the end parameter of the curve:

_$ (setq endSpline (vlax-curve-getEndParam splineObj))

17.1546

The curve's end parameter is 17.1546.

Determine the distance to parameter midway along the curve:

_$ (vlax-curve-getDistAtParam splineObj

 ( / (- endspline startspline) 2))

8.99417

The distance from the start to the middle of the curve is 8.99417.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getDistAtPoint">vlax-curve-getDistAtPoint</h3>

Returns the length of the curve's segment between the curve's start point and
the specified point

(vlax-curve-getDistAtPoint curve-obj point)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

point

A 3D point list (in WCS) on curve-obj.

<span class="ReturnsIdentifier">Return Values</span>

A real number if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

For the following example, assume that splineObj points to the spline shown in
the example for vlax-curve-getDistAtParam .

Set OSNAP to tangent and select the point where the line is tangent to the
curve:

_$ (setq selPt (getpoint))

(4.91438 6.04738 0.0)

Determine the distance from the start of the curve to the selected point:

_$ (vlax-curve-getDistAtPoint splineObj selpt)

5.17769

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getEndParam">vlax-curve-getEndParam</h3>

Returns the parameter of the endpoint of the curve

(vlax-curve-getEndParam curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing an end parameter, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming that ellipseObj points to the ellipse shown in the example for
vlax-curve-getArea , the following function call returns the end parameter of
the curve:

_$ (vlax-curve-getendparam ellipseObj)

6.28319

The end parameter is 6.28319 (twice pi).

See Also

The <a class="Identifier" href="#vlax-curve-getStartParam">vlax-curve-getStartParam</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getEndPoint">vlax-curve-getEndPoint</h3>

Returns the endpoint (in WCS) of the curve

(vlax-curve-getEndPoint curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing an endpoint, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Get the endpoint of the ellipse used to demonstrate vlax-curve-getArea :

_$ (vlax-curve-getEndPoint ellipseObj)

(2.0 2.0 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getFirstDeriv">vlax-curve-getFirstDeriv</h3>

Returns the first derivative (in WCS) of a curve at the specified location

(vlax-curve-getFirstDeriv curve-obj param)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

param

A number specifying a parameter on the curve.

<span class="ReturnsIdentifier">Return Values</span>

A 3D vector list, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

For the following example, assume that splineObj points to the spline shown in
the example of the vlax-curve-getDistAtParam function.

Obtain the start parameter of the curve:

_$ (setq startSpline (vlax-curve-getStartParam splineObj))

0.0

Obtain the end parameter of the curve:

_$ (setq endSpline (vlax-curve-getEndParam splineObj))

17.1546

Determine the first derivative at the parameter midway along the curve:

_$ (vlax-curve-getFirstDeriv splineObj

 ( / (- endspline startspline) 2))

(0.422631 -1.0951 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getParamAtDist">vlax-curve-getParamAtDist</h3>

Returns the parameter of a curve at the specified distance from the beginning
of the curve

(vlax-curve-getParamAtDist curve-obj dist)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

dist

A number specifying the distance from the beginning of the curve.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing a parameter, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming that splineObj points to the spline shown in the example for
vlax-curve-getDistAtParam , determine the parameter at a distance of 1.0 from
the beginning of the spline:

_$ (vlax-curve-getParamAtDist splineObj 1.0)

0.685049

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getParamAtPoint">vlax-curve-getParamAtPoint</h3>

Returns the parameter of the curve at the point

(vlax-curve-getParamAtPoint curve-obj point)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

point

A 3D point list (in WCS) on curve-obj.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing a parameter, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming that ellipseObj points to the ellipse shown in the example for
vlax-curve-getArea , set OSNAP to tangent and select the point where the line
is tangent to the ellipse:

_$ (setq selPt (getpoint))

(7.55765 5.55066 0.0)

Get the parameter value at the selected point:

_$ (vlax-curve-getParamAtPoint ellipseObj selPt)

4.58296

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getPointAtDist">vlax-curve-getPointAtDist</h3>

Returns the point (in WCS) along a curve at the distance specified by the user

(vlax-curve-getPointAtDist curve-obj dist)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

dist

The distance along the curve from the beginning of the curve to the location of
the specified point.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing a point on the curve, if successful, otherwise
nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming that splineObj points to the spline shown in the example for
vlax-curve-getDistAtParam , determine the point at a distance of 1.0 from the
beginning of the spline:

_$ (vlax-curve-getPointAtDist splineObj 1.0)

(2.24236 2.99005 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getPointAtParam">vlax-curve-getPointAtParam</h3>

Returns the point at the specified parameter value along a curve

(vlax-curve-getPointAtParam curve-obj param)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

param

A number specifying a parameter on the curve.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing a point on the curve, if successful, otherwise
nil.

<span class="ExamplesIdentifier">Examples</span>

For the following example, assume that splineObj points to the spline shown in
the example for vlax-curve-getDistAtParam .

Obtain the start parameter of the curve:

_$ (setq startSpline (vlax-curve-getStartParam splineObj))

0.0

Obtain the end parameter of the curve:

_$ (setq endSpline (vlax-curve-getEndParam splineObj))

17.1546

Determine the point at the parameter midway along the curve:

_$ (vlax-curve-getPointAtParam splineObj

 ( / (- endspline startspline) 2))

(6.71386 2.82748 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getSecondDeriv">vlax-curve-getSecondDeriv</h3>

Returns the second derivative (in WCS) of a curve at the specified location

(vlax-curve-getSecondDeriv curve-obj  param)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

param

A number specifying a parameter on the curve.

<span class="ReturnsIdentifier">Return Values</span>

A 3D vector list, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

For the following example, assume that splineObj points to the spline shown in
the example of the vlax-curve-getDistAtParam function.

Obtain the start parameter of the curve:

_$ (setq startSpline (vlax-curve-getStartParam splineObj))

0.0

Obtain the end parameter of the curve:

_$ (setq endSpline (vlax-curve-getEndParam splineObj))

17.1546

Determine the second derivative at the parameter midway along the curve:

_$ (vlax-curve-getSecondDeriv splineObj

 ( / (- endspline startspline) 2))

(0.0165967 0.150848 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getStartParam">vlax-curve-getStartParam</h3>

Returns the start parameter on the curve

(vlax-curve-getStartParam curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

<span class="ReturnsIdentifier">Return Values</span>

A real number representing the start parameter, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Assuming that ellipseObj points to the ellipse shown in the example for
vlax-curve-getArea , determine the start parameter of the curve:

_$ (vlax-curve-getstartparam ellipseObj)

0.0

See Also

The <a class="Identifier" href="#vlax-curve-getEndParam">vlax-curve-getEndParam</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-getStartPoint">vlax-curve-getStartPoint</h3>

Returns the start point (in WCS) of the curve

(vlax-curve-getStartPoint curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be measured.

<span class="ReturnsIdentifier">Return Values</span>

A 3D point list representing the start point, if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Get the start point of the ellipse used to demonstrate vlax-curve-getArea :

_$ (vlax-curve-getStartPoint ellipseObj)

(2.0 2.0 0.0)

For an ellipse, the start points and endpoints are the same.

Obtain the start point of the spline used to demonstrate
vlax-curve-getDistAtParam :

_$ (vlax-curve-getStartPoint splineObj)

(1.73962 2.12561 0.0)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-isClosed">vlax-curve-isClosed</h3>

Determines if the specified curve is closed (that is, the start point is the
same as the endpoint)

(vlax-curve-isClosed curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T if the curve is closed, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Determine if the ellipse used to demonstrate vlax-curve-getArea is closed:

_$ (vlax-curve-isClosed ellipseObj)

T

Determine if the spline used to demonstrate vlax-curve-getDistAtParam is
closed:

_$ (vlax-curve-isClosed splineObj)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-isPeriodic">vlax-curve-isPeriodic</h3>

Determines if the specified curve has an infinite range in both directions and
there is a period value dT, such that a point on the curve at (u + dT) = point
on curve (u), for any parameter u

(vlax-curve-isPeriodic curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T if the curve is periodic, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Determine if the ellipse used to demonstrate vlax-curve-getArea is periodic:

_$ (vlax-curve-isPeriodic ellipseObj)

T

Determine if the spline used to demonstrate vlax-curve-getDistAtParam is
periodic:

_$ (vlax-curve-isPeriodic splineObj)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-curve-isPlanar">vlax-curve-isPlanar</h3>

Determines if there is a plane that contains the curve

(vlax-curve-isPlanar curve-obj)

<span class="ArgumentsIdentifier">Arguments</span>

curve-obj

The VLA-object to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T if there is a plane that contains the curve, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Determine if there is a plane containing the ellipse used to demonstrate
vlax-curve-getArea :

_$ (vlax-curve-isPlanar ellipseObj)

T

Determine if there is a plane containing the spline used to demonstrate
vlax-curve-getDistAtParam :

_$ (vlax-curve-isPeriodic splineObj)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-dump-object">vlax-dump-object</h3>

Lists an object's properties, and optionally, the methods that apply to the
object

(vlax-dump-object obj [T])

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

T

If specified, vlax-dump-object also lists all methods that apply to obj.

<span class="ReturnsIdentifier">Return Values</span>

T, if successful. If an invalid object name is supplied, vlax-dump-object
displays an error message.

<span class="ExamplesIdentifier">Examples</span>

_$ (setq aa (vlax-get-acad-object))

#&lt;VLA-OBJECT IAcadApplication 00b3b91c&gt;

_$ (vlax-dump-object aa)

; IAcadApplication: AutoCAD Application Interface

; Property values:

; ActiveDocument (RO) = #&lt;VLA-OBJECT IAcadDocument 01b52fac&gt;

; Application (RO) = #&lt;VLA-OBJECT IAcadApplication 00b3b91c&gt;

; Caption (RO) = &quot;AutoCAD - [Drawing.dwg]&quot;

.

.

.

T

List an object's properties and the methods that apply to the object:

_$ (vlax-dump-object aa T)

; IAcadApplication: AutoCAD Application Interface

; Property values:

; ActiveDocument (RO) = #&lt;VLA-OBJECT IAcadDocument 01b52fac&gt;

; Application (RO) = #&lt;VLA-OBJECT IAcadApplication 00b3b91c&gt;

; Caption (RO) = &quot;AutoCAD - [Drawing.dwg]&quot;

.

.

.

; Methods supported:

; EndUndoMark ()

; Eval (1)

; GetInterfaceObject (1)

; ListAds ()

; ListArx ()

.

.

.

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ename-&gt;vla-object">vlax-ename-&gt;vla-object</h3>

Transforms entity to VLA-object

(vlax-ename-&gt;vla-object entname)

<span class="ArgumentsIdentifier">Arguments</span>

entname

An entity name (ename data type).

<span class="ReturnsIdentifier">Return Values</span>

A VLA-object.

<span class="ExamplesIdentifier">Examples</span>

_$ (setq e (car (entsel)))

&lt;Entity name: 27e0540&gt;

_$ (vlax-ename-&gt;vla-object e)

#&lt;VLA-OBJECT IAcadLWPolyline 03f713a0&gt;

See Also

The <a class="Identifier" href="#vlax-vla-object-&gt;ename">vlax-vla-object-&gt;ename</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-erased-p">vlax-erased-p</h3>

Determines whether an object was erased

(vlax-erased-p obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

<span class="ReturnsIdentifier">Return Values</span>

T if the object was erased, otherwise nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-for">vlax-for</h3>

Iterates through a collection of objects, evaluating each expression

(vlax-for symbol collection [expression1 [expression2 ...]])

<span class="ArgumentsIdentifier">Arguments</span>

symbol

A symbol to be assigned to each VLA-object in a collection.

collection

A VLA-object representing a collection object.

expression1, expression2...

The expressions to be evaluated.

<span class="ReturnsIdentifier">Return Values</span>

The value of the last expression evaluated for the last object in the
collection.

<span class="ExamplesIdentifier">Examples</span>

The following code issues vlax-dump-object on every drawing object in the model
space:

(vl-load-com) ; load ActiveX support

(vlax-for for-item

 (vla-get-modelspace

  (vla-get-activedocument (vlax-get-acad-object))

 )

 (vlax-dump-object for-item) ; list object properties

)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-get-acad-object">vlax-get-acad-object</h3>

Retrieves the top level AutoCAD application object for the current AutoCAD
session

(vlax-get-acad-object)

<span class="ReturnsIdentifier">Return Values</span>

A VLA-object.

<span class="ExamplesIdentifier">Examples</span>

_$ (setq aa (vlax-get-acad-object))

#&lt;VLA-OBJECT IAcadApplication 00b3b91c&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-get-object">vlax-get-object</h3>

Returns a running instance of an application object

(vlax-get-object prog-id)

<span class="ArgumentsIdentifier">Arguments</span>

prog-id

A string that identifies the desired application object. The format of prog-id
is:

appname.objecttype

where appname is the name of the application and objecttype is the application
object. The objecttype may be followed by a version number.

<span class="Todo">Note</span>:  You can usually find the prog-id for an application in that
application's Help. For example, Microsoft(R) Office applications document this
information in the Visual Basic(R) Reference section of their Help.

<span class="ReturnsIdentifier">Return Values</span>

The application object, or nil, if there is no instance of the specified object
currently running.

<span class="ExamplesIdentifier">Examples</span>

Obtain the Application object for the Excel program:

_$ (vlax-get-object &quot;Excel.Application&quot;)

#&lt;VLA-OBJECT _Application 0017bb5c&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-get-or-create-object">vlax-get-or-create-object</h3>

Returns a running instance of an application object, or creates a new instance,
if the application is not currently running

(vlax-get-or-create-object prog-id)

<span class="ArgumentsIdentifier">Arguments</span>

prog-id

A string containing the programmatic identifier of the desired ActiveX object.
The format of prog-id is:

<span class="Special">&lt;Vendor&gt;</span>.<span class="Special">&lt;Component&gt;</span>.<span class="Special">&lt;Version&gt;</span>

For example:

AutoCAD.Drawing.15

<span class="ReturnsIdentifier">Return Values</span>

The object.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-get-or-create-object &quot;Excel.Application&quot;)

#&lt;VLA-OBJECT _Application 0017bb5c&gt;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-get-property">vlax-get-property</h3>

Retrieves a VLA-object's property

(vlax-get-property object property)

This function was formerly known as vlax-get.

<span class="ArgumentsIdentifier">Arguments</span>

object

A VLA-object.

property

A symbol or string naming the property to be retrieved.

<span class="ReturnsIdentifier">Return Values</span>

The value of the object's property.

<span class="ExamplesIdentifier">Examples</span>

Begin by retrieving a pointer to the root AutoCAD object:

_$ (setq acadObject (vlax-get-acad-object))

#&lt;VLA-OBJECT IAcadApplication 00a4b2b4&gt;

Get the AutoCAD ActiveDocument property:

_$ (setq acadDocument (vlax-get-property acadObject
'ActiveDocument))

#&lt;VLA-OBJECT IAcadDocument 00302a18&gt;

The function returns the current document object.

Get the ModelSpace property of the ActiveDocument object:

_$ (setq mSpace (vlax-get-property acadDocument 'Modelspace))

#&lt;VLA-OBJECT IAcadModelSpace 00c14b44&gt;

The model space object of the current document is returned.

Convert a drawing entity to a VLA-object:

_$ (setq vlaobj (vlax-ename-&gt;vla-object e))

#&lt;VLA-OBJECT IAcadLWPolyline 0467114c&gt;

Get the color property of the object:

_$ (vlax-get-property vlaobj 'Color)

256

See Also

The <a class="Identifier" href="#vlax-property-available-p">vlax-property-available-p</a> and <a class="Identifier" href="#vlax-put-property">vlax-put-property</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-import-type-library">vlax-import-type-library</h3>

Imports information from a type library

(vlax-import-type-library :tlb-filename filename [:methods-prefix mprefix
:properties-prefix pprefix :constants-prefix cprefix])

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string naming the type library. A file can be one of the following types:

<span class="Statement">  </span>* A type library (.tlb) or object library (.olb) file
<span class="Statement">  </span>* An executable (.exe) file
<span class="Statement">  </span>* A library (.dll) file containing a type library resource
<span class="Statement">  </span>* A compound document holding a type library
<span class="Statement">  </span>* Any other file format that can be understood by the LoadTypeLib API

If you omit the path from tlb-filename, AutoCAD looks for the file in the
Support File Search Path.

mprefix

Prefix to be used for method wrapper functions. For example, if the type
library contains a Calculate method and the mprefix parameter is set to &quot;cc-&quot;,
Visual LISP generates a wrapper function named cc-Calculate. This parameter
defaults to &quot;&quot;.

pprefix

Prefix to be used for property wrapper functions. For example, if the type
library contains a Width property with both read and write permissions, and
pprefix is set to &quot;cc-&quot;, then Visual LISP generates wrapper functions named
cc-get-Width and cc-put-Width. This parameter defaults to &quot;&quot;.

cprefix

Prefix to be used for constants contained in the type library. For example, if
the type library contains a ccMaxCountOfRecords property with both read and
write permissions, and cprefix is set to &quot;cc-&quot;, Visual LISP generates a
constant named cc-ccMaxCountOfRecords. This parameter defaults to &quot;&quot;.

<span class="Todo">Note</span> the required use of keywords when passing arguments to
vlax-import-type-library.

<span class="ReturnsIdentifier">Return Values</span>

T, if successful.

<span class="ExamplesIdentifier">Examples</span>

Import a Microsoft WordTM type library, assigning the prefix &quot;msw-&quot; to methods
and properties, and &quot;mswc-&quot; to constants:

_$ (vlax-import-type-library

 :tlb-filename &quot;c:/program files/microsoft office/msword8.olb&quot;

 :methods-prefix &quot;msw-&quot;

 :properties-prefix &quot;msw-&quot;

 :constants-prefix &quot;mswc-&quot;)

T

Remarks

Function wrappers created by vlax-import-type-library are available only in the
context of the document vlax-import-type-library was issued from.

In the current release of Visual LISP, vlax-import-type-library is executed at
runtime, rather than at compile-time. In future releases of Visual LISP, this
may change. The following practices are recommended when using
vlax-import-type-library:

<span class="Statement">  </span>* If you want your code to run on different machines, avoid specifying an
    absolute path in the tlb-file-name parameter.

<span class="Statement">  </span>* If possible, avoid using vlax-import-type-library from inside any AutoLISP
    expression (that is, always call it from a top-level position).

<span class="Statement">  </span>* In your AutoLISP source file, code the vlax-import-type-library call before
    any code that uses method or property wrappers or constants defined in the
    type library.

See Also

The <a class="Identifier" href="#vlax-typeinfo-available-p">vlax-typeinfo-available-p</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-invoke-method">vlax-invoke-method</h3>

Calls the specified ActiveX method

(vlax-invoke-method obj method arg [arg...])

This function was known as vlax-invoke prior to AutoCAD 2000.

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

method

A symbol or string naming the method to be called.

arg

Argument to be passed to the method called. No argument type checking is
performed.

<span class="ReturnsIdentifier">Return Values</span>

Depends on the method invoked.

<span class="ExamplesIdentifier">Examples</span>

The following example uses the AddCircle method to draw a circle in the current
AutoCAD drawing.

The first argument to AddCircle specifies the location of the center of the
circle. The method requires the center to be specified as a variant containing
a three-element array of doubles. You can use vlax-3d-point to convert an
AutoLISP point list to the required variant data type:

_$ (setq circCenter (vlax-3d-point '(3.0 3.0 0.0)))

#&lt;variant 8197 ...&gt;

Now use vlax-invoke-method to draw a circle with the AddCircle method:

_$ (setq mycircle (vlax-invoke-method mspace 'AddCircle circCenter
3.0))

#&lt;VLA-OBJECT IAcadCircle 00bfd6e4&gt;

See Also

The <a class="Identifier" href="#vlax-get-property">vlax-get-property</a>, <a class="Identifier" href="#vlax-method-applicable-p">vlax-method-applicable-p</a> ,
<a class="Identifier" href="#vlax-property-available-p">vlax-property-available-p</a>, and <a class="Identifier" href="#vlax-put-property">vlax-put-property</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ldata-delete">vlax-ldata-delete</h3>

Erases LISP data from a drawing dictionary

(vlax-ldata-delete dict key <span class="Special">[private]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

dict

A VLA-object, AutoCAD drawing entity object, or a string naming a global
dictionary.

key

A string specifying the dictionary key.

private

If a non-nil value is specified for private and vlax-ldata-delete is called
from a separate-namespace VLX, vlax-ldata-delete deletes private LISP data from
dict. (See vlax-ldata-get for examples using this argument.)

<span class="ReturnsIdentifier">Return Values</span>

T, if successful, otherwise nil (for example, the data did not exist).

<span class="ExamplesIdentifier">Examples</span>

Add LISP data to a dictionary:

_$ (vlax-ldata-put &quot;dict&quot; &quot;key&quot; '(1))

(1)

Use vlax-ldata-delete to delete the LISP data:

_$ (vlax-ldata-delete &quot;dict&quot; &quot;key&quot;)

T

If vlax-ldata-delete is called again to remove the same data, it returns nil
because the data does not exist in the dictionary:

_$ (vlax-ldata-delete &quot;dict&quot; &quot;key&quot;)

nil

See Also

The <a class="Identifier" href="#vlax-ldata-get">vlax-ldata-get</a>, and <a class="Identifier" href="#vlax-ldata-put">vlax-ldata-put</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ldata-get">vlax-ldata-get</h3>

Retrieves LISP data from a drawing dictionary or an object

(vlax-ldata-get dict key <span class="Special">[default-data]</span> <span class="Special">[private]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

dict

A VLA-object, AutoCAD drawing entity object, or a string naming a global
dictionary.

key

A string specifying the dictionary key.

default-data

LISP data to be returned if no matching key exists in the dictionary.

private

If a non-nil value is specified for private and vlax-ldata-get is called from a
separate-namespace VLX, vlax-ldata-get retrieves private LISP data from dict.

If you specify private, you must also specify default-data; you can use nil for
default-data.

<span class="Todo">Note</span> that a separate-namespace VLX can store both private and non-private data
using the same dict and key. The private data can only be accessed by the same
VLX, but any application can retrieve the non-private data.

<span class="ReturnsIdentifier">Return Values</span>

The value of the key item.

<span class="ExamplesIdentifier">Examples</span>

Enter the following commands at the Visual LISP Console window:

_$ (vlax-ldata-put &quot;mydict&quot; &quot;mykey&quot; &quot;Mumbo Dumbo&quot;)

&quot;Mumbo Dumbo&quot;

_$ (vlax-ldata-get &quot;mydict&quot; &quot;mykey&quot;)

&quot;Mumbo Dumbo&quot;

To test the use of private data from a VLX

<span class="Statement">  </span>* Enter the following commands at the Visual LISP Console window:

_$ (vlax-ldata-put &quot;mydict&quot; &quot;mykey&quot; &quot;Mumbo Dumbo&quot;)

&quot;Mumbo Dumbo&quot;

_$ (vlax-ldata-get &quot;mydict&quot; &quot;mykey&quot;)

&quot;Mumbo Dumbo&quot;
<span class="Statement">  </span>* Enter the following code in a file and use Make Application to build a VLX
    from the file. Use the Expert mode of the Make Application Wizard, and
    select the Separate Namespace option in the Compile Options tab.

(vl-doc-export 'ldataput)

(vl-doc-export 'ldataget)

(vl-doc-export 'ldataget-nilt)

(defun ldataput ()

 (princ &quot;This is a test of putting private ldata &quot;)

 (vlax-ldata-put &quot;mydict&quot; &quot;mykey&quot; &quot;Mine! Mine! &quot; T)

)

(defun ldataget ()

 (vlax-ldata-get &quot;mydict&quot; &quot;mykey&quot;)

)

(defun ldataget-nilt ()

 (vlax-ldata-get &quot;mydict&quot; &quot;mykey&quot; nil T)

)
<span class="Statement">  </span>* Load the VLX file.
<span class="Statement">  </span>* Run ldataput to save private data:

_$ (ldataput)

This is a test of putting private ldata

Refer back to the code defining ldataput: this function stores a string
containing &quot;Mine! Mine!&quot;

<span class="Statement">  </span>* Run ldataget to retrieve LISP data:

_$ (ldataget)

&quot;Mumbo Dumbo&quot;

Notice that the data returned by ldataget is not the data stored by ldataput.
This is because ldataget does not specify the private argument in its call to
vlax-ldata-get. So the data retrieved byldataget is the data set by issuing
vlax-ldata-put from the Visual LISP Console in step 1.

_$ (ldataget-nilt)

&quot;Mine! Mine! &quot;
<span class="Statement">  </span>* Run ldataget-nilt to retrieve LISP data:

_$ (ldataget-nilt)

&quot;Mine! Mine! &quot;

This time the private data saved by ldataput is returned, because ldataget-nilt
specifies the private argument in its call to vlax-ldata-get.

<span class="Statement">  </span>* From the Visual LISP Console prompt, issue the same call that ldataget-nilt
    uses to retrieve private data:

_$ (vlax-ldata-get &quot;mydict&quot; &quot;mykey&quot; nil T)

&quot;Mumbo Dumbo&quot;

The private argument is ignored when vlax-ldata-get is issued outside of a
separate-namespace VLX. If non-private data exists for the specified dict and
key (as in this instance), that data will be retrieved.

See Also

The <a class="Identifier" href="#vlax-ldata-put">vlax-ldata-put</a>, and <a class="Identifier" href="#vlax-ldata-list">vlax-ldata-list</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ldata-list">vlax-ldata-list</h3>

Lists LISP data in a drawing dictionary

(vlax-ldata-list dict <span class="Special">[private]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

dict

A VLA-object, AutoCAD drawing entity object, or a string naming a global
dictionary.

private

If vlax-ldata-list is called from a separate-namespace VLX and a non-nil value
is specified for private, vlax-ldata-list retrieves only private data stored by
the same VLX. (See vlax-ldata-get for examples using this argument.)

<span class="ReturnsIdentifier">Return Values</span>

An associative list consisting of pairs (key . value).

<span class="ExamplesIdentifier">Examples</span>

Use vlax-ldata-put to store LISP data in a dictionary:

_$ (vlax-ldata-put &quot;dict&quot; &quot;cay&quot; &quot;Mumbo Jumbo &quot;)

&quot;Mumbo Jumbo &quot;

_$ (vlax-ldata-put &quot;dict&quot; &quot;say&quot; &quot;Floobar &quot;)

&quot;Floobar &quot;

Use vlax-ldata-list to display the LISP data stored in &quot;dict&quot;:

_$ (vlax-ldata-list &quot;dict&quot;)

((&quot;say&quot; . &quot;Floobar &quot;) (&quot;cay&quot; . &quot;Mumbo Jumbo &quot;))

See Also

The <a class="Identifier" href="#vlax-ldata-get">vlax-ldata-get</a>, and <a class="Identifier" href="#vlax-ldata-put">vlax-ldata-put</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ldata-put">vlax-ldata-put</h3>

Stores LISP data in a drawing dictionary or an object

(vlax-ldata-put dict key data <span class="Special">[private]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

dict

A VLA-object, AutoCAD drawing entity object, or a string naming a global
dictionary.

key

A string specifying the dictionary key.

data

LISP data to be stored in the dictionary.

private

If vlax-ldata-put is called from a separate-namespace VLX and a non-nil value
is specified for private, vlax-ldata-put marks the data as retrievable only by
the same VLX.

<span class="ReturnsIdentifier">Return Values</span>

The value of data.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-ldata-put &quot;dict&quot; &quot;key&quot; '(1))

(1)

_$ (vlax-ldata-put &quot;dict&quot; &quot;cay&quot; &quot;Gumbo jumbo&quot;)

&quot;Gumbo jumbo&quot;

See Also

The <a class="Identifier" href="#vlax-ldata-get">vlax-ldata-get</a>, and <a class="Identifier" href="#vlax-ldata-list">vlax-ldata-list</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-ldata-test">vlax-ldata-test</h3>

Determines if data can be saved over a session boundary

(vlax-ldata-test data)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any LISP data to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T, if the data can be saved and restored over the session boundary, nil
otherwise.

<span class="ExamplesIdentifier">Examples</span>

Determine if a string can be saved as ldata over a session boundary:

_$ (vlax-ldata-test &quot;Gumbo jumbo&quot;)

T

Determine if a function can be saved as ldata over a session boundary:

_$ (vlax-ldata-test yinyang)

nil

See Also

The <a class="Identifier" href="#vlax-ldata-get">vlax-ldata-get</a>, and <a class="Identifier" href="#vlax-ldata-list">vlax-ldata-list</a>, and
<a class="Identifier" href="#vlax-ldata-put">vlax-ldata-put</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-make-safearray">vlax-make-safearray</h3>

Creates a safearray

(vlax-make-safearray type '(l-bound . u-bound) ['(l-bound . u-bound)...)]

A maximum of 16 dimensions can be defined for an array. The elements in the
array are initialized as follows:

Numbers

0

Strings

Zero-length string.

Booleans

:vlax-false

Object

nil

Variant

Uninitialized (vlax-vbEmpty)

<span class="ArgumentsIdentifier">Arguments</span>

type

The type of safearray. Specify one of the following constants:

vlax-vbInteger (2) Integer

vlax-vbLong (3) Long integer

vlax-vbSingle (4) Single-precision floating-point number

vlax-vbDouble (5) Double-precision floating-point number

vlax-vbString (8) String

vlax-vbObject (9) Object

vlax-vbBoolean (11) Boolean

vlax-vbVariant (12) Variant

The integer shown in parentheses indicates the value to which the constant
evaluates. It is recommended that you specify the constant in your argument,
not the integer value, in case the value changes in later releases of AutoCAD.

'(l-bound . u-bound)

Lower and upper index boundaries of a dimension.

<span class="ReturnsIdentifier">Return Values</span>

The safearray created.

<span class="ExamplesIdentifier">Examples</span>

Create a single-dimension safearray consisting of doubles, beginning with index
0:

_$ (setq point (vlax-make-safearray vlax-vbDouble '(0 . 3)))

#&lt;safearray...&gt;

Use the vlax-safearray-&gt;list function to display the contents of the safearray
as a list:

_$ (vlax-safearray-&gt;list point)

(0.0 0.0 0.0 0.0)

The result shows each element of the array was initialized to zero.

Create a two-dimension array of strings, with each dimension starting at index
1:

_$ (setq matrix (vlax-make-safearray vlax-vbString '(1 . 2) '(1 .
2) ))

#&lt;safearray...&gt;

See Also

The <a class="Identifier" href="#vlax-make-variant">vlax-make-variant</a>, <a class="Identifier" href="#vlax-safearray-get-dim">vlax-safearray-get-dim</a>, <a class="Identifier" href="#vlax-safearray-get-element">vlax-safearray-get-element</a>, <a class="Identifier" href="#vlax-safearray-get-l-bound">vlax-safearray-get-l-bound</a>,
<a class="Identifier" href="#vlax-safearray-get-u-bound">vlax-safearray-get-u-bound</a>, <a class="Identifier" href="#vlax-safearray-put-element">vlax-safearray-put-element</a>, <a class="Identifier" href="#vlax-safearray-type">vlax-safearray-type</a>, and <a class="Identifier" href="#vlax-variant-value">vlax-variant-value</a>
functions. For more information on using these functions, see Working with Safearrays in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-make-variant">vlax-make-variant</h3>

Creates a variant data type

(vlax-make-variant <span class="Special">[value]</span> <span class="Special">[type]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

value

The value to be assigned to the variant. If omitted, the variant is created
with the vlax-vbEmpty type (uninitialized).

type

The type of variant. This can be represented by one of the following constants:

vlax-vbEmpty (0) Uninitialized (default value)

vlax-vbNull (1) Contains no valid data

vlax-vbInteger (2) Integer

vlax-vbLong (3) Long integer

vlax-vbSingle (4) Single-precision floating-point number

vlax-vbDouble (5) Double-precision floating-point number

vlax-vbString (8) String

vlax-vbObject (9) Object

vlax-vbBoolean (11) Boolean

vlax-vbArray (8192) Array

The integer shown in parentheses indicates the value to which the constant
evaluates. It is recommended that you specify the constant in your argument,
not the integer value, because the value may change in later releases of
AutoCAD.

If you do not specify a type, vlax-make-variant assigns a default data type
based on the data type of the value it receives. The following list identifies
the default variant data type assigned to each LISP data type:

nil vlax-vbEmpty

:vlax-null vlax-vbNull

integer vlax-vbLong

real vlax-vbDouble

string vlax-vbString

VLA-object vlax-vbObject

:vlax-true, :vlax-false vlax-vbBoolean

variant Same as the type of initial value

vlax-make-safearray vlax-vbArray

<span class="ReturnsIdentifier">Return Values</span>

The variant created.

<span class="ExamplesIdentifier">Examples</span>

Create a variant using the defaults for vlax-make-variant:

_$ (setq varnil (vlax-make-variant))

#&lt;variant 0<span class="Ignore"> &gt;</span>

The function creates an uninitialized (vlax-vbEmpty) variant by default. You
can accomplish the same thing explicitly with the following call:

_$ (setq varnil (vlax-make-variant nil))

#&lt;variant 0<span class="Ignore"> &gt;</span>

Create an integer variant and set its value to 5:

_$ (setq varint (vlax-make-variant 5 vlax-vbInteger))

#&lt;variant 2 5&gt;

Repeat the previous command, but omit the type argument and see what happens:

_$ (setq varint (vlax-make-variant 5))

#&lt;variant 3 5&gt;

By default, vlax-make-variant assigned the specified integer value to a Long
integer data type, not Integer, as you might expect. This highlights the
importance of explicitly stating the type of variant you want when working with
numbers.

Omitting the type argument for a string produces predictable results:

_$ (setq varstr (vlax-make-variant &quot;ghost&quot;))

#&lt;variant 8 ghost&gt;

To create a variant containing arrays, you must specify type vlax-vbArray,
along with the type of data in the array. For example, to create a variant
containing an array of doubles, first set a variable's value to an array of
doubles:

_$ (setq 4dubs (vlax-make-safearray vlax-vbDouble '(0 . 3)))

#&lt;safearray...&gt;

Then take the array of doubles and assign it to a variant:

_$ (vlax-make-variant 4dubs)

#&lt;variant 8197 ...&gt;

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-variant-type</a> ,
and <a class="Identifier" href="#vlax-variant-value">vlax-variant-value</a> functions. For more information on using variants, see
Working with Variants in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-map-collection">vlax-map-collection</h3>

Applies a function to all objects in a collection

(vlax-map-collection obj function)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object representing a collection.

function

A symbol or lambda expression to be applied to obj.

<span class="ReturnsIdentifier">Return Values</span>

The obj first argument.

<span class="ExamplesIdentifier">Examples</span>

(vlax-map-collection (vla-get-ModelSpace acadDocument) 'vlax-dump-
object)

; IAcadLWPolyline: AutoCAD Lightweight Polyline Interface

; Property values:

; Application (RO) = #&lt;VLA-OBJECT IAcadApplication 00a4ae24&gt;

; Area (RO) = 2.46556

; Closed = 0

; Color = 256

; ConstantWidth = 0.0

; Coordinate = ...Indexed contents not shown...

; Coordinates = (8.49917 7.00155 11.2996 3.73137 14.8 5.74379 ... )

; Database (RO) = #&lt;VLA-OBJECT IAcadDatabase 01e3da44&gt;

; Elevation = 0.0

; Handle (RO) = &quot;53&quot;

; HasExtensionDictionary (RO) = 0

; Hyperlinks (RO) = #&lt;VLA-OBJECT IAcadHyperlinks 01e3d7d4&gt;

; Layer = &quot;0&quot;

; Linetype = &quot;BYLAYER&quot;

; LinetypeGeneration = 0

; LinetypeScale = 1.0

; Lineweight = -1

; Normal = (0.0 0.0 1.0)

; ObjectID (RO) = 28895576

; ObjectName (RO) = &quot;AcDbPolyline&quot;

; PlotStyleName = &quot;ByLayer&quot;

; Thickness = 0.0

; Visible = -1

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-method-applicable-p">vlax-method-applicable-p</h3>

Determines if an object supports a particular method

(vlax-method-applicable-p obj method)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

method

A symbol or string containing the name of the method to be checked.

<span class="ReturnsIdentifier">Return Values</span>

T, if the object supports the method, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

The following commands are issued against a LightweightPolyline object:

_$ (vlax-method-applicable-p WhatsMyLine 'copy)

T

_$ (vlax-method-applicable-p WhatsMyLine 'AddBox)

nil

See Also

The <a class="Identifier" href="#vlax-property-available-p">vlax-property-available-p</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-object-released-p">vlax-object-released-p</h3>

Determines if an object has been released

(vlax-object-released-p obj)

<span class="Todo">Note</span>:  Erasing a VLA-object (using command ERASE or vla-erase) does not release
the object. A VLA-object is not released until you either invoke
vlax-release-object on the object, normal AutoLISP garbage collection occurs,
or the drawing database is destroyed at the end of the drawing session.

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

<span class="ReturnsIdentifier">Return Values</span>

T, if the object is released (no AutoCAD drawing object is attached to obj),
nil, if the object has not been released.

<span class="ExamplesIdentifier">Examples</span>

Attach an Excel application to the current AutoCAD drawing:

_$ (setq excelobj (vlax-get-object &quot;Excel.Application&quot;))

#&lt;VLA-OBJECT _Application 00168a54&gt;

Release the Excel object:

_$ (vlax-release-object excelobj)

1

Issue vlax-object-released-p to verify the object was released:

_$ (vlax-object-released-p excelobj)

T

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-product-key">vlax-product-key</h3>

Returns the AutoCAD Window registry path

(vlax-product-key)

The AutoCAD registry path can be used to register an application for demand
loading.

<span class="ReturnsIdentifier">Return Values</span>

A string containing the AutoCAD registry path.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-product-key)

&quot;Software\\Autodesk\\AutoCAD\\R15.0\\ACAD-1:409&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-property-available-p">vlax-property-available-p</h3>

Determines if an object has a specified property

(vlax-property-available-p obj prop <span class="Special">[check-modify]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

property

A symbol or string naming the property to be checked.

check-modify

If T is specified for this argument, vlax-property-available-p also checks that
the property can be modified.

<span class="ReturnsIdentifier">Return Values</span>

T, if the object has the specified property, otherwise nil. If T is specified
for the check-modify argument, vlax-property-available-p returns nil if either
the property is not available or the property cannot be modified.

<span class="ExamplesIdentifier">Examples</span>

The following examples apply to a LightweightPolyline object:

_$ (vlax-property-available-p WhatsMyLine 'Color)

T

_$ (vlax-property-available-p WhatsMyLine 'center)

nil

The following examples apply to a Circle object:

_$ (vlax-property-available-p myCircle 'area)

T

<span class="Todo">Note</span> how supplying the optional third argument changes the result:

_$ (vlax-property-available-p myCircle 'area T)

nil

The function returns nil because, although the circle has an &quot;area&quot; property,
that property cannot be modified.

See Also

The <a class="Identifier" href="#vlax-method-applicable-p</span> and  and <span class="Identifier">vlax-put-property</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-put-property">vlax-put-property</h3>

Set the property of an ActiveX object

(vlax-put-property obj property arg)

This function was formerly known as vlax-put.

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

property

A symbol or string naming the property to be set.

arg

The value to be set.

<span class="ReturnsIdentifier">Return Values</span>

Nil, if successful.

<span class="ExamplesIdentifier">Examples</span>

Color an object red:

_$ (vlax-put-property vlaobj 'Color 1)

nil

See Also

The <a class="Identifier" href="#vlax-get-property</span> and  and <span class="Identifier">vlax-property-available-p</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-read-enabled-p">vlax-read-enabled-p</h3>

Determines if an object can be read

(vlax-read-enabled-p obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

<span class="ReturnsIdentifier">Return Values</span>

T, if the object is readable, otherwise nil.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-release-object">vlax-release-object</h3>

Releases a drawing object

(vlax-release-object obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

After release, the drawing object is no longer accessible through obj.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-remove-cmd">vlax-remove-cmd</h3>

Removes a single command or a command group

(vlax-remove-cmd global-name)

Removes a single command or the whole command group for the current AutoCAD
session.

<span class="ArgumentsIdentifier">Arguments</span>

global-name

Either a string naming the command, or T. If global-name is T, the whole
command group VLC-AppName (for example, VLC-VLIDE) is deleted.

<span class="ReturnsIdentifier">Return Values</span>

T, if successful, nil otherwise (for example, the command is not defined).

<span class="ExamplesIdentifier">Examples</span>

Remove a command defined with vlax-add-cmd:

_$ (vlax-remove-cmd &quot;hello-autocad&quot;)

T

Repeat the vlax-remove-cmd:

_$ (vlax-remove-cmd &quot;hello-autocad&quot;)

nil

This time vlax-remove-cmd returns nil, because the specified command does not
exist anymore.

See Also

The <a class="Identifier" href="#vlax-add-cmd">vlax-add-cmd</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-safearray-fill">vlax-safearray-fill</h3>

Stores data in the elements of a safearray

(vlax-safearray-fill var 'element-values)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

'element-values

A list of values to be stored in the array. You can specify as many values as
there are elements in the array. If you specify fewer values than there are
elements, the remaining elements retain their current value.

For multi-dimension arrays, element-values must be a list of lists, with each
list corresponding to a dimension of the array.

<span class="ReturnsIdentifier">Return Values</span>

var

<span class="ExamplesIdentifier">Examples</span>

Create a single-dimension array of doubles:

_$ (setq sa (vlax-make-safearray vlax-vbdouble '(0 . 2)))

#&lt;safearray...&gt;

Use vlax-safearray-fill to populate the array:

_$ (vlax-safearray-fill sa '(1 2 3))

#&lt;safearray...&gt;

List the contents of the array:

_$ (vlax-safearray-&gt;list sa)

(1.0 2.0 3.0)

Use vlax-safearray-fill to set the first element in the array:

_$ (vlax-safearray-fill sa '(-66))

#&lt;safearray...&gt;

List the contents of the array:

_$ (vlax-safearray-&gt;list sa)

(-66.0 2.0 3.0)

Notice that only the first element in the array has been changed; the remaining
elements are unaffected and retain the value you previously set them to. If you
need to change the second or third elements and leave the first element
unaffected, use vlax-put-element.

Instruct vlax-safearray-fill to set four elements in an array that contains
only three elements:

_$ (vlax-safearray-fill sa '(1 2 3 4))

Error: Assertion failed: safearray-fill failed. Too many elements.

The vlax-safearray-fill function returns an error if you specify more elements
than the array contains.

To assign values to a multi-dimensional array, specify a list of lists to
vlax-safearray-fill, with each list corresponding to a dimension. The following
command creates a two-dimension array of strings containing three elements in
each dimension:

_$ (setq mat2 (vlax-make-safearray vlax-vbString '(0 . 1) '(1 . 3)))

#&lt;safearray...&gt;

Use vlax-safearray-fill to populate the array:

_$ (vlax-safearray-fill mat2 '((&quot;a&quot; &quot;b&quot; &quot;c&quot;) (&quot;d&quot; &quot;e&quot; &quot;f&quot;)))

#&lt;safearray...&gt;

Call the vlax-safearray-&gt;list function to confirm the contents of mat2:

_$ (vlax-safearray-&gt;list mat2)

((&quot;a&quot; &quot;b&quot; &quot;c&quot;) (&quot;d&quot; &quot;e&quot; &quot;f&quot;))

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-get-dim</a> ,
<a class="Identifier" href="#vlax-safearray-get-element</span> ,  , <span class="Identifier">vlax-safearray-get-l-bound</a> ,
<a class="Identifier" href="#vlax-safearray-get-u-bound</span> ,  , <span class="Identifier">vlax-safearray-put-element</a> ,
<a class="Identifier" href="#vlax-safearray-type</span> ,  , and <span class="Identifier">vlax-variant-value</a>
functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-get-dim">vlax-safearray-get-dim</h3>

Returns the number of dimensions in a safearray object

(vlax-safearray-get-dim var)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

<span class="ReturnsIdentifier">Return Values</span>

An integer identifying the number of dimensions in var. An error occurs if var
is not a safearray.

<span class="ExamplesIdentifier">Examples</span>

Set sa-int to a single-dimension safearray with one dimension:

_$ (setq sa-int (vlax-make-safearray vlax-vbinteger '(1 . 4)))

#&lt;safearray...&gt;

Use vlax-safearray-get-dim to return the number of dimensions in sa-int:

_$ (vlax-safearray-get-dim sa-int)

1

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-get-l-bound</a> , and
<a class="Identifier" href="#vlax-safearray-get-u-bound">vlax-safearray-get-u-bound</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-get-element">vlax-safearray-get-element</h3>

Returns an element from an array

(vlax-safearray-get-element var element...)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

element...

Integers specifying the indexes of the element to be retrieved. For an array
with one dimension, specify a single integer. For multi-dimension arrays,
specify as many indexes as there are dimensions.

<span class="ReturnsIdentifier">Return Values</span>

The value of the element.

<span class="ExamplesIdentifier">Examples</span>

Create an array with two dimensions, each dimension starting at index 1:

_$ (setq matrix (vlax-make-safearray vlax-vbString '(1 . 2) '(1 .
2) ))

#&lt;safearray...&gt;

Use vlax-safearray-put-element to populate the array:

_$ (vlax-safearray-put-element matrix 1 1 &quot;a&quot;)

&quot;a&quot;

_$ (vlax-safearray-put-element matrix 1 2 &quot;b&quot;)

&quot;b&quot;

_$ (vlax-safearray-put-element matrix 2 1 &quot;c&quot;)

&quot;c&quot;

_$ (vlax-safearray-put-element matrix 2 2 &quot;d&quot;)

&quot;d&quot;

Use vlax-safearray-get-element to retrieve the second element in the first
dimension of the array:

_$ (vlax-safearray-get-element matrix 1 2)

&quot;b&quot;

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-get-dim</a> ,
<a class="Identifier" href="#vlax-safearray-get-l-bound</span> ,  , <span class="Identifier">vlax-safearray-get-u-bound</a> , and
<a class="Identifier" href="#vlax-safearray-put-element">vlax-safearray-put-element</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-get-l-bound">vlax-safearray-get-l-bound</h3>

Returns the lower boundary (starting index) of a dimension of an array

(vlax-safearray-get-l-bound var dim)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

dim

A dimension of the array. The first dimension is dimension 1.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the lower boundary (starting index) of the dimension.
If var is not an array, or dim is invalid (for example, 0, or a number greater
than the number of dimensions in the array), an error results.

<span class="ExamplesIdentifier">Examples</span>

The following examples evaluate a safearray defined as follows:

(vlax-make-safearray vlax-vbString '(1 . 2) '(0 . 1) ))

Get the starting index value of the array's first dimension:

_$ (vlax-safearray-get-l-bound tmatrix 1)

1

The first dimension starts with index 1.

Get the starting index value of the second dimension of the array:

_$ (vlax-safearray-get-l-bound tmatrix 2)

0

The second dimension starts with index 0.

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-get-dim</a> , and
<a class="Identifier" href="#vlax-safearray-get-u-bound">vlax-safearray-get-u-bound</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-get-u-bound">vlax-safearray-get-u-bound</h3>

Returns the upper boundary (end index) of a dimension of an array

(vlax-safearray-get-u-bound var dim)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

dim

A dimension of the array. The first dimension is dimension 1.

<span class="ReturnsIdentifier">Return Values</span>

An integer representing the upper boundary (end index) of the dimension. If var
is not an array, or dim is invalid (for example, 0, or a number greater than
the number of dimensions in the array), an error results.

<span class="ExamplesIdentifier">Examples</span>

The following examples evaluate a safearray defined as follows:

(vlax-make-safearray vlax-vbString '(1 . 2) '(0 . 1) ))

Get the end index value of the array's first dimension:

_$ (vlax-safearray-get-u-bound tmatrix 1)

2

The first dimension ends with index 2.

Get the end index value of the second dimension of the array:

_$ (vlax-safearray-get-u-bound tmatrix 2)

1

The second dimension starts with index 1.

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-get-dim</a> , and
<a class="Identifier" href="#vlax-safearray-get-l-bound">vlax-safearray-get-l-bound</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-put-element">vlax-safearray-put-element</h3>

Adds an element to an array

(vlax-safearray-put-element var index... value)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose data type is a safearray.

index...

A set of index values pointing to the element you are assigning a value to. For
a single-dimension array, specify one index value; for a two-dimension array,
specify two index values, and so on.

value

The value to assign the safearray element.

<span class="ReturnsIdentifier">Return Values</span>

The value assigned to the element.

<span class="ExamplesIdentifier">Examples</span>

Create a single-dimension array consisting of doubles:

_$ (setq point (vlax-make-safearray vlax-vbDouble '(0 . 2)))

#&lt;safearray...&gt;

Use vlax-safearray-put-element to populate the array:

_$ (vlax-safearray-put-element point 0 100)

100

_$ (vlax-safearray-put-element point 1 100)

100

_$ (vlax-safearray-put-element point 2 0)

0

Create a two-dimension array consisting of strings:

_$ (setq matrix (vlax-make-safearray vlax-vbString '(1 . 2) '(1 .
2) ))

#&lt;safearray...&gt;

Use vlax-safearray-put-element to populate the array:

_$ (vlax-safearray-put-element matrix 1 1 &quot;a&quot;)

&quot;a&quot;

_$ (vlax-safearray-put-element matrix 1 2 &quot;b&quot;)

&quot;b&quot;

_$ (vlax-safearray-put-element matrix 2 1 &quot;c&quot;)

&quot;c&quot;

_$ (vlax-safearray-put-element matrix 2 2 &quot;d&quot;)

&quot;d&quot;

<span class="Todo">Note</span> that you can also populate arrays using the vlax-safearray-fill function.
The following function call accomplishes the same task as three
vlax-safearray-put-element calls:

(vlax-safearray-fill matrix '((&quot;a&quot; &quot;b&quot;) (&quot;c&quot; &quot;d&quot;)))

See Also

The <a class="Identifier" href="#vlax-safearray-get-element</span> ,  , <span class="Identifier">vlax-safearray-fill</a> , and
<a class="Identifier" href="#vlax-safearray-type">vlax-safearray-type</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-safearray-type">vlax-safearray-type</h3>

Returns the data type of a safearray

(vlax-safearray-type var)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable containing a safearray.

<span class="ReturnsIdentifier">Return Values</span>

If var contains a safearray, one of the following integers is returned:

2

Integer (vlax-vbInteger)

3

Long integer (vlax-vbLong)

4

Single-precision floating-point number (vlax-vbSingle)

5

Double-precision floating-point number (vlax-vbDouble)

8

String (vlax-vbString)

9

Object (vlax-vbObject)

11

Boolean (vlax-vbBoolean)

12

Variant (vlax-vbVariant)

If var does not contain a safearray, an error results.

<span class="ExamplesIdentifier">Examples</span>

Create a single-dimension array of doubles and a two-dimension array of
strings:

_$ (setq point (vlax-make-safearray vlax-vbDouble '(0 . 2)))

#&lt;safearray...&gt;

_$ (setq matrix (vlax-make-safearray vlax-vbString '(1 . 2) '(1 .
2) ))

#&lt;safearray...&gt;

Use vlax-safearray-type to verify the data type of the safearrays:

_$ (vlax-safearray-type point)

5

_$ (vlax-safearray-type matrix)

8

See Also

The <a class="Identifier" href="#vlax-make-safearray">vlax-make-safearray</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-safearray-&gt;list">vlax-safearray-&gt;list</h3>

Returns the elements of a safearray in list form

(vlax-safearray-&gt;list var)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable containing a safearray.

<span class="ReturnsIdentifier">Return Values</span>

A list.

<span class="ExamplesIdentifier">Examples</span>

Create a single-dimension array of doubles:

_$ (setq point (vlax-make-safearray vlax-vbDouble '(0 . 2)))

#&lt;safearray...&gt;

Use vlax-safearray-put-element to populate the array:

_$ (vlax-safearray-put-element point 0 100)

100

_$ (vlax-safearray-put-element point 1 100)

100

_$ (vlax-safearray-put-element point 2 0)

0

Convert the array to a list:

_$ (setq pointlist (vlax-safearray-&gt;list point))

(100.0 100.0 0.0)

The following example demonstrates how a two-dimension array of strings is
displayed by vlax-safearray-&gt;list:

_$ (vlax-safearray-&gt;list matrix)

((&quot;a&quot; &quot;b&quot;) (&quot;c&quot; &quot;d&quot;))

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-safearray-fill</a> , and
<a class="Identifier" href="#vlax-safearray-put-element">vlax-safearray-put-element</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-tmatrix">vlax-tmatrix</h3>

Returns a suitable representation for a 4 x 4 transformation matrix to be used
in VLA methods

(vlax-tmatrix list)

<span class="ArgumentsIdentifier">Arguments</span>

list

A list of four lists, each containing four numbers, representing transformation
matrix elements.

<span class="ReturnsIdentifier">Return Values</span>

A variant of type safearray, representing the 4 x 4 transformation matrix.

<span class="ExamplesIdentifier">Examples</span>

Define a transformation matrix and assign its value to variable tmatrix:

_$ (setq tmatrix (vlax-tmatrix '((1 1 1 0) (1 2 3 0) (2 3 4 5) (2 9
8 3))))

#&lt;variant 8197 ...&gt;

Use vlax-safearray-&gt;list to view the value of tmatrix in list form:

_$ (vlax-safearray-&gt;list (vlax-variant-value tmatrix))

((1.0 1.0 1.0 0.0) (1.0 2.0 3.0 0.0) (2.0 3.0 4.0 5.0) (2.0 9.0 8.0
3.0))

The following code example creates a line and rotates it 90 degrees using a
transformation matrix:

(defun Example_TransformBy () ; / lineObj startPt endPt matList
transMat)

(vl-load-com) ; Load ActiveX support

(setq acadObject (vlax-get-acad-object))

(setq acadDocument (vla-get-ActiveDocument acadObject))

(setq mSpace (vla-get-ModelSpace acadDocument))

;; Create a line

 (setq startPt (getpoint &quot;Pick the start point&quot;))

 (setq endPt (vlax-3d-point (getpoint startPt &quot;Pick the end
point&quot;)))

 (setq lineObj (vla-addline mSpace (vlax-3d-point startPt) endPt))

;;; Initialize the transMat variable with a transformation matrix

;;; that will rotate an object by 90 degrees about the point(0,0,0).

;;; Begin by Creating a list of four lists, each containing four

;;; numbers, representing transformation matrix elements.

 (setq matList (list '(0 -1 0 0) '(1 0 0 0) '(0 0 1 0) '(0 0 0 1)))

;;; Use vlax-tmatrix to convert the list to a variant.

 (setq transmat (vlax-tmatrix matlist))

;;; Transform the line using the defined transformation matrix

 (vla-transformby lineObj transMat)

 (vla-zoomall acadObject)

 (princ &quot;The line is transformed &quot;)

 (princ)

)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-typeinfo-available-p">vlax-typeinfo-available-p</h3>

Determines whether TypeLib information is present for the specified type of
object

Visual LISP requires TypeLib information to determine whether a method or
property is available for an object. Some objects may not have TypeLib
information (for example, AcadDocument).

(vlax-typeinfo-available-p obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

<span class="ReturnsIdentifier">Return Values</span>

T, if TypeLib information is available, otherwise nil.

See Also

The <a class="Identifier" href="#vlax-import-type-library">vlax-import-type-library</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-variant-change-type">vlax-variant-change-type</h3>

Returns the value of a variant after changing it from one data type to another

(vlax-variant-change-type var type)

The vlax-variant-change-type function returns the value of the specified
variable after converting that value to the specified variant type.

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose value is a variant.

type

The type of variant to return, using the value of var (the value of var is
unchanged). The type value can be represented by one of the following
constants:

vlax-vbEmpty (0) Uninitialized

vlax-vbNull (1) Contains no valid data

vlax-vbInteger (2) Integer

vlax-vbLong (3) Long integer

vlax-vbSingle (4) Single-precision floating-point number

vlax-vbDouble (5) Double-precision floating-point number

vlax-vbString (8) String

vlax-vbObject (9) Object

vlax-vbBoolean (11) Boolean

vlax-vbArray (8192) Array

The integer shown in parentheses indicates the value to which the constant
evaluates. It is recommended that you specify the constant in your argument,
not the integer value, in case the value changes in later releases of AutoCAD.

<span class="ReturnsIdentifier">Return Values</span>

The value of var, after converting it to the specified variant type, or nil, if
var could not be converted to the specified type.

<span class="ExamplesIdentifier">Examples</span>

Set a variable named varint to a variant value:

_$ (setq varint (vlax-make-variant 5))

#&lt;variant 3 5&gt;

Set a variable named varintstr to the value contained in varint, but convert
that value to a string:

_$ (setq varintStr (vlax-variant-change-type varint vlax-vbstring))

#&lt;variant 8 5&gt;

Check the value of varintstr:

_$ (vlax-variant-value varintStr)

&quot;5&quot;

This confirms that varintstr contains a string.

See Also

The <a class="Identifier" href="#vlax-variant-type</span> and  and <span class="Identifier">vlax-variant-value</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-variant-type">vlax-variant-type</h3>

Determines the data type of a variant

(vlax-variant-type var)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose value is a variant.

<span class="ReturnsIdentifier">Return Values</span>

If var contains a variant, one of the following integers is returned:

0

Uninitialized (vlax-vbEmpty)

1

Contains no valid data (vlax-vbNull)

2

Integer (vlax-vbInteger)

3

Long integer (vlax-vbLong)

4

Single-precision floating-point number (vlax-vbSingle)

5

Double-precision floating-point number (vlax-vbDouble)

8

String (vlax-vbString)

9

Object (vlax-vbObject)

11

Boolean (vlax-vbBoolean)

8192 + n

Safearray (vlax-vbArray) of some data type. For example, an array of doubles
(vlax-vbDouble) returns 8197 (8192 + 5).

If var does not contain a variant, an error results.

<span class="ExamplesIdentifier">Examples</span>

Set a variant to nil and display the variant's data type:

_$ (setq varnil (vlax-make-variant nil))

#&lt;variant 0<span class="Ignore"> &gt;</span>

_$ (vlax-variant-type varnil)

0

Set a variant to an integer value and explicitly define the variant as an
integer data type:

_$ (setq varint (vlax-make-variant 5 vlax-vbInteger))

#&lt;variant 2 5&gt;

_$ (vlax-variant-type varint)

2

Set a variant to an integer value and display the variant's data type:

_$ (setq varint (vlax-make-variant 5))

#&lt;variant 3 5&gt;

_$ (vlax-variant-type varint)

3

Notice that without explicitly defining the data type to vlax-make-variant, an
integer assignment results in a Long integer data type.

Set a variant to a string and display the variant's data type:

_$ (setq varstr (vlax-make-variant &quot;ghost&quot;))

#&lt;variant 8 ghost&gt;

_$ (vlax-variant-type varstr)

8

Create a safearray of doubles, assign the safearray to a variant, and display
the variant's data type:

_$ (setq 4dubs (vlax-make-safearray vlax-vbDouble '(0 . 3)))

#&lt;safearray...&gt;

_$ (setq var4dubs (vlax-make-variant 4dubs))

#&lt;variant 8197 ...&gt;

_$ (vlax-variant-type var4dubs)

8197

A variant type value greater than 8192 indicates that the variant contains some
type of safearray. Subtract 8192 from the return value to determine the data
type of the safearray. In this example, 8197-8192=5 (vlax-vbDouble).

Assign a real value to a variable, then issue vlax-variant-type to check the
variable's data type:

_$ (setq notvar 6.0)

6.0

_$ (vlax-variant-type notvar)

; ERROR: bad argument type: variantp 6.0

This last example results in an error, because the variable passed to
vlax-variant-type does not contain a variant.

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> ,  , <span class="Identifier">vlax-variant-change-type</a> ,
and <a class="Identifier" href="#vlax-variant-value">vlax-variant-value</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlax-variant-value">vlax-variant-value</h3>

Returns the value of a variant

(vlax-variant-value var)

<span class="ArgumentsIdentifier">Arguments</span>

var

A variable whose value is a variant.

<span class="ReturnsIdentifier">Return Values</span>

The value of the variable. If the variable does not contain a variant, an error
occurs.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-variant-value varstr)

&quot;ghost&quot;

_$ (vlax-variant-value varint)

5

_$ (vlax-variant-value notvar)

; ERROR: bad argument type: variantp 6.0

The last example results in an error, because notvar does not contain a
variant.

See Also

The <a class="Identifier" href="#vlax-make-safearray</span> and  and <span class="Identifier">vlax-make-variant</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-vla-object-&gt;ename">vlax-vla-object-&gt;ename</h3>

Transforms a VLA-object to an AutoLISP entity

(vlax-vla-object-&gt;ename obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object.

<span class="ReturnsIdentifier">Return Values</span>

An AutoLISP entity name (ename data type).

<span class="ExamplesIdentifier">Examples</span>

_$ (vlax-vla-object-&gt;ename vlaobj)

&lt;Entity name: 27e0540&gt;

See Also

The <a class="Identifier" href="#vlax-ename-&gt;vla-object">vlax-ename-&gt;vla-object</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<span class="Statement"></span><h3 class="String" id="vlax-write-enabled-p">vlax-write-enabled-p</h3>

Determines if an AutoCAD drawing object can be modified

(vlax-write-enabled-p obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLA-object or AutoLISP entity object (ename).

<span class="ReturnsIdentifier">Return Values</span>

T, if the AutoCAD drawing object can be modified, nil if the object cannot be
modified.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlisp-compile">vlisp-compile</h3>

Compiles AutoLISP source code into a FAS file

(vlisp-compile 'mode filename <span class="Special">[out-filename]</span>)

<span class="Todo">Note</span>:  The Visual LISP IDE must be open in order for vlisp-compile to work.

<span class="ArgumentsIdentifier">Arguments</span>

mode

The compiler mode, which can be one of the following symbols:

st Standard build mode

lsm Optimize and link indirectly

lsa Optimize and link directly

filename

A string identifying the AutoLISP source file. If the source file is in the
AutoCAD Support File Search Path, you can omit the path when specifying the
file name. If you omit the file extension, .lsp is assumed.

out-filename

A string identifying the compiled output file. If you do not specify an output
file, vlisp-compile names the output with the same name as the input file, but
replaces the extension with .fas.

<span class="Todo">Note</span> that if you specify an output file name but do not specify a path name for
either the input or the output file, vlisp-compile places the output file in
the AutoCAD install directory.

<span class="ReturnsIdentifier">Return Values</span>

T, if compilation is successful, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Assuming that yinyang.lsp resides in a directory that is in the AutoCAD Support
File Search Path, the following command compiles this program:

_$ (vlisp-compile 'st &quot;yinyang.lsp&quot;)

T

The output file is named yinyang.fas and resides in the same directory as the
source file.

The following command compiles yinyang.lsp and names the output file
GoodKarma.fas:

(vlisp-compile 'st &quot;yinyang.lsp&quot; &quot;GoodKarma.fas&quot;)

<span class="Todo">Note</span> that the output file from the previous command resides in the AutoCAD
install directory, not the directory where yinyang.lsp resides. The following
command compiles yinyang.lsp and directs the output file to the c:\my documents
directory:

(vlisp-compile 'st &quot;yinyang.lsp&quot; &quot;c:/my documents/GoodKarma&quot;)

This last example identifies the full path of the file to be compiled:

(vlisp-compile `st &quot;c:/program files/AutoCAD/Sample/
yinyang.lsp&quot;)

The output file from this command is named yinyang.fas and resides in the same
directory as the input file.

See Also

The Compiling a Program from a File topic in the Visual LISP Developer's Guide.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-acdb-reactor">vlr-acdb-reactor</h3>

Constructs a reactor object that notifies when an object is added to, modified
in, or erased from a drawing database

The vlr-acdb-reactor function constructs a database reactor object.

(vlr-acdb-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with a reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Database Reactor Events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

obj The database object (AutoLISP entity) associated with the event

+----------------------------+-------------------------------------------------+
|                           Database reactor events                            |
+----------------------------+-------------------------------------------------+
|            Name            |                      Event                      |
+----------------------------+-------------------------------------------------+
| :vlr-objectAppended        | An object has been appended to the drawing      |
|                            | database.                                       |
+----------------------------+-------------------------------------------------+
| :vlr-objectUnAppended      | An object has been detached from the drawing    |
|                            | database, e.g., by using UNDO.                  |
+----------------------------+-------------------------------------------------+
| :vlr-objectReAppended      | A detached object has been restored in the      |
|                            | drawing database, e.g., by using REDO.          |
+----------------------------+-------------------------------------------------+
| :vlr-objectOpenedForModify | An object is about to be changed.               |
+----------------------------+-------------------------------------------------+
| :vlr-objectModified        | An object has been changed.                     |
+----------------------------+-------------------------------------------------+
| :vlr-objectErased          | An object has been flagged as being erased.     |
+----------------------------+-------------------------------------------------+
| :vlr-objectUnErased        | An object's erased-flag has been removed.       |
+----------------------------+-------------------------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-add">vlr-add</h3>

Enables a disabled reactor object

(vlr-add obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLR object representing the reactor to be enabled.

<span class="ReturnsIdentifier">Return Values</span>

The obj argument.

See Also

The <a class="Identifier" href="#vlr-added-p">vlr-added-p</a> and <a class="Identifier" href="#vlr-remove">vlr-remove</a> functions.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-added-p">vlr-added-p</h3>

Tests to determine if a reactor object is enabled

(vlr-added-p obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLR object representing the reactor to be tested.

<span class="ReturnsIdentifier">Return Values</span>

T if the specified reactor is enabled, or nil if the reactor is disabled.

See Also

The <a class="Identifier" href="#vlr-add">vlr-add</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-beep-reaction">vlr-beep-reaction</h3>

Produces a beep sound

(vlr-beep-reaction <span class="Special">[args]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

This is a predefined callback function that accepts a variable number of
arguments, depending on the reactor type. The function can be assigned to an
event handler for debugging.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-command-reactor">vlr-command-reactor</h3>

Constructs an editor reactor that notifies of a command event

(vlr-command-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data
is to be associated with the reactor.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Command Reactor Events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list containing a single element, the string identifying the command.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

    +------------------------+--------------------------------------------+
    |                       Command reactor events                        |
    +------------------------+--------------------------------------------+
    |       Event name       |                Description                 |
    +------------------------+--------------------------------------------+
    | :vlr-unknownCommand    | A command not known to AutoCAD was issued. |
    +------------------------+--------------------------------------------+
    | :vlr-commandWillStart  | An AutoCAD command has been called.        |
    +------------------------+--------------------------------------------+
    | :vlr-commandEnded      | An AutoCAD command has completed.          |
    +------------------------+--------------------------------------------+
    | :vlr-commandCancelled  | An AutoCAD command has been canceled.      |
    +------------------------+--------------------------------------------+
    | :vlr-commandFailed     | An AutoCAD command failed to complete.     |
    +------------------------+--------------------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-current-reaction-name">vlr-current-reaction-name</h3>

Returns the name (symbol) of the current event, if called from within a
reactor's callback

(vlr-current-reaction-name)

<span class="ReturnsIdentifier">Return Values</span>

A symbol indicating the event that triggered the reactor.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-data">vlr-data</h3>

Returns application-specific data associated with a reactor

(vlr-data obj)

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLR object representing the reactor object from which to extract data.

<span class="ReturnsIdentifier">Return Values</span>

The application-specific data obtained from the reactor object.

<span class="ExamplesIdentifier">Examples</span>

The following example obtains a string associated with the circleReactor VLR
object:

_$ (vlr-data circleReactor)

&quot;Circle Reactor&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-data-set">vlr-data-set</h3>

Overwrites application-specific data associated with a reactor

(vlr-data-set obj data)

<span class="Todo">Note</span>:  The vlr-data-set function should be used with care to avoid creation of
circular structures.

<span class="ArgumentsIdentifier">Arguments</span>

obj

A VLR object representing the reactor object whose data is to be overwritten.

data

Any AutoLISP data.

<span class="ReturnsIdentifier">Return Values</span>

The data argument.

<span class="ExamplesIdentifier">Examples</span>

Return the application-specific data value attached to a reactor:

_$ (vlr-data circleReactor)

&quot;Circle Reactor&quot;

Replaces the text string used to identify the reactor:

_$ (vlr-data-set circleReactor &quot;Circle Area Reactor&quot;)

&quot;Circle Area Reactor&quot;

Verify the change:

_$ (vlr-data circleReactor)

&quot;Circle Area Reactor&quot;

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-deepclone-reactor">vlr-deepclone-reactor</h3>

Constructs an editor reactor object that notifies of a deep clone event

(vlr-deepclone-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the DeepClone reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table DeepClone
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------------+-------------------------------------------------+
|                           DeepClone reactor events                           |
+----------------------------+-------------------------------------------------+
|         Event name         |                   Description                   |
+----------------------------+-------------------------------------------------+
| :vlr-beginDeepClone        | A deep clone operation is beginning.            |
+----------------------------+-------------------------------------------------+
| :vlr-beginDeepCloneXlation | A deep clone operation has two stages. First,   |
|                            | each object and any owned objects are cloned.   |
|                            | Second, any object ID references are            |
|                            | translated to their cloned IDs. This callback   |
|                            | occurs between these two stages.                |
+----------------------------+-------------------------------------------------+
| :vlr-abortDeepClone        | A deep clone operation is aborting.             |
+----------------------------+-------------------------------------------------+
| :vlr-endDeepClone          | A deep clone operation is ending.               |
+----------------------------+-------------------------------------------------+
+---------------------------------+-------------+------------------------------+
|                       DeepClone reactor callback data                        |
+---------------------------------+-------------+------------------------------+
|              Name               | List length |          Parameters          |
+---------------------------------+-------------+------------------------------+
| :vlr-beginDeepClone             | 0           |                              |
| :vlr-abortDeepClone             |             |                              |
| :vlr-endDeepClone               |             |                              |
+---------------------------------+-------------+------------------------------+
| :vlr-beginDeepCloneXlation      | 1           | An integer containing the    |
|                                 |             | return error status; if      |
|                                 |             | this value indicates an      |
|                                 |             | error, the deep clone        |
|                                 |             | operation is terminated.     |
+---------------------------------+-------------+------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-docmanager-reactor">vlr-docmanager-reactor</h3>

Constructs a reactor object that notifies of events relating to
drawing-documents

(vlr-docmanager-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the DocManager reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table DocManager
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+-----------------------------------+------------------------------------------+
|                          DocManager reactor events                           |
+-----------------------------------+------------------------------------------+
|            Event name             |               Description                |
+-----------------------------------+------------------------------------------+
| :vlr-documentCreated              | A new document was created for a         |
|                                   | drawing (new or open).Useful for         |
|                                   | updating your per-document structures.   |
+-----------------------------------+------------------------------------------+
| :vlr-documentToBeDestroyed        | A document will be destroyed.            |
+-----------------------------------+------------------------------------------+
| :vlr-documentLockModeWillChange   | A command is about to start or finish    |
|                                   | modifying elements in the document, and  |
|                                   | is obtaining or releasing a lock on the  |
|                                   | document.                                |
+-----------------------------------+------------------------------------------+
| :vlr-documentLockModeChangeVetoed | A reactor invoked veto on itself from a  |
|                                   | :vlr-documentLockModeChanged callback.   |
+-----------------------------------+------------------------------------------+
| :vlr-documentLockModeChanged      | The lock on the document has been        |
|                                   | obtained or released.                    |
+-----------------------------------+------------------------------------------+
| :vlr-documentBecameCurrent        | The current document has been changed.   |
|                                   | This does not necessarily imply that     |
|                                   | the document has been activated,         |
|                                   | because changing the current document    |
|                                   | is necessary for some operations. To     |
|                                   | obtain user input, the document must be  |
|                                   | activated as well.                       |
+-----------------------------------+------------------------------------------+
| :vlr-documentToBeActivated        | A currently inactive document has just   |
|                                   | received the activate signal, implying   |
|                                   | that it is about to become the current   |
|                                   | document.                                |
+-----------------------------------+------------------------------------------+
| :vlr-documentToBeDeactivated      | Another window (inside or outside of     |
|                                   | AutoCAD) has been activated.             |
+-----------------------------------+------------------------------------------+
+-----------------------------------+-----------+------------------------------+
|                       DocManager reactor callback data                       |
+-----------------------------------+-----------+------------------------------+
|               Name                |   List    |          Parameters          |
|                                   |  length   |                              |
+-----------------------------------+-----------+------------------------------+
| :vlr-documentCreated              | 1         | The affected document        |
| :vlr-documentToBeDestroyed        |           | object (VLA-object).         |
| :vlr-documentBecameCurrent        |           |                              |
| :vlr-documentToBeActivated        |           |                              |
| :vlr-documentToBeDeactivated      |           |                              |
+-----------------------------------+-----------+------------------------------+
| :vlr-documentLockModeChangeVetoed | 2         | First parameter is the       |
|                                   |           | affected document object     |
|                                   |           | (VLA-object).Second          |
|                                   |           | parameter is the global      |
|                                   |           | command string passed in     |
|                                   |           | for the lock request. If     |
|                                   |           | the callback is being made   |
|                                   |           | on behalf of an unlock       |
|                                   |           | request, the string will be  |
|                                   |           | prefixed with &quot;#&quot;.           |
+-----------------------------------+-----------+------------------------------+
| :vlr-documentLockModeWillChange   | 5         | First parameter is the       |
| :vlr-documentLockModeChanged      |           | affected document object     |
|                                   |           | (VLA-object).Second          |
|                                   |           | parameter is an integer      |
|                                   |           | indicating the lock          |
|                                   |           | currently in effect for the  |
|                                   |           | document object.Third        |
|                                   |           | parameter is an integer      |
|                                   |           | indicating the lock mode     |
|                                   |           | that will be in effect       |
|                                   |           | after the lock is            |
|                                   |           | applied.Fourth parameter is  |
|                                   |           | the strongest lock mode      |
|                                   |           | from all other execution     |
|                                   |           | contexts.Fifth parameter is  |
|                                   |           | the global command string    |
|                                   |           | passed in for the lock       |
|                                   |           | request. If the callback is  |
|                                   |           | being made on behalf of an   |
|                                   |           | unlock request, the string   |
|                                   |           | will be prefixed with        |
|                                   |           | &quot;#&quot;.Lock modes may be any    |
|                                   |           | of the following:1--Auto     |
|                                   |           | Write Lock2--Not             |
|                                   |           | Locked4--Shared              |
|                                   |           | Write8--Read10--Exclusive    |
|                                   |           | Write                        |
+-----------------------------------+-----------+------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-dwg-reactor">vlr-dwg-reactor</h3>

Constructs an editor reactor object that notifies of a drawing event (for
example, opening or closing a drawing file)

(vlr-dwg-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the DWG reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table DWG reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------------+-------------------------------------------------+
|                              DWG reactor events                              |
+----------------------------+-------------------------------------------------+
|         Event name         |                   Description                   |
+----------------------------+-------------------------------------------------+
| :vlr-beginClose            | The drawing database is to be closed.           |
+----------------------------+-------------------------------------------------+
| :vlr-databaseConstructed   | A drawing database has been constructed.        |
+----------------------------+-------------------------------------------------+
| :vlr-databaseToBeDestroyed | The contents of the drawing database is about   |
|                            | to be deleted from memory.                      |
+----------------------------+-------------------------------------------------+
| vlr-beginDwgOpen           | AutoCAD is about to open a drawing file.        |
+----------------------------+-------------------------------------------------+
| :vlr-endDwgOpen            | AutoCAD has ended the open operation.           |
+----------------------------+-------------------------------------------------+
| :vlr-dwgFileOpened         | A new drawing has been loaded into the AutoCAD  |
|                            | drawing window.                                 |
+----------------------------+-------------------------------------------------+
| vlr-beginSave              | AutoCAD is about to save the drawing file.      |
+----------------------------+-------------------------------------------------+
| vlr-saveComplete           | AutoCAD has saved the current drawing to disk.  |
+----------------------------+-------------------------------------------------+
+----------------------------+-------------+-----------------------------------+
|                          DWG reactor callback data                           |
+----------------------------+-------------+-----------------------------------+
|            Name            | List length |            Parameters             |
+----------------------------+-------------+-----------------------------------+
| :vlr-beginClose            | 0           |                                   |
| :vlr-databaseConstructed   |             |                                   |
| :vlr-databaseToBeDestroyed |             |                                   |
+----------------------------+-------------+-----------------------------------+
| :vlr-beginDwgOpen          | 1           | A string identifying the file to  |
| :vlr-endDwgOpen            |             | open.                             |
| :vlr-dwgFileOpened         |             |                                   |
+----------------------------+-------------+-----------------------------------+
| :vlr-beginSave             | 1           | A string containing the default   |
|                            |             | file name for save; may be        |
|                            |             | changed by the user               |
+----------------------------+-------------+-----------------------------------+
| :vlr-saveComplete          | 1           | A string containing the actual    |
|                            |             | file name used for the save.      |
+----------------------------+-------------+-----------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-dxf-reactor">vlr-dxf-reactor</h3>

Constructs an editor reactor object that notifies of an event related to
reading or writing a DXF file

(vlr-dxf-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the DXF reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table DXF reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+---------------------+--------------------------------------------------------+
|                              DXF reactor events                              |
+---------------------+--------------------------------------------------------+
|     Event name      |                      Description                       |
+---------------------+--------------------------------------------------------+
| :vlr-beginDxfIn     | The contents of a DXF file is to be appended to the    |
|                     | drawing database.                                      |
+---------------------+--------------------------------------------------------+
| :vlr-abortDxfIn     | The DXF import was not successful.                     |
+---------------------+--------------------------------------------------------+
| :vlr-dxfInComplete  | The DXF import was successful.                         |
+---------------------+--------------------------------------------------------+
| :vlr-beginDxfOut    | AutoCAD is about to export the drawing database into   |
|                     | a DXF file.                                            |
+---------------------+--------------------------------------------------------+
| :vlr-abortDxfOut    | The DXF export operation failed.                       |
+---------------------+--------------------------------------------------------+
| :vlr-dxfOutComplete | The DXF export operation was successful.               |
+---------------------+--------------------------------------------------------+
            +---------------------------+-------------+------------+
            |              DXF reactor callback data               |
            +---------------------------+-------------+------------+
            |           Name            | List length | Parameters |
            +---------------------------+-------------+------------+
            | :vlr-beginDxfIn           | 0           |            |
            | :vlr-abortDxfIn           |             |            |
            | :vlr-dxfInComplete,       |             |            |
            | :vlr-beginDxfOut          |             |            |
            | :vlr-abortDxfOut          |             |            |
            | :vlr-dxfOutComplete       |             |            |
            +---------------------------+-------------+------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-editor-reactor">vlr-editor-reactor</h3>

Constructs an editor reactor object

(vlr-editor-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Editor reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Editor
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------------+-------------------------------------------------+
|                            Editor reactor events                             |
+----------------------------+-------------------------------------------------+
|         Event name         |                   Description                   |
+----------------------------+-------------------------------------------------+
| :vlr-beginClose            | The drawing database is to be closed.           |
+----------------------------+-------------------------------------------------+
| :vlr-beginDxfIn            | The contents of a DXF file is to be appended    |
|                            | to the drawing database.                        |
+----------------------------+-------------------------------------------------+
| :vlr-abortDxfIn            | The DXF import was not successful.              |
+----------------------------+-------------------------------------------------+
| :vlr-dxfInComplete         | The DXF import completed successfully.          |
+----------------------------+-------------------------------------------------+
| :vlr-beginDxfOut           | AutoCAD is about to export the drawing          |
|                            | database into a DXF file.                       |
+----------------------------+-------------------------------------------------+
| :vlr-abortDxfOut           | DXF export operation failed.                    |
+----------------------------+-------------------------------------------------+
| :vlr-dxfOutComplete        | DXF export operation completed successfully.    |
+----------------------------+-------------------------------------------------+
| :vlr-databaseToBeDestroyed | The contents of the drawing database is about   |
|                            | to be deleted from memory.                      |
+----------------------------+-------------------------------------------------+
| :vlr-unknownCommand        | A command not known to AutoCAD was issued.      |
+----------------------------+-------------------------------------------------+
| :vlr-commandWillStart      | An AutoCAD command has been called.             |
+----------------------------+-------------------------------------------------+
| vlr-commandEnded           | An AutoCAD command has completed.               |
+----------------------------+-------------------------------------------------+
| :vlr-commandCancelled      | An AutoCAD command has been canceled.           |
+----------------------------+-------------------------------------------------+
| :vlr-commandFailed         | An AutoCAD command failed to complete.          |
+----------------------------+-------------------------------------------------+
| :vlr-lispWillStart         | An AutoLISP expression is to be evaluated.      |
+----------------------------+-------------------------------------------------+
| :vlr-lispEnded             | Evaluation of an AutoLISP expression has        |
|                            | completed.                                      |
+----------------------------+-------------------------------------------------+
| :vlr-lispCancelled         | Evaluation of an AutoLISP expression has been   |
|                            | canceled.                                       |
+----------------------------+-------------------------------------------------+
| :vlr-beginDwgOpen          | AutoCAD is about to open a drawing file.        |
+----------------------------+-------------------------------------------------+
| :vlr-endDwgOpen            | AutoCAD has ended the open operation.           |
+----------------------------+-------------------------------------------------+
| :vlr-dwgFileOpened         | A new drawing has been loaded into the AutoCAD  |
|                            | drawing window.                                 |
+----------------------------+-------------------------------------------------+
| :vlr-beginSave             | AutoCAD is about to save the drawing file.      |
+----------------------------+-------------------------------------------------+
| :vlr-saveComplete          | AutoCAD has saved the current drawing to disk.  |
+----------------------------+-------------------------------------------------+
| :vlr-sysVarWillChange      | AutoCAD is about to change the value of a       |
|                            | system variable.                                |
+----------------------------+-------------------------------------------------+
| :vlr-sysVarChanged         | The value of a system variable has changed.     |
+----------------------------+-------------------------------------------------+
+------------------------------+-------------+---------------------------------+
|                         Editor reactor callback data                         |
+------------------------------+-------------+---------------------------------+
|             Name             | List length |           Parameters            |
+------------------------------+-------------+---------------------------------+
| :vlr-lispEnded               | 0           |                                 |
| :vlr-lispCancelled           |             |                                 |
| :vlr-beginClose              |             |                                 |
| :vlr-beginDxfIn              |             |                                 |
| :vlr-abortDxfIn              |             |                                 |
| :vlr-dxfInComplete           |             |                                 |
| :vlr-beginDxfOut             |             |                                 |
| :vlr-abortDxfOut             |             |                                 |
| :vlr-dxfOutComplete          |             |                                 |
| :vlr-databaseToBeDestroyed   |             |                                 |
+------------------------------+-------------+---------------------------------+
| :vlr-unknownCommand          | 1           | A string containing the         |
| :vlr-commandWillStart        |             | command name.                   |
| :vlr-commandEnded            |             |                                 |
| :vlr-commandCancelled        |             |                                 |
| :vlr-commandFailed           |             |                                 |
+------------------------------+-------------+---------------------------------+
| :vlr-lispWillStart           | 1           | A string containing the first   |
|                              |             | line of the AutoLISP            |
|                              |             | expression to evaluate.         |
+------------------------------+-------------+---------------------------------+
| :vlr-beginDwgOpen            | 1           | A string identifying the file   |
| :vlr-endDwgOpen              |             | to open.                        |
| :vlr-dwgFileOpened           |             |                                 |
+------------------------------+-------------+---------------------------------+
| :vlr-beginSave               | 1           | A string containing the         |
|                              |             | default file name for save;     |
|                              |             | this may be changed by the      |
|                              |             | user.                           |
+------------------------------+-------------+---------------------------------+
| :vlr-saveComplete            | 1           | A string identifying the        |
|                              |             | actual file name used for the   |
|                              |             | save.                           |
+------------------------------+-------------+---------------------------------+
| :vlr-sysVarWillChange        | 1           | A string naming the system      |
|                              |             | variable.                       |
+------------------------------+-------------+---------------------------------+
| :vlr-sysVarChanged           | 2           | First parameter is a string     |
|                              |             | naming the system               |
|                              |             | variable.Second parameter is    |
|                              |             | an integer indicating whether   |
|                              |             | the change was successful (1 =  |
|                              |             | success, 0 = failed).           |
+------------------------------+-------------+---------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-insert-reactor">vlr-insert-reactor</h3>

Constructs an editor reactor object that notifies of an event related to block
insertion

(vlr-insert-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Insert reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Insert
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+-----------------------+------------------------------------------------------+
|                            Insert reactor events                             |
+-----------------------+------------------------------------------------------+
|      Event name       |                     Description                      |
+-----------------------+------------------------------------------------------+
| :vlr-beginInsert      | A block is about to be inserted into the drawing     |
|                       | database.                                            |
+-----------------------+------------------------------------------------------+
| :vlr-beginInsertM     | A 3D transformation matrix is about to be inserted   |
|                       | into the drawing database.                           |
+-----------------------+------------------------------------------------------+
| :vlr-otherInsert      | A block or matrix has been added to the drawing      |
|                       | database. This notification is sent after the        |
|                       | insert process completes copying the object into     |
|                       | the database, but before ID translation or entity    |
|                       | transformation occurs.                               |
+-----------------------+------------------------------------------------------+
| :vlr-endInsert        | Usually indicates an insert operation on the         |
|                       | drawing database is complete. However, in some       |
|                       | cases, the transform has not yet happened, or the    |
|                       | block that was created has not yet been appended.    |
|                       | This means the objects copied are not yet            |
|                       | graphical, and you cannot use them in selection      |
|                       | sets until the :vlr-commandEnded notification is     |
|                       | received.                                            |
+-----------------------+------------------------------------------------------+
| :vlr-abortInsert      | Insert operation was terminated and did not          |
|                       | complete, leaving the database in an unstable state. |
+-----------------------+------------------------------------------------------+
+------------------------------+-------------+---------------------------------+
|                         Insert reactor callback data                         |
+------------------------------+-------------+---------------------------------+
|             Name             | List length |           Parameters            |
+------------------------------+-------------+---------------------------------+
| :vlr-beginInsert             | 3           | First parameter is a            |
|                              |             | VLA-object pointing to the      |
|                              |             | database in which the block is  |
|                              |             | being inserted.Second           |
|                              |             | parameter is a string naming    |
|                              |             | the block to be inserted.Third  |
|                              |             | parameter is a VLA-object       |
|                              |             | identifying the source          |
|                              |             | database of the block.          |
+------------------------------+-------------+---------------------------------+
| :vlr-beginInsertM            | 3           | First parameter is a            |
|                              |             | VLA-object pointing to the      |
|                              |             | database in which the 3D        |
|                              |             | transformation matrix is being  |
|                              |             | inserted.Second parameter is    |
|                              |             | the 3D transformation matrix    |
|                              |             | to be inserted.Third parameter  |
|                              |             | is a VLA-object identifying     |
|                              |             | the source database of the      |
|                              |             | matrix.                         |
+------------------------------+-------------+---------------------------------+
| :vlr-otherInsert             | 2           | First parameter is a            |
|                              |             | VLA-object pointing to the      |
|                              |             | database in which the block or  |
|                              |             | matrix is being                 |
|                              |             | inserted.Second parameter is a  |
|                              |             | VLA-object identifying the      |
|                              |             | source database of the block    |
|                              |             | or matrix.                      |
+------------------------------+-------------+---------------------------------+
| :vlr-endInsert               | 1           | VLA-object pointing to target   |
| :vlr-abortInsert             |             | database.                       |
+------------------------------+-------------+---------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-linker-reactor">vlr-linker-reactor</h3>

Constructs a reactor object that notifies your application every time an
ObjectARX application is loaded or unloaded

(vlr-linker-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the table Linker reactor
events, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list containing the name of the ObjectARX program that was loaded or
unloaded (a string).

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+-----------------------+------------------------------------------------------+
|                            Linker reactor events                             |
+-----------------------+------------------------------------------------------+
|         Name          |                        Event                         |
+-----------------------+------------------------------------------------------+
| :vlr-rxAppLoaded      | The dynamic linker has loaded a new ObjectARX        |
|                       | program. The program has finished its                |
|                       | initialization.                                      |
+-----------------------+------------------------------------------------------+
| :vlr-rxAppUnLoaded    | The dynamic linker has unloaded an ObjectARX         |
|                       | program. The program already has done its clean-up.  |
+-----------------------+------------------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-linker-reactor nil

 '((:vlr-rxAppLoaded . my-vlr-trace-reaction)))

#<span class="Special">&lt;VLR-Linker-Reactor&gt;</span>

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-lisp-reactor">vlr-lisp-reactor</h3>

Constructs an editor reactor object that notifies of a LISP event

(vlr-lisp-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Lisp reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Lisp reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+---------------------+--------------------------------------------------------+
|                             Lisp reactor events                              |
+---------------------+--------------------------------------------------------+
|     Event name      |                      Description                       |
+---------------------+--------------------------------------------------------+
| :vlr-lispWillStart  | An AutoLISP expression is to be evaluated.             |
+---------------------+--------------------------------------------------------+
| :vlr-lispEnded      | Evaluation of an AutoLISP expression has completed.    |
+---------------------+--------------------------------------------------------+
| :vlr-lispCancelled  | Evaluation of an AutoLISP expression has been          |
|                     | canceled.                                              |
+---------------------+--------------------------------------------------------+
+----------------------------+-------------+-----------------------------------+
|                          Lisp reactor callback data                          |
+----------------------------+-------------+-----------------------------------+
|            Name            | List length |            Parameters             |
+----------------------------+-------------+-----------------------------------+
| :vlr-lispEnded             | 0           |                                   |
| :vlr-lispCancelled         |             |                                   |
+----------------------------+-------------+-----------------------------------+
| :vlr-lispWillStart         | 1           | A string containing the first     |
|                            |             | line of the AutoLISP expression   |
|                            |             | to evaluate.                      |
+----------------------------+-------------+-----------------------------------+


<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-miscellaneous-reactor">vlr-miscellaneous-reactor</h3>

Constructs an editor reactor object that does not fall under any other editor
reactor types

(vlr-miscellaneous-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Miscellaneous reactor
events table below, and callback_function is a symbol representing a function
to be called when the event fires. Each callback function accepts two
arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Miscellaneous
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+------------------------------+-----------------------------------------------+
|                         Miscellaneous reactor events                         |
+------------------------------+-----------------------------------------------+
|          Event name          |                  Description                  |
+------------------------------+-----------------------------------------------+
| :vlr-pickfirstModified       | The pickfirst selection set of the current    |
|                              | document has been modified.                   |
+------------------------------+-----------------------------------------------+
| :vlr-layoutSwitched          | The layout was switched.                      |
+------------------------------+-----------------------------------------------+
+-------------------------------------+-------------+--------------------------+
|                     Miscellaneous reactor callback data                      |
+-------------------------------------+-------------+--------------------------+
|                Name                 | List length |        Parameters        |
+-------------------------------------+-------------+--------------------------+
| :vlr-pickfirstModified              | 0           |                          |
+-------------------------------------+-------------+--------------------------+
| :vlr-layoutSwitched                 | 1           | A string naming the      |
|                                     |             | layout switched to.      |
+-------------------------------------+-------------+--------------------------+


<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-mouse-reactor">vlr-mouse-reactor</h3>

Constructs an editor reactor object that notifies of a mouse event (for
example, a double-click)

(vlr-mouse-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Mouse reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Mouse reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

            +-----------------------+------------------------------+
            |                 Mouse reactor events                 |
            +-----------------------+------------------------------+
            |      Event name       |         Description          |
            +-----------------------+------------------------------+
            | :vlr-beginDoubleClick | The user has double-clicked. |
            +-----------------------+------------------------------+
            | :vlr-beginRightClick  | The user has right-clicked.  |
            +-----------------------+------------------------------+
+-----------------------------+-------------+----------------------------------+
|                         Mouse reactor callback data                          |
+-----------------------------+-------------+----------------------------------+
|            Name             | List length |            Parameters            |
+-----------------------------+-------------+----------------------------------+
| :vlr-beginDoubleClick       | 1           | A 3D point list (list of 3       |
| :vlr-beginRightClick        |             | reals) showing the point         |
|                             |             | clicked on, in WCS.              |
+-----------------------------+-------------+----------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-notification">vlr-notification</h3>

Determines whether or not a reactor will fire if its associated namespace is
not active

(vlr-notification reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

A symbol, which can be either 'all-documents (the reactor fires whether or not
its associated document is active), or 'active-document-only (the reactor fires
only if its associated document is active).

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-object-reactor">vlr-object-reactor</h3>

Constructs an object reactor object

(vlr-object-reactor owners data callbacks)

The reactor object is added to the drawing database, but does not become
persistent.

<span class="ArgumentsIdentifier">Arguments</span>

owners

An AutoLISP list of VLA-objects identifying the drawing objects to be watched.

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the table Object events, and
callback_function is a symbol representing a function to be called when the
event fires. Each callback function accepts three arguments:

owner The owner of the VLA-object the event applies to.

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Object events
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------+-------------------------------------------------------+
|                                Object events                                 |
+----------------------+-------------------------------------------------------+
|         Name         |                         Event                         |
+----------------------+-------------------------------------------------------+
| :vlr-cancelled       | The modification of the object has been canceled.     |
+----------------------+-------------------------------------------------------+
| :vlr-copied          | The object has been copied.                           |
+----------------------+-------------------------------------------------------+
| :vlr-erased          | Erase-flag of the object has been set.                |
+----------------------+-------------------------------------------------------+
| :vlr-unerased        | Erase-flag of the object has been reset.              |
+----------------------+-------------------------------------------------------+
| :vlr-goodbye         | The object is about to be deleted from memory.        |
+----------------------+-------------------------------------------------------+
| :vlr-openedForModify | The object is about to be modified.                   |
+----------------------+-------------------------------------------------------+
| :vlr-modified        | The object has been modified. If the modification     |
|                      | was canceled, also :vlr-cancelled and                 |
|                      | :vlr-modifyUndone will be fired.                      |
+----------------------+-------------------------------------------------------+
| :vlr-subObjModified  | A sub-entity of the object has been modified. This    |
|                      | event is triggered for modifications to vertices of   |
|                      | polylines or meshes, and for attributes owned by      |
|                      | blockReferences.                                      |
+----------------------+-------------------------------------------------------+
| :vlr-modifyUndone    | The object's modification was undone.                 |
+----------------------+-------------------------------------------------------+
| :vlr-modifiedXData   | The object's extended entity data have been modified. |
+----------------------+-------------------------------------------------------+
| :vlr-unappended      | The object has been detached from the drawing         |
|                      | database.                                             |
+----------------------+-------------------------------------------------------+
| :vlr-reappended      | The object has been re-attached to the drawing        |
|                      | database.                                             |
+----------------------+-------------------------------------------------------+
| :vlr-objectClosed    | The object's modification has been finished.          |
+----------------------+-------------------------------------------------------+
+-----------------------------+-------------+----------------------------------+
|                         Object events callback data                          |
+-----------------------------+-------------+----------------------------------+
|            Name             | List length |            Parameters            |
+-----------------------------+-------------+----------------------------------+
| :vlr-cancelled              | 0           |                                  |
| :vlr-erased,                |             |                                  |
| :vlr-unerased               |             |                                  |
| :vlr-goodbye                |             |                                  |
| :vlr-openedForModify        |             |                                  |
| :vlr-modified               |             |                                  |
| :vlr-modifyUndone           |             |                                  |
| :vlr-modifiedXData          |             |                                  |
| :vlr-unappended             |             |                                  |
| :vlr-reappended             |             |                                  |
| :vlr-objectClosed           |             |                                  |
+-----------------------------+-------------+----------------------------------+
| :vlr-copied                 | 1           | The object created by the copy   |
|                             |             | operation (ename).               |
+-----------------------------+-------------+----------------------------------+
| :vlr-subObjModified         | 1           | The sub-object (ename) that has  |
|                             |             | been modified.                   |
+-----------------------------+-------------+----------------------------------+
<span class="ExamplesIdentifier">Examples</span>

The following code attaches an object reactor to the myCircle object. It
defines the reactor to respond whenever the object is modified (:vlr-modified)
and to call the print-radius function in response to the modification event:

(setq circleReactor (vlr-object-reactor (list myCircle)

 &quot;Circle Reactor&quot; '((:vlr-modified . print-radius))))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-owner-add">vlr-owner-add</h3>

Adds an object to the list of owners of an object reactor

(vlr-owner-add reactor owner)

This function adds a new source of reactor events; the reactor will receive
events from the specified object.

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

owner

A VLA-object to be added to the list of notifiers for this reactor.

<span class="ReturnsIdentifier">Return Values</span>

The VLA-object to which the reactor has been added.

<span class="ExamplesIdentifier">Examples</span>

In the following example, an arc object named &quot;archie&quot; is added to the owner
list of reactor circleReactor:

_$ (vlr-owner-add circleReactor archie)

#&lt;VLA-OBJECT IAcadArc 03ad0bcc&gt;

See Also

The <a class="Identifier" href="#vlr-owner-remove">vlr-owner-remove</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-owner-remove">vlr-owner-remove</h3>

Removes an object from the list of owners of an object reactor

(vlr-owner-remove reactor owner)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

owner

A VLA-object to be removed from the list of notifiers for this reactor.

<span class="ReturnsIdentifier">Return Values</span>

The VLA-object from which the reactor was removed.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-owner-remove circleReactor archie)

#&lt;VLA-OBJECT IAcadArc 03ad0bcc&gt;

See Also

The <a class="Identifier" href="#vlr-owner-add">vlr-owner-add</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-owners">vlr-owners</h3>

Returns the list of owners of an object reactor

(vlr-owners reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

A list of objects that notify the specified reactor.

<span class="ExamplesIdentifier">Examples</span>

 _$ (vlr-owners circleReactor)

(#&lt;VLA-OBJECT IAcadCircle 01db98f4&gt; #&lt;VLA-OBJECT IAcadCircle
01db9724&gt; #&lt;VLA-OBJECT IAcadCircle 01db93d4&gt; #&lt;VLA-OBJECT
IAcadCircle 01db9084&gt;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-pers">vlr-pers</h3>

Makes a reactor persistent

(vlr-pers reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

The specified reactor object, if successful, nil otherwise.

<span class="ExamplesIdentifier">Examples</span>

Define a reactor:

_$ (setq circleReactor (vlr-object-reactor

(list myCircle) &quot;Radius size&quot; '((:vlr-modified . print-radius))))

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

Make the reactor persistent:

_$ (vlr-pers circleReactor)

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-pers-list">vlr-pers-list</h3>

Returns a list of persistent reactors in the current drawing document

(vlr-pers-list <span class="Special">[reactor]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

The reactor object to be listed. If reactor is not specified, vlr-pers-list
lists all persistent reactors.

<span class="ReturnsIdentifier">Return Values</span>

A list of reactor objects.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-pers-list)

(#<span class="Special">&lt;VLR-Object-Reactor&gt;</span> #<span class="Special">&lt;VLR-Object-Reactor&gt;</span>
(#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-pers-p">vlr-pers-p</h3>

Determines whether or not a reactor is persistent

(vlr-pers-p reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

The specified reactor object, if it is persistent; nil, if the reactor is
transient.

<span class="ExamplesIdentifier">Examples</span>

Make a reactor persistent:

_$ (vlr-pers circleReactor)

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

Verify that a reactor is persistent:

_$ (vlr-pers-p circleReactor)

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

Change the persistent reactor to transient:

_$ (vlr-pers-release circleReactor)

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

Verify that the reactor is no longer persistent:

_$ (vlr-pers-p circleReactor)

nil

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-pers-release">vlr-pers-release</h3>

Makes a reactor transient

(vlr-pers-release reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

VLR object.

<span class="ReturnsIdentifier">Return Values</span>

The specified reactor object, if successful, nil otherwise.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-reaction-name">vlr-reaction-name</h3>

Returns a list of all possible callback conditions for this reactor type

(vlr-reaction-names reactor-type)

<span class="ArgumentsIdentifier">Arguments</span>

reactor-type

One of the following symbols:

:VLR-AcDb-Reactor
:VLR-Command-Reactor
:VLR-DeepClone-Reactor
:VLR-DocManager-Reactor
:VLR-DWG-Reactor
:VLR-DXF-Reactor
:VLR-Editor-Reactor
:VLR-Insert-Reactor
:VLR-Linker-Reactor
:VLR-Lisp-Reactor
:VLR-Miscellaneous-Reactor
:VLR-Mouse-Reactor
:VLR-Object-Reactor
:VLR-SysVar-Reactor
:VLR-Toolbar-Reactor
:VLR-Undo-Reactor
:VLR-Wblock-Reactor
:VLR-Window-Reactor
:VLR-XREF-Reactor

<span class="ReturnsIdentifier">Return Values</span>

A list of symbols indicating the possible events for the specified reactor
type.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-reaction-names :VLR-Editor-Reactor)

(:vlr-unknownCommand :vlr-commandWillStart :vlr-commandEnded....

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-reaction-set">vlr-reaction-set</h3>

Adds or replaces a callback function in a reactor

(vlr-reaction-set reactor event function)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

event

A symbol denoting one of the event types available for this reactor type.

function

A symbol representing the AutoLISP function to be added or replaced.

<span class="ReturnsIdentifier">Return Values</span>

Unspecified.

<span class="ExamplesIdentifier">Examples</span>

The following command changes the circleReactor reactor to call the print-area
function when an object is modified:

_$ (vlr-reaction-set circleReactor :vlr-modified 'print-area)

PRINT-AREA

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-reactions">vlr-reactions</h3>

Returns a list of pairs (event-name . callback_function) for the reactor

(vlr-reactions reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-reactions circleReactor)

((:vlr-modified . PRINT-RADIUS))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-reactors">vlr-reactors</h3>

Returns a list of existing reactors

(vlr-reactors [reactor-type...])

<span class="ArgumentsIdentifier">Arguments</span>

reactor-type

One or more of the following symbols:

:VLR-AcDb-Reactor
:VLR-Command-Reactor
:VLR-DeepClone-Reactor
:VLR-DocManager-Reactor
:VLR-DWG-Reactor
:VLR-DXF-Reactor
:VLR-Editor-Reactor
:VLR-Insert-Reactor
:VLR-Linker-Reactor
:VLR-Lisp-Reactor
:VLR-Miscellaneous-Reactor
:VLR-Mouse-Reactor
:VLR-Object-Reactor
:VLR-SysVar-Reactor
:VLR-Toolbar-Reactor
:VLR-Undo-Reactor
:VLR-Wblock-Reactor
:VLR-Window-Reactor
:VLR-XREF-Reactor

If you specify reactor-type arguments, vlr-reactors returns lists of the
reactor types you specified. If you omit reactor-type, vlr-reactors returns all
existing reactors.

<span class="ReturnsIdentifier">Return Values</span>

A list of reactor lists, or nil, if there are no reactors of any specified
type. Each reactor list begins with a symbol identifying the reactor type,
followed by pointers to each reactor of that type.

<span class="ExamplesIdentifier">Examples</span>

List all reactors in a drawing:

_$ (vlr-reactors)

((:VLR-Object-Reactor #<span class="Special">&lt;VLR-Object-Reactor&gt;</span>) (:VLR-Editor-Reactor
#<span class="Special">&lt;VLR-Editor-Reactor&gt;</span>))

List all object reactors:

_$ (vlr-reactors :vlr-object-reactor)

((:VLR-Object-Reactor #<span class="Special">&lt;VLR-Object-Reactor&gt;</span>))

vlr-reactors returns a list containing a single reactor list.

List all database reactors:

_$ (vlr-reactors :vlr-acdb-reactor)

nil

There are no database reactors defined.

List all DWG reactors:

_$ (vlr-reactors :vlr-dwg-reactor)

((:VLR-DWG-Reactor #<span class="Special">&lt;VLR-DWG-Reactor&gt;</span> #<span class="Special">&lt;VLR-DWG-Reactor&gt;</span>))

vlr-reactors returns a list containing a list of DWG reactors.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-remove">vlr-remove</h3>

Disables a reactor

(vlr-remove reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

The reactor argument, or nil, if unsuccessful.

<span class="ExamplesIdentifier">Examples</span>

The following command disables the circleReactor reactor:

_$ (vlr-remove circleReactor)

#<span class="Special">&lt;VLR-Object-reactor&gt;</span>

See Also

The <a class="Identifier" href="#vlr-remove-all">vlr-remove-all</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-remove-all">vlr-remove-all</h3>

Disables all reactors of the specified type

(vlr-remove-all <span class="Special">[reactor-type]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

reactor-type

One of the following symbols:

:VLR-AcDb-Reactor
:VLR-Command-Reactor
:VLR-DeepClone-Reactor
:VLR-DocManager-Reactor
:VLR-DWG-Reactor
:VLR-DXF-Reactor
:VLR-Editor-Reactor
:VLR-Insert-Reactor
:VLR-Linker-Reactor
:VLR-Lisp-Reactor
:VLR-Miscellaneous-Reactor
:VLR-Mouse-Reactor
:VLR-Object-Reactor
:VLR-SysVar-Reactor
:VLR-Toolbar-Reactor
:VLR-Undo-Reactor
:VLR-Wblock-Reactor
:VLR-Window-Reactor
:VLR-XREF-Reactor

If no reactor-type is specified, vlr-remove-all disables all reactors.

<span class="ReturnsIdentifier">Return Values</span>

A list of lists. The first element of each list identifies the type of reactor,
and the remaining elements identify the disabled reactor objects. The function
returns nil if there are no reactors active.

<span class="ExamplesIdentifier">Examples</span>

The following function call disables all editor reactors:

_$ (vlr-remove-all :vlr-editor-reactor)

((:VLR-Editor-Reactor #<span class="Special">&lt;VLR-Editor-Reactor&gt;</span>))

The following call disables all reactors:

_$ (vlr-remove-all)

((:VLR-Object-Reactor #<span class="Special">&lt;VLR-Object-Reactor&gt;</span> #<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>) (:VLR-Editor-Reactor #<span class="Special">&lt;VLR-Editor-Reactor&gt;</span>))

See Also

The <a class="Identifier" href="#vlr-remove">vlr-remove</a> function.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-set-notification">vlr-set-notification</h3>

Defines whether or not a reactor's callback function will execute if its
associated namespace is not active

(vlr-set-notification reactor 'range)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

'range

The range argument is a symbol that can be either 'all-documents (execute the
callback whether or not the reactor is associated with the active document), or
'active-document-only (execute the callback only if the reactor is associated
with the active document).

<span class="ReturnsIdentifier">Return Values</span>

The VLR object.

<span class="ExamplesIdentifier">Examples</span>

Set a reactor to execute its callback function even if its associated namespace
is not active:

_$ (vlr-set-notification circleReactor 'all-documents)

#<span class="Special">&lt;VLR-Object-Reactor&gt;</span>

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-sysvar-reactor">vlr-sysvar-reactor</h3>

Constructs an editor reactor object that notifies of a change to a system
variable

(vlr-sysvar-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the SysVar reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table SysVar
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+-----------------------+------------------------------------------------------+
|                            SysVar reactor events                             |
+-----------------------+------------------------------------------------------+
|      Event name       |                     Description                      |
+-----------------------+------------------------------------------------------+
| :vlr-sysVarWillChange | AutoCAD is about to change the value of a system     |
|                       | variable.                                            |
+-----------------------+------------------------------------------------------+
| :vlr-sysVarChanged    | The value of a system variable has changed.          |
+-----------------------+------------------------------------------------------+
+------------------------------+-------------+---------------------------------+
|                         SysVar reactor callback data                         |
+------------------------------+-------------+---------------------------------+
|             Name             | List length |           Parameters            |
+------------------------------+-------------+---------------------------------+
| :vlr-sysVarWillChange        | 1           | A string identifying the        |
|                              |             | system variable name.           |
+------------------------------+-------------+---------------------------------+
| :vlr-sysVarChanged           | 2           | First parameter is a string     |
|                              |             | identifying the system          |
|                              |             | variable name.Second parameter  |
|                              |             | is symbol indicating whether    |
|                              |             | or not the change was           |
|                              |             | successful (T if successful,    |
|                              |             | nil if not).                    |
+------------------------------+-------------+---------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-toolbar-reactor">vlr-toolbar-reactor</h3>

Constructs an editor reactor object that notifies of a change to the bitmaps in
a toolbar

(vlr-toolbar-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Toolbar reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Toolbar
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------------------+-------------------------------------------+
|                            Toolbar reactor events                            |
+----------------------------------+-------------------------------------------+
|            Event name            |                Description                |
+----------------------------------+-------------------------------------------+
| :vlr-toolbarBitmapSizeWillChange | The size of the AutoCAD toolbar icons is  |
|                                  | about to change.                          |
+----------------------------------+-------------------------------------------+
| :vlr-toolbarBitmapSizeChanged    | The size of the AutoCAD toolbar icons     |
|                                  | has changed.                              |
+----------------------------------+-------------------------------------------+
+----------------------------------+-------------+-----------------------------+
|                        Toolbar reactor callback data                         |
+----------------------------------+-------------+-----------------------------+
|               Name               | List length |         Parameters          |
+----------------------------------+-------------+-----------------------------+
| :vlr-toolbarBitmapSizeWillChange | 1           | T, if the toolbar is being  |
| :vlr-toolbarBitmapSizeChanged    |             | set to large bitmaps, nil   |
|                                  |             | if the toolbar is being     |
|                                  |             | set to small bitmaps.       |
+----------------------------------+-------------+-----------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-trace-reaction">vlr-trace-reaction</h3>

A pre-defined callback function that prints one or more callback arguments in
the Trace window

(vlr-trace-reaction)

This function can be used as a debugging tool to verify that a reactor has
fired.

<span class="ExamplesIdentifier">Examples</span>

Define a command reactor and assign vlr-trace-reaction as the callback
function:

_$ (VLR-Reaction-Set (VLR-Command-Reactor) :VLR-commandWillStart
'VLR-trace-reaction)

VLR-trace-reaction

At the AutoCAD Command prompt, enter the following:

 _.LINE

Respond to the command prompts, then activate the VLISP window and open the
Trace window. You should see the following in the Trace window:

; &quot;Reaction&quot;: :VLR-commandWillStart; &quot;argument list&quot;:
(#<span class="Special">&lt;VLR-COMMAND-REACTOR&gt;</span> (&quot;LINE&quot;))

The output from vlr-trace-reaction identifies the type of trigger event, the
reactor type, and the command that triggered the reactor.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-type">vlr-type</h3>

Returns a symbol representing the reactor type

(vlr-type reactor)

<span class="ArgumentsIdentifier">Arguments</span>

reactor

A VLR object.

<span class="ReturnsIdentifier">Return Values</span>

A symbol identifying the reactor type. The following table lists the types that
may be returned by vlr-type:

+----------------------------+-------------------------------------------------+
|                                Reactor types                                 |
+----------------------------+-------------------------------------------------+
|        Reactor type        |                   Description                   |
+----------------------------+-------------------------------------------------+
| :VLR-AcDb-Reactor          | Database reactor.                               |
+----------------------------+-------------------------------------------------+
| :VLR-Command-Reactor       | An editor reactor notifying of a command event. |
+----------------------------+-------------------------------------------------+
| :VLR-DeepClone-Reactor     | An editor reactor notifying of a deep clone     |
|                            | event.                                          |
+----------------------------+-------------------------------------------------+
| :VLR-DocManager-Reactor    | Document management reactor.                    |
+----------------------------+-------------------------------------------------+
| :VLR-DWG-Reactor           | An editor reactor notifying of a drawing event  |
|                            | (for example, opening or closing a drawing      |
|                            | file).                                          |
+----------------------------+-------------------------------------------------+
| :VLR-DXF-Reactor           | An editor reactor notifying of an event         |
|                            | related to reading or writing of a DXF file.    |
+----------------------------+-------------------------------------------------+
| :VLR-Editor-Reactor        | General editor reactor; maintained for          |
|                            | backward-compatibility.                         |
+----------------------------+-------------------------------------------------+
| :VLR-Insert-Reactor        | An editor reactor notifying of an event         |
|                            | related to block insertion.                     |
+----------------------------+-------------------------------------------------+
| :VLR-Linker-Reactor        | Linker reactor.                                 |
+----------------------------+-------------------------------------------------+
| :VLR-Lisp-Reactor          | An editor reactor notifying of a LISP event.    |
+----------------------------+-------------------------------------------------+
| :VLR-Miscellaneous-Reactor | An editor reactor that does not fall under any  |
|                            | of the other editor reactor types.              |
+----------------------------+-------------------------------------------------+
| :VLR-Mouse-Reactor         | An editor reactor notifying of a mouse event    |
|                            | (for example, a double-click).                  |
+----------------------------+-------------------------------------------------+
| :VLR-Object-Reactor        | Object reactor.                                 |
+----------------------------+-------------------------------------------------+
| :VLR-SysVar-Reactor        | An editor reactor notifying of a change to a    |
|                            | system variable.                                |
+----------------------------+-------------------------------------------------+
| :VLR-Toolbar-Reactor       | An editor reactor notifying of a change to the  |
|                            | bitmaps in a toolbar.                           |
+----------------------------+-------------------------------------------------+
| :VLR-Undo-Reactor          | An editor reactor notifying of an undo event.   |
+----------------------------+-------------------------------------------------+
| :VLR-Wblock-Reactor        | An editor reactor notifying of an event         |
|                            | related to writing a block.                     |
+----------------------------+-------------------------------------------------+
| :VLR-Window-Reactor        | An editor reactor notifying of an event         |
|                            | related to moving or sizing an AutoCAD window.  |
+----------------------------+-------------------------------------------------+
| :VLR-XREF-Reactor          | An editor reactor notifying of an event         |
|                            | related to attaching or modifying XREFs.        |
+----------------------------+-------------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

_$ (vlr-type circleReactor)

:VLR-Object-Reactor

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-types">vlr-types</h3>

Returns a list of all reactor types

(vlr-types)

<span class="ReturnsIdentifier">Return Values</span>

(:VLR-Linker-Reactor :VLR-Editor-Reactor :VLR-AcDb-Reactor ....)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-undo-reactor">vlr-undo-reactor</h3>

Constructs an editor reactor object that notifies of an undo event

(vlr-undo-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Undo reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Undo reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+----------------------------+-------------------------------------------------+
|                             Undo reactor events                              |
+----------------------------+-------------------------------------------------+
|         Event name         |                   Description                   |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandAuto    | The UNDO command's Auto option has been         |
|                            | executed.                                       |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandControl | The UNDO command's Control option has been      |
|                            | executed.                                       |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandBegin   | The UNDO command's BEGIN or GROUP option is     |
|                            | being performed. BEGIN and GROUP mark the       |
|                            | beginning of a series of commands that can be   |
|                            | undone as one unit.                             |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandEnd     | The UNDO command's END option is being          |
|                            | performed. UNDO/END marks the end of a series   |
|                            | of commands that can be undone as one unit.     |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandMark    | The UNDO command's MARK option is about to be   |
|                            | executed. This places a marker in the undo      |
|                            | file so UNDO/BACK can undo back to the marker.  |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandBack    | The UNDO command's BACK option is about to be   |
|                            | performed. UNDO/BACK undoes everything back to  |
|                            | the most recent MARK marker or back to the      |
|                            | beginning of the undo file if no MARK marker    |
|                            | exists.                                         |
+----------------------------+-------------------------------------------------+
| :vlr-undoSubcommandNumber  | The UNDO command's NUMBER option is about to    |
|                            | be executed (the default action of the UNDO     |
|                            | command).                                       |
+----------------------------+-------------------------------------------------+
+----------------------------+-------------+-----------------------------------+
|                          Undo reactor callback data                          |
+----------------------------+-------------+-----------------------------------+
|            Name            | List length |            Parameters             |
+----------------------------+-------------+-----------------------------------+
| :vlr-undoSubcommandAuto    | 2           | First parameter is an integer     |
|                            |             | indicating the activity. The      |
|                            |             | value is always 4, indicating     |
|                            |             | that notification occurred after  |
|                            |             | the operation was                 |
|                            |             | performed.Second parameter is a   |
|                            |             | symbol indicating the state of    |
|                            |             | Auto mode. Value is T if Auto     |
|                            |             | mode is turned on, nil if Auto    |
|                            |             | mode is turned off.               |
+----------------------------+-------------+-----------------------------------+
| :vlr-undoSubcommandControl | 2           | First parameter is an integer     |
|                            |             | indicating the activity. The      |
|                            |             | value is always 4, indicating     |
|                            |             | that notification occurred after  |
|                            |             | the operation was                 |
|                            |             | performed.Second parameter is an  |
|                            |             | integer indicating the Control    |
|                            |             | option selected. This can be one  |
|                            |             | of the following:0--NONE was      |
|                            |             | selected1--ONE was                |
|                            |             | selected2--ALL was selected       |
+----------------------------+-------------+-----------------------------------+
| :vlr-undoSubcommandBegin   | 1           | An integer value of 0,            |
| :vlr-undoSubcommandEnd     |             | indicating that notification      |
| :vlr-undoSubcommandMark    |             | occurs before the actual          |
| :vlr-undoSubcommandBack    |             | operation is performed.           |
+----------------------------+-------------+-----------------------------------+
| :vlr-undoSubcommandNumber  | 2           | First parameter is an integer     |
|                            |             | indicating the activity. The      |
|                            |             | value is always 0, indicating     |
|                            |             | that notification occurs before   |
|                            |             | the actual operation is           |
|                            |             | performed.Second parameter is an  |
|                            |             | integer indicating the number of  |
|                            |             | steps being undone.               |
+----------------------------+-------------+-----------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-wblock-reactor">vlr-wblock-reactor</h3>

Constructs an editor reactor object that notifies of an event related to
writing a block

(vlr-wblock-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Wblock reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Wblock
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+-------------------------+----------------------------------------------------+
|                            Wblock reactor events                             |
+-------------------------+----------------------------------------------------+
|       Event name        |                    Description                     |
+-------------------------+----------------------------------------------------+
| :VLR-wblockNotice       | A wblock operation is about to start.              |
+-------------------------+----------------------------------------------------+
| :VLR-beginWblockPt      | A wblock operation is being performed on a set of  |
|                         | entities.                                          |
+-------------------------+----------------------------------------------------+
| :VLR-beginWblockId      | A wblock operation is being performed on a         |
|                         | specified block.                                   |
+-------------------------+----------------------------------------------------+
| :VLR-beginWblock        | A wblock operation is being performed on an        |
|                         | entire database. Notification does not occur       |
|                         | until all the entities in the source database's    |
|                         | model space are copied into the target database.   |
+-------------------------+----------------------------------------------------+
| :VLR-endWblock          | A wblock operation completed successfully.         |
+-------------------------+----------------------------------------------------+
| :VLR-beginWblockObjects | wblock has just initialized the object ID          |
|                         | translation map.                                   |
+-------------------------+----------------------------------------------------+
+------------------------------+-------------+---------------------------------+
|                         Wblock reactor callback data                         |
+------------------------------+-------------+---------------------------------+
|             Name             | List length |           Parameters            |
+------------------------------+-------------+---------------------------------+
| :VLR-wblockNotice            | 1           | Database object (VLA-object)    |
|                              |             | from which the block will be    |
|                              |             | created.                        |
+------------------------------+-------------+---------------------------------+
| :VLR-beginWblockPt           | 3           | First parameter is the target   |
|                              |             | database object                 |
|                              |             | (VLA-object).Second parameter   |
|                              |             | is the source database object   |
|                              |             | (VLA-object) containing the     |
|                              |             | objects being wblocked.Third    |
|                              |             | parameters is a 3D point list   |
|                              |             | (in WCS) to be used as the      |
|                              |             | base point in the target        |
|                              |             | database.                       |
+------------------------------+-------------+---------------------------------+
| :VLR-beginWblockId           | 3           | First parameter is the target   |
|                              |             | database object                 |
|                              |             | (VLA-object).Second parameter   |
|                              |             | is the source database object   |
|                              |             | (VLA-object) containing the     |
|                              |             | objects being wblocked.Third    |
|                              |             | parameter is the object ID of   |
|                              |             | the BlockTableRecord being      |
|                              |             | wblocked.                       |
+------------------------------+-------------+---------------------------------+
| :VLR-beginWblock             | 2           | First parameter is the target   |
| :VLR-otherWblock             |             | database object                 |
|                              |             | (VLA-object).Second parameter   |
|                              |             | is the source database object   |
|                              |             | (VLA-object) containing the     |
|                              |             | objects being wblocked.         |
+------------------------------+-------------+---------------------------------+
| :VLR-abortWblock             | 1           | The target database object      |
| :VLR-endWblock               |             | (VLA-object).                   |
+------------------------------+-------------+---------------------------------+
| :VLR-beginWblockObjects      | 2           | First parameter is the source   |
|                              |             | database object (VLA-object)    |
|                              |             | containing the objects being    |
|                              |             | wblocked.Second parameter is    |
|                              |             | an ID map.                      |
+------------------------------+-------------+---------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-window-reactor">vlr-window-reactor</h3>

Constructs an editor reactor object that notifies of an event related to moving
or sizing an AutoCAD window

(vlr-window-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the Window reactor events
table below, and callback_function is a symbol representing a function to be
called when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table Window
reactor callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+------------------------------+-----------------------------------------------+
|                            Window reactor events                             |
+------------------------------+-----------------------------------------------+
|          Event name          |                  Description                  |
+------------------------------+-----------------------------------------------+
| :vlr-docFrameMovedOrResized  | An MDI child frame window (a document         |
|                              | window) has been moved or resized.            |
+------------------------------+-----------------------------------------------+
| :vlr-mainFrameMovedOrResized | The main AutoCAD window has been moved or     |
|                              | resized.                                      |
+------------------------------+-----------------------------------------------+
+------------------------------+-------------+---------------------------------+
|                         Window reactor callback data                         |
+------------------------------+-------------+---------------------------------+
|             Name             | List length |           Parameters            |
+------------------------------+-------------+---------------------------------+
| :vlr-docFrameMovedOrResized  | 2           | The first parameter is an       |
| :vlr-mainFrameMovedOrResized |             | integer containing the HWND of  |
|                              |             | the window.The second           |
|                              |             | parameter indicates whether     |
|                              |             | the window has been moved or    |
|                              |             | resized. The value is T if the  |
|                              |             | window has been moved, nil if   |
|                              |             | the window has been resized.    |
+------------------------------+-------------+---------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vlr-xref-reactor">vlr-xref-reactor</h3>

Constructs an editor reactor object that notifies of an event related to
attaching or modifying XREFs

(vlr-xref-reactor data callbacks)

<span class="ArgumentsIdentifier">Arguments</span>

data

Any AutoLISP data to be associated with the reactor object, or nil, if no data.

callbacks

A list of pairs of the following form:

(event-name . callback_function)

where event-name is one of the symbols listed in the XREF reactor events table
below, and callback_function is a symbol representing a function to be called
when the event fires. Each callback function accepts two arguments:

reactor_object The VLR object that called the callback function.

list A list of extra data elements associated with the particular event. The
contents of this list for particular events is shown in the table XREF reactor
callback data.

<span class="ReturnsIdentifier">Return Values</span>

The reactor_object argument.

+--------------------------------+---------------------------------------------+
|                             XREF reactor events                              |
+--------------------------------+---------------------------------------------+
|           Event name           |                 Description                 |
+--------------------------------+---------------------------------------------+
| :VLR-beginAttach               | An XREF is about to be attached.            |
+--------------------------------+---------------------------------------------+
| :VLR-otherAttach               | An external reference is being added to     |
|                                | the drawing database. This event occurs     |
|                                | after objects are cloned, but before any    |
|                                | translation. This callback function is      |
|                                | sent just after beginDeepCloneXlation       |
|                                | notification, but only occurs for the XREF  |
|                                | attach process.                             |
+--------------------------------+---------------------------------------------+
| :VLR-abortAttach               | An XREF attach operation was terminated     |
|                                | before successful completion.               |
+--------------------------------+---------------------------------------------+
| :VLR-endAttach                 | An XREF attach operation completed          |
|                                | successfully.                               |
+--------------------------------+---------------------------------------------+
| :VLR-redirected                | An object ID in the XREF drawing is being   |
|                                | modified to point to the associated object  |
|                                | in the drawing being XREFed into.           |
+--------------------------------+---------------------------------------------+
| :VLR-comandeered               | The object ID of the object is being        |
|                                | appended to the symbol table of the         |
|                                | drawing being XREFed into.                  |
+--------------------------------+---------------------------------------------+
| :VLR-beginRestore              | An existing XREF is about to be resolved    |
|                                | (typically when a drawing with XREFs is     |
|                                | loading).                                   |
+--------------------------------+---------------------------------------------+
| :VLR-abortRestore              | An XREF unload or reload was terminated     |
|                                | before successful completion.               |
+--------------------------------+---------------------------------------------+
| :VLR-endRestore                | An existing XREF has been resolved          |
|                                | (typically when a drawing with XREFs has    |
|                                | completed loading).                         |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandBindItem    | The BIND subcommand of XREF was invoked,    |
|                                | or a pre-existing xref is being bound.      |
|                                | <span class="Todo">Note</span> that the BIND subcommand is            |
|                                | interactive and triggers multiple events.   |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandAttachItem  | The ATTACH subcommand of XREF was invoked,  |
|                                | or a pre-existing xref is being             |
|                                | resolved.<span class="Todo">Note</span> that the ATTACH subcommand    |
|                                | is interactive and triggers multiple        |
|                                | events.                                     |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandOverlayItem | The OVERLAY subcommand of XREF was          |
|                                | invoked, or a pre-existing xref is being    |
|                                | resolved.<span class="Todo">Note</span> that the OVERLAY subcommand   |
|                                | is interactive and triggers multiple        |
|                                | events.                                     |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandDetachItem  | The DETACH subcommand of XREF was           |
|                                | invoked.<span class="Todo">Note</span> that the OVERLAY subcommand    |
|                                | is interactive and triggers multiple        |
|                                | events.                                     |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandPathItem    | The PATH subcommand of XREF was             |
|                                | invoked.<span class="Todo">Note</span> that the PATH subcommand is    |
|                                | interactive and triggers multiple events.   |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandReloadItem  | The RELOAD subcommand of XREF was invoked,  |
|                                | or a pre-existing xref is being             |
|                                | reloaded.<span class="Todo">Note</span> that the RELOAD subcommand    |
|                                | is interactive and triggers multiple        |
|                                | events.                                     |
+--------------------------------+---------------------------------------------+
| :VLR-xrefSubcommandUnloadItem  | The UNLOAD subcommand of XREF was invoked,  |
|                                | or a pre-existing xref is being unloaded.   |
+--------------------------------+---------------------------------------------+
+--------------------------------+-------------+-------------------------------+
|                          XREF reactor callback data                          |
+--------------------------------+-------------+-------------------------------+
|              Name              | List length |          Parameters           |
+--------------------------------+-------------+-------------------------------+
| :VLR-beginAttach               | 3           | First parameter is a          |
|                                |             | VLA-object pointing to the    |
|                                |             | target drawing                |
|                                |             | database.Second parameter is  |
|                                |             | a string containing the file  |
|                                |             | name of the xref being        |
|                                |             | attached.Third parameter is   |
|                                |             | a VLA-object pointing to the  |
|                                |             | drawing database that         |
|                                |             | contains the objects being    |
|                                |             | attached.                     |
+--------------------------------+-------------+-------------------------------+
| :VLR-otherAttach               | 2           | First parameter is a          |
|                                |             | VLA-object pointing to the    |
|                                |             | target drawing                |
|                                |             | database.Second parameter is  |
|                                |             | a VLA-object pointing to the  |
|                                |             | drawing database that         |
|                                |             | contains the objects being    |
|                                |             | attached.                     |
+--------------------------------+-------------+-------------------------------+
| :VLR-abortAttach               | 1           | A VLA-object pointing to the  |
|                                |             | drawing database that         |
|                                |             | contains the objects being    |
|                                |             | attached.                     |
+--------------------------------+-------------+-------------------------------+
| :VLR-endAttach                 | 1           | A VLA-object pointing to the  |
|                                |             | target drawing database.      |
+--------------------------------+-------------+-------------------------------+
| :VLR-redirected                | 2           | First parameter is an         |
|                                |             | integer containing the        |
|                                |             | object ID for the redirected  |
|                                |             | symbol table record (STR) in  |
|                                |             | the drawing being XREFed      |
|                                |             | to.Second parameter is an     |
|                                |             | integer containing the        |
|                                |             | object ID for the object in   |
|                                |             | the xref drawing.             |
+--------------------------------+-------------+-------------------------------+
| :VLR-comandeered               | 3           | First parameter is a          |
|                                |             | VLA-object pointing to the    |
|                                |             | database receiving the        |
|                                |             | XREF.Second parameter is an   |
|                                |             | integer containing the        |
|                                |             | object ID of the object       |
|                                |             | being commandeered.Third      |
|                                |             | parameter is a VLA-object     |
|                                |             | pointing to the drawing       |
|                                |             | database that contains the    |
|                                |             | objects being attached.       |
+--------------------------------+-------------+-------------------------------+
| :VLR-beginRestore              | 3           | First parameter is a          |
|                                |             | VLA-object pointing to the    |
|                                |             | database receiving the        |
|                                |             | XREF.Second parameter is a    |
|                                |             | string containing the XREF    |
|                                |             | block table record (BTR)      |
|                                |             | name.Third parameter is a     |
|                                |             | VLA-object pointing to the    |
|                                |             | drawing database that         |
|                                |             | contains the objects being    |
|                                |             | attached.                     |
+--------------------------------+-------------+-------------------------------+
| :VLR-abortRestore              | 1           | A VLA-object pointing to the  |
| :VLR-endRestore                |             | target drawing database.      |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandBindItem    | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the BIND is          |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.7--Sent   |
|                                |             | for an XDep block bound by    |
|                                |             | XBind.8--Sent for all other   |
|                                |             | symbols: Layers, Linetypes,   |
|                                |             | TextStyles, and               |
|                                |             | DimStyles.Second parameter    |
|                                |             | is an integer containing the  |
|                                |             | object ID of the xref being   |
|                                |             | bound, or 0 if not            |
|                                |             | applicable.                   |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandAttachItem  | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the ATTACH is        |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is a string         |
|                                |             | identifying the file being    |
|                                |             | attached, or nil if not       |
|                                |             | applicable.                   |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandOverlayItem | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the OVERLAY is       |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is a string         |
|                                |             | identifying the file being    |
|                                |             | overlaid, or nil if not       |
|                                |             | applicable.                   |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandDetachItem  | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the DETACH is        |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is an integer       |
|                                |             | containing the object ID of   |
|                                |             | the xref being detached, or   |
|                                |             | 0 if not applicable.          |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandPathItem    | 3           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the DETACH is        |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is an integer       |
|                                |             | containing the object ID of   |
|                                |             | the xref being operated on,   |
|                                |             | or 0 if not applicable.Third  |
|                                |             | parameter is a string         |
|                                |             | identifying the new path      |
|                                |             | name of the xref, or nil if   |
|                                |             | not applicable.               |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandReloadItem  | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the RELOAD is        |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is an integer       |
|                                |             | containing the object ID of   |
|                                |             | the xref being reloaded, or   |
|                                |             | 0 if not applicable.          |
+--------------------------------+-------------+-------------------------------+
| :VLR-xrefSubcommandUnloadItem  | 2           | First parameter is an         |
|                                |             | integer indicating the        |
|                                |             | activity the UNLOAD is        |
|                                |             | carrying out. Possible        |
|                                |             | values are:0--BIND            |
|                                |             | subcommand invoked.2--xref    |
|                                |             | with the indicated object ID  |
|                                |             | is being bound.3--xref with   |
|                                |             | the indicated object ID was   |
|                                |             | successfully bound.4--BIND    |
|                                |             | subcommand completed.5--BIND  |
|                                |             | operation is about to either  |
|                                |             | terminate or fail to          |
|                                |             | complete on the specified     |
|                                |             | object ID.6--BIND operation   |
|                                |             | has either terminated or      |
|                                |             | failed to complete on the     |
|                                |             | specified object ID.Second    |
|                                |             | parameter is an integer       |
|                                |             | containing the object ID of   |
|                                |             | the xref being unloaded, or   |
|                                |             | 0 if not applicable.          |
+--------------------------------+-------------+-------------------------------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="vports">vports</h3>

Returns a list of viewport descriptors for the current viewport configuration

(vports)

<span class="ReturnsIdentifier">Return Values</span>

One or more viewport descriptor lists consisting of the viewport identification
number and the coordinates of the viewport's lower-left and upper-right
corners.

If the AutoCAD TILEMODE system variable is set to 1 (on), the returned list
describes the viewport configuration created with the AutoCAD VPORTS command.
The corners of the viewports are expressed in values between 0.0 and 1.0, with
(0.0, 0.0) representing the lower-left corner of the display screen's graphics
area, and (1.0, 1.0) the upper-right corner. If TILEMODE is 0 (off), the
returned list describes the viewport objects created with the MVIEW command.
The viewport object corners are expressed in paper space coordinates. Viewport
number 1 is always paper space when TILEMODE is off.

<span class="ExamplesIdentifier">Examples</span>

Given a single-viewport configuration with TILEMODE on, the vports function
might return the following:

((1 (0.0 0.0) (1.0 1.0)))

Given four equal-sized viewports located in the four corners of the screen when
TILEMODE is on, the vports function might return the following lists:

((5 (0.5 0.0) (1.0 0.5))

 (2 (0.5 0.5) (1.0 1.0))

 (3 (0.0 0.5) (0.5 1.0))

 (4 (0.0 0.0) (0.5 0.5)) )

The current viewport's descriptor is always first in the list. In the previous
example, viewport number 5 is the current viewport.

<span class="PreProc">================================ W Functions ===================================</span>

<h3 class="String" id="wcmatch">wcmatch</h3>

Performs a wild-card pattern match on a string

(wcmatch string pattern)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string to be compared. The comparison is case-sensitive, so upper- and
lowercase characters must match.

pattern

A string containing the pattern to match against string. The pattern can
contain the wild-card pattern-matching characters shown in the table Wild-card
characters. You can use commas in a pattern to enter more than one pattern
condition. Only the first 500 characters (approximately) of the string and
pattern are compared; anything beyond that is ignored.

Both arguments can be either a quoted string or a string variable. It is valid
to use variables and values returned from AutoLISP functions for string and
pattern values.

<span class="ReturnsIdentifier">Return Values</span>

If string and pattern match, wcmatch returns T, otherwise, wcmatch returns nil.

+----------------------+-------------------------------------------------------+
|                             Wild-card characters                             |
+----------------------+-------------------------------------------------------+
|      Character       |                      Definition                       |
+----------------------+-------------------------------------------------------+
| # (pound)            | Matches any single numeric digit                      |
+----------------------+-------------------------------------------------------+
| @ (at)               | Matches any single alphabetic character               |
+----------------------+-------------------------------------------------------+
| . (period)           | Matches any single nonalphanumeric character          |
+----------------------+-------------------------------------------------------+
| * (asterisk)         | Matches any character sequence, including an empty    |
|                      | one, and it can be used anywhere in the search        |
|                      | pattern: at the beginning, middle, or end             |
+----------------------+-------------------------------------------------------+
| ? (question mark)    | Matches any single character                          |
+----------------------+-------------------------------------------------------+
| ~ (tilde)            | If it is the first character in the pattern, it       |
|                      | matches anything except the pattern                   |
+----------------------+-------------------------------------------------------+
| [...]                | Matches any one of the characters enclosed            |
+----------------------+-------------------------------------------------------+
| [~...]               | Matches any single character not enclosed             |
+----------------------+-------------------------------------------------------+
| - (hyphen)           | Used inside brackets to specify a range for a single  |
|                      | character                                             |
+----------------------+-------------------------------------------------------+
| , (comma)            | Separates two patterns                                |
+----------------------+-------------------------------------------------------+
| ` (reverse quote)    | Escapes special characters (reads next character      |
|                      | literally)                                            |
+----------------------+-------------------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

The following command tests a string to see if it begins with the character <span class="Special">N</span>:

Command: (wcmatch &quot;Name&quot; &quot;<span class="Special">N</span>*&quot;)

T

The following example performs three comparisons. If any of the three pattern
conditions is met, wcmatch returns T. In this case the tests are: does the
string contain three characters; does the string not contain an m; and does the
string begin with the letter &quot;<span class="Special">N</span>.&quot; If any of the three pattern conditions is
met, wcmatch returns T:

: (wcmatch &quot;Name&quot; &quot;???,~*m*,<span class="Special">N</span>*&quot;)

T

In this example, the last condition was met, so wcmatch returned T.

Using Escape Characters with wcmatch

To test for a wild-card character in a string, you can use the single
reverse-quote character (`) to escape the character. Escape means that the
character following the single reverse quote is not read as a wild-card
character; it is compared at its face value. For example, to search for a comma
anywhere in the string &quot;Name&quot;, enter the following:

Command: (wcmatch &quot;Name&quot; &quot;*`,*&quot;)

nil

Both the C and AutoLISP programming languages use the backslash (\) as an
escape character, so you need two backslashes (\\) to produce one backslash in
a string. To test for a backslash character anywhere in &quot;Name&quot;, use the
following function call:

Command: (wcmatch &quot;Name&quot; &quot;*`\\*&quot;)

nil

All characters enclosed in brackets ([ . . . ]) are read literally, so there is
no need to escape them, with the following exceptions: the tilde character (~)
is read literally only when it is not the first bracketed character (as in
&quot;[A~BC]&quot;); otherwise it is read as the negation character, meaning that wcmatch
should match all characters except those following the tilde (as in &quot;[~ABC]&quot;).
The dash character (-) is read literally only when it is the first or last
bracketed character (as in &quot;[-ABC]&quot; or &quot;[ABC-]&quot;) or when it follows a leading
tilde (as in &quot;[~-ABC]&quot;). Otherwise, the dash character (-) is used within
brackets to specify a range of values for a specific character. The range works
only for single characters, so &quot;STR[1-38]&quot; matches STR1, STR2, STR3, and STR8,
and &quot;[A-Z]&quot; matches any single uppercase letter.

The closing bracket character (]) is also read literally if it is the first
bracketed character or if it follows a leading tilde (as in &quot;[ ]ABC]&quot; or
&quot;[~]ABC]&quot;).

<span class="Todo">Note</span>:  Because additional wild-card characters might be added in future
releases of AutoLISP, it is a good idea to escape all nonalphanumeric
characters in your pattern to ensure upward compatibility.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="while">while</h3>

Evaluates a test expression, and if it is not nil, evaluates other expressions;
repeats this process until the test expression evaluates to nil

(while testexpr [expr...])

The while function continues until testexpr is nil.

<span class="ArgumentsIdentifier">Arguments</span>

testexpr

The expression containing the test condition.

expr

One or more expressions to be evaluated until testexpr is nil.

<span class="ReturnsIdentifier">Return Values</span>

The most recent value of the last expr.

<span class="ExamplesIdentifier">Examples</span>

The following code calls user function some-func ten times, with test set to 1
through 10. It then returns 11, which is the value of the last expression
evaluated:

(setq test 1)

(while (&lt;= test 10)

 (some-func test)

 (setq test (1+ test))

)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="write-char">write-char</h3>

Writes one character to the screen or to an open file

(write-char num <span class="Special">[file-desc]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

num

The decimal ASCII code for the character to be written.

file-desc

A file descriptor for an open file.

<span class="ReturnsIdentifier">Return Values</span>

The num argument.

<span class="ExamplesIdentifier">Examples</span>

The following command writes the letter C to the command window, and returns
the supplied num argument:

Command: (write-char 67)

C67

Assuming that f is the descriptor for an open file, the following command
writes the letter C to that file:

Command: (write-char 67 f)

67

<span class="Todo">Note</span> that write-char cannot write a NULL character (ASCII code 0) to a file.

See Also

The Customization Guide for a list of ASCII codes.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="write-line">write-line</h3>

Writes a string to the screen or to an open file

(write-line string <span class="Special">[file-desc]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

string

A string.

file-desc

A file descriptor for an open file.

<span class="ReturnsIdentifier">Return Values</span>

The string, quoted in the normal manner. The quotes are omitted when writing to
a file.

<span class="ExamplesIdentifier">Examples</span>

Open a new file:

Command: (setq f (open &quot;c:\\my documents\\new.tst&quot; &quot;w&quot;))

#&lt;file &quot;c:\\my documents\\new.tst&quot;&gt;

Use write-line to write a line to the file:

Command: (write-line &quot;To boldly go where nomad has gone before.&quot; f)

&quot;To boldly go where nomad has gone before.&quot;

The line is not physically written until you close the file:

Command: (close f)

nil

<span class="PreProc">================================ X Functions ===================================</span>

<h3 class="String" id="xdroom">xdroom</h3>

Returns the amount of extended data (xdata) space that is available for an
object (entity)

(xdroom ename)

Because there is a limit (currently, 16 kilobytes) on the amount of extended
data that can be assigned to an entity definition, and because multiple
applications can append extended data to the same entity, this function is
provided so an application can verify there is room for the extended data that
it will append. It can be called in conjunction with xdsize , which returns the
size of an extended data list.

<span class="ArgumentsIdentifier">Arguments</span>

ename

An entity name (ename data type).

<span class="ReturnsIdentifier">Return Values</span>

An integer reflecting the number of bytes of available space. If unsuccessful,
xdroom returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following example looks up the available space for extended data of a
viewport object:

Command: (xdroom vpname)

16162

In this example, 16,162 bytes of the original 16,383 bytes of extended data
space are available, meaning that 221 bytes are used.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="xdsize">xdsize</h3>

Returns the size (in bytes) that a list occupies when it is linked to an object
(entity) as extended data

(xdsize lst)

<span class="ArgumentsIdentifier">Arguments</span>

lst

A valid list of extended data that contain an application name previously
registered with the use of the regapp function. See the <span class="ExamplesIdentifier">Examples</span> section of
this function for lst examples.

<span class="ReturnsIdentifier">Return Values</span>

An integer reflecting the size, in bytes. If unsuccessful, xdsize returns nil.

Brace fields (group code 1002) must be balanced. An invalid lst generates an
error and places the appropriate error code in the ERRNO variable. If the
extended data contains an unregistered application name, you see this error
message (assuming that CMDECHO is on):

Invalid application name in 1001 group

<span class="ExamplesIdentifier">Examples</span>

The lst can start with a -3 group code (the extended data sentinel), but it is
not required. Because extended data can contain information from multiple
applications, the list must have a set of enclosing parentheses.

(-3 (&quot;MYAPP&quot; (1000 . &quot;SUITOFARMOR&quot;)

     (1002 . &quot;{&quot;)

     (1040 . 0.0)

     (1040 . 1.0)

     (1002 . &quot;}&quot;)

    )

)

Here is the same example without the -3 group code. This list is just the cdr
of the first example, but it is important that the enclosing parentheses are
included:

( (&quot;MYAPP&quot; (1000 . &quot;SUITOFARMOR&quot;)

   (1002 . &quot;{&quot;)

   (1040 . 0.0)

   (1040 . 1.0)

   (1002 . &quot;}&quot;)

  )

)

<span class="PreProc">================================ Z Functions ===================================</span>

<h3 class="String" id="zerop">zerop</h3>

Verifies that a number evaluates to zero

(zerop number)

<span class="ArgumentsIdentifier">Arguments</span>

number

A number.

<span class="ReturnsIdentifier">Return Values</span>

T if number evaluates to zero, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

Command: (zerop 0)

T

Command: (zerop 0.0)

T

Command: (zerop 0.0001)

nil

<span class="PreProc">=========================Externally Defined Commands===========================</span>

AutoCAD(R) commands defined by ObjectARX(R) or AutoLISP(R) applications are
called externally defined. AutoLISP applications may need to access externally
defined commands differently from the way they access built-in AutoLISP
functions. Many externally defined commands have their own programming
interfaces that allow AutoLISP applications to take advantage of their
functionality.

For additional information on the commands described in this appendix, see the
Command Reference.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="3dsin">3dsin</h3>

Imports a 3D Studio (.3ds) file (Externally-defined: render ARX application)

(c:3dsin mode [multimat create] file)

<span class="ArgumentsIdentifier">Arguments</span>

mode

An integer that specifies whether the command is to be used interactively (mode
= 1) or noninteractively (mode = 0).

multimat

An integer that specifies how to treat objects with multiple materials.
Required if mode is set to 0. Allowable values are:

0 Create a new object for each material

1 Assign the first material to the new object

create

An integer that specifies how to organize new objects. This mode always imports
all the objects in the .3ds file. Required if mode is set to 0. Allowable
values are:

0 Create a layer for each 3DS object

1 Create a layer for each 3DS color

2 Create a layer for each 3DS material

3 Place all new objects on a single layer

file

A string specifying the 3DS file to import; the .3ds file extension is
required.

Mode 0 always imports all the objects in the 3DS file.

<span class="ExamplesIdentifier">Examples</span>

Open the 3D Studio file globe.3ds for import and prompt the user for import
specifics:

(c:3dsin 1 &quot;globe.3ds&quot;)

Import all of shadow.3ds with no user input, splitting objects with multiple
materials and putting all new objects on the same layer:

Command: (c:3dsin 0 0 3 &quot;c:/my documents/cad drawings/shadow.3ds&quot;)

Initializing Render...

Initializing preferences...done.

Processing object B_Leg01

Converting material SKIN

Processing object B_Leg02

Processing object Central_01

Processing object Central_02

Processing object F_Leg01

Processing object F_Leg02

Processing object M_Quad01

Processing object ML_Feele01

Processing object ML_Feele02

Processing object Pre_Quad01

Processing object Pre_Quad02

3D Studio file import completed

1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="3dsout">3dsout</h3>

Exports a 3D Studio file (Externally-defined: render ARX application)

(c:3dsout sset omode div smooth weld file)

<span class="ArgumentsIdentifier">Arguments</span>

sset

A selection set containing the AutoCAD objects to export.

omode

An integer (0 or 1) that specifies the output mode for the representation of
AutoCAD data. Currently, 3dsout output is the same whether omode is set to 0 or
1

div

An integer that specifies how to divide AutoCAD objects into 3D Studio objects.
Allowable values are:

0 Create one object for each AutoCAD layer

1 Create one object for each AutoCAD color

2 Create one object for each AutoCAD object type

smooth

An integer that specifies the threshold angle for automatic smoothing. If
smooth is set to -1, no auto-smoothing is done; if smooth is set to 0-360,
AutoCAD generates smoothing when the angle between face normals is less than
this value.

weld

A real number that specifies the distance threshold for welding nearby
vertices. If weld is set to a value less than 0, welding is disabled; if weld
is set to a value greater than or equal to 0, AutoCAD welds vertices closer
than this value.

file

A string specifying the name of the 3D Studio file to create; the .3ds file
extension is required.

<span class="ExamplesIdentifier">Examples</span>

Export all of a drawing, creating 3D Studio objects based on drawing layer,
using a smoothing threshold of 30 degrees and a welding distance of 0.1:

(c:3dsout (ssget &quot;X&quot;) 0 0 30 0.1 &quot;testav.3ds&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="align">align</h3>

Translates and rotates objects, allowing them to be aligned with other objects
(Externally-defined: geom3d ARX application)

(align arg1 arg2 ...)

<span class="ArgumentsIdentifier">Arguments</span>

arg1 arg2...

<span class="ArgumentsIdentifier">Arguments</span> to the AutoCAD align command. The order, number, and type of
arguments for the align function are the same as if you were entering ALIGN at
the command line.

To indicate a null response (a user pressing ENTER), specify nil or an empty
string (&quot;&quot;).

<span class="ReturnsIdentifier">Return Values</span>

T if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following example specifies two pairs of source and destination points,
which perform a 2D move:

(setq ss (ssget))

(align ss s1 d1 s2 d2 &quot;&quot; &quot;2d&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="cal">cal</h3>

Invokes the on-line geometry calculator and returns the value of the evaluated
expression (Externally-defined: geomcal ARX application)

(c:cal expression)

<span class="ArgumentsIdentifier">Arguments</span>

expression

A quoted string. Refer to CAL in the Command Reference for a description of
allowable expressions.

<span class="ReturnsIdentifier">Return Values</span>

The result of the expression.

<span class="ExamplesIdentifier">Examples</span>

The following example uses cal in an AutoLISP expression with the trans
function:

(trans (c:cal &quot;[1,2,3]+MID&quot;) 1 2)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="fog">fog</h3>

Adds distance from the view (Externally-defined: render ARX application)

(c:fog enabled [color [near_dist [far_dist [near_percent [far_percent
[background]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

enabled

A string that turns fog on and off without affecting other settings. Default is
ON.

color

A 3Dpoint specifying a standard AutoCAD color. Default is (111).

near_dist

A real number defining where the fog starts. Default is 0.0.

far_dist

A real number defining where the fog ends. Default is 1.0.

near_percent

A real number defining the percentage of fog at the start of the bank. Default
is 0.0.

far_percent

A real number defining the percentage of fog at the end of the bank. Default is
1.0.

background

A string that applies fog to the background as well as to the geometry. Default
is OFF (do not apply fog to the background).

With the FOG command, you can provide visual information about the distance of
objects from the view's eye. To maximize fog, add white to an image; to
maximize depth cueing, add black.

Nil or missing trailing arguments are not changed.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="light">light</h3>

Creates, modifies, and deletes lights and lighting effects (Externally-defined:
render ARX application)

(c:light mode <span class="Special">[options]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

mode

A string indicating the action to be performed. Allowable mode values are:

A Set or retrieve ambient light intensity

D Delete existing lights

L List all lights in the drawing or return a definition of a specified light

M Modify existing lights

ND Create a new distant light

NP Create a new point light

NS Create a new spotlight

R Rename an existing light

options

The options allowed depend on the mode and are listed separately for each mode.

<span class="Todo">Note</span>:  This command is not allowed in paper space.

A--Ambient Light

Set or retrieve the ambient light intensity.

(c:light &quot;A&quot; [intensity [color ]])

<span class="ArgumentsIdentifier">Arguments</span>

intensity

A real number from 0.0 to 1.0; if intensity is omitted, it defaults to 1.0.

color

A list that specifies any RGB triplet; if omitted, it defaults to (1.0 1.0
1.0).

<span class="ExamplesIdentifier">Examples</span>

To set ambient light intensity to 0.6, issue the following:

Command: (c:light &quot;A&quot; 0.6)

1

To retrieve the current ambient light intensity, omit the intensity argument:

Command: (c:light &quot;A&quot;)

(0.6 (1.0 1.0 1.0))

The intensity returned is 0.6, and the color is 1.0 1.0 1.0.

D--Delete Lights

Delete existing lights.

(c:light &quot;D&quot; name)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string specifying the name of the light to delete.

<span class="ExamplesIdentifier">Examples</span>

The following function call deletes a light named &quot;OLDLGT&quot;:

(c:light &quot;D&quot; &quot;OLDLGT&quot;)

L--List Lights

List all lights in the drawing or return a definition of the specified light.

(c:light &quot;L&quot; <span class="Special">[name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string specifying the name of the light to list. If you omit the name
argument, c:light returns a list of all the lights defined in the drawing.

<span class="ExamplesIdentifier">Examples</span>

The following command lists all lights defined in the current drawing:

Command: (c:light &quot;L&quot;)

(&quot;BUDLIGHT&quot; &quot;LIGHT01&quot;)

The following command lists the properties of a light named &quot;LIGHT01&quot;:

Command: (c:light &quot;L&quot; &quot;LIGHT01&quot;)

(&quot;P&quot; &lt;Entity name: 4cf3ae8&gt; 1.0 (26.5609 43.423 48.6995) (0.0 0.0 0.0)

(0.705882 0.705882 0.705882) 512 nil nil 3.0 &quot;OFF&quot; 0 nil)

M--Modify Lights

Modifies existing lights.

(c:light &quot;M&quot; name [intensity [from [to [color [shadowmapsize [hotspot [falloff
[shadowsoftness [shadow [shadowobjects [month [day [hour [minute [daylight
[latitude [longitude <span class="Special">[attenuation]</span>]]]]]]]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The arguments for the Modify mode are described in the following table:

+-----------------------+-----------+----------------------+-------------------+
|                          LIGHT--&quot;M&quot; mode arguments                           |
+-----------------------+-----------+----------------------+-------------------+
|       Argument        | Data type |     Description      |      Default      |
+-----------------------+-----------+----------------------+-------------------+
| name                  | STR       | Unique light name    | None              |
+-----------------------+-----------+----------------------+-------------------+
| intensity             | REAL      | A real number from   | Based on          |
|                       |           | 0.0 to the default   | attenuation       |
|                       |           | maximum              |                   |
+-----------------------+-----------+----------------------+-------------------+
| from                  | LIST      | Light location       | Current           |
|                       |           |                      | look-from point   |
+-----------------------+-----------+----------------------+-------------------+
| to                    | LIST      | Light target         | Current look-at   |
|                       |           |                      | point             |
+-----------------------+-----------+----------------------+-------------------+
| color                 | LIST      | Any RGB triplet      | 1.0, 1.0, 1.0     |
+-----------------------+-----------+----------------------+-------------------+
| shadowmapsize         | INT       | Integer from 0 to    | 0                 |
|                       |           | 4096 (the size, in   |                   |
|                       |           | pixels, of one side  |                   |
|                       |           | of the shadow map)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| hotspot               | REAL      | Angle of the         | 44.0              |
|                       |           | brightness beam in   |                   |
|                       |           | degrees (must be in  |                   |
|                       |           | the range of 1-160)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| falloff               | REAL      | Angle that includes  | 45.0              |
|                       |           | the rapid decay      |                   |
|                       |           | area, in degrees     |                   |
|                       |           | (must be in the      |                   |
|                       |           | range 0-160 and      |                   |
|                       |           | greater than the     |                   |
|                       |           | hotspot value)       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowsoftness        | REAL      | Real number in the   | 0.0               |
|                       |           | range 0.0-10.0       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadow                | STR       | Shadow-casting       | 0.0               |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no shadows) and     |                   |
|                       |           | &quot;on&quot; (cast shadows)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowobjects         | ENAME     | A selection of       | 0.0               |
|                       |           | objects that bound   |                   |
|                       |           | the shadow maps      |                   |
+-----------------------+-----------+----------------------+-------------------+
| month                 | INT       | Integer from 1 to 12 | 9                 |
+-----------------------+-----------+----------------------+-------------------+
| day                   | INT       | Integer from 1 to 31 | 21                |
+-----------------------+-----------+----------------------+-------------------+
| hour                  | INT       | Integer from 0 to 24 | 15                |
+-----------------------+-----------+----------------------+-------------------+
| minute                | INT       | Integer from 0 to 59 | 0                 |
+-----------------------+-----------+----------------------+-------------------+
| daylight              | STR       | Daylight savings     | &quot;off&quot;             |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no daylight         |                   |
|                       |           | savings) and &quot;on&quot;    |                   |
|                       |           | (daylight savings)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| latitude              | REAL      | Real number in the   | 37.62             |
|                       |           | range 0-90           |                   |
+-----------------------+-----------+----------------------+-------------------+
| longitude             | REAL      | Real number in the   | 122.37            |
|                       |           | range 0-180          |                   |
+-----------------------+-----------+----------------------+-------------------+
| timezone              | INT       | Integer from -12 to  | 8 (PST)           |
|                       |           | 12, representing     |                   |
|                       |           | the hours behind     |                   |
|                       |           | Greenwich Mean Time  |                   |
|                       |           | (GMT)                |                   |
+-----------------------+-----------+----------------------+-------------------+
| attenuation           | INT       | 0 = no attenuation   | 1                 |
|                       |           | 1 = inverse linear   |                   |
|                       |           | attenuation          |                   |
|                       |           | 2 = inverse square   |                   |
|                       |           | attenuation          |                   |
+-----------------------+-----------+----------------------+-------------------+
The hotspot and falloff arguments apply only to spotlights. You must pass them
as nil when you create a new distant light.

You can specify nil for any argument that does not apply to the type of light
you are modifying, or if you want the property affected by the argument to
retain its current value. You can omit any arguments located at the end of the
argument list (for example, attenuation, or attenuation and timezone, or
attenuation, timezone, and longitude...).

<span class="ExamplesIdentifier">Examples</span>

The following code changes the color of the distant light named &quot;D1&quot; to blue:

(c:light &quot;M&quot; &quot;D1&quot; nil nil nil '(0.0 0.0 1.0))

ND--New Distant Light

Create a new distant light.

(c:light &quot;ND&quot; name [intensity [from [to [color [shadowmapsize [ nil [ nil
[shadowsoftness [shadow [month [day [hour [minute [daylightsavings [latitude
[longitude [timezone [attenuation <span class="Special">[shadowobjects]</span>]]]]]]]]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The arguments for the New Distant Light mode are described in the following
table:

+-----------------------+-----------+----------------------+-------------------+
|                          LIGHT--&quot;ND&quot; mode arguments                          |
+-----------------------+-----------+----------------------+-------------------+
|       Argument        | Data type |     Description      |      Default      |
+-----------------------+-----------+----------------------+-------------------+
| name                  | STR       | Unique light name    | None              |
+-----------------------+-----------+----------------------+-------------------+
| intensity             | REAL      | A real number from   | Based on          |
|                       |           | 0.0 to the default   | attenuation       |
|                       |           | maximum              |                   |
+-----------------------+-----------+----------------------+-------------------+
| from                  | LIST      | Light location       | Current           |
|                       |           |                      | look-from point   |
+-----------------------+-----------+----------------------+-------------------+
| to                    | LIST      | Light target         | Current look-at   |
|                       |           |                      | point             |
+-----------------------+-----------+----------------------+-------------------+
| color                 | LIST      | Any RGB triplet      | 1.0, 1.0, 1.0     |
+-----------------------+-----------+----------------------+-------------------+
| shadowmapsize         | INT       | Integer from 0 to    | 0                 |
|                       |           | 4096 (the size, in   |                   |
|                       |           | pixels, of one side  |                   |
|                       |           | of the shadow map)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| hotspot               | REAL      | Angle of the         | 44.0              |
|                       |           | brightness beam in   |                   |
|                       |           | degrees (must be in  |                   |
|                       |           | the range of 1-160)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| falloff               | REAL      | Angle that includes  | 45.0              |
|                       |           | the rapid decay      |                   |
|                       |           | area, in degrees     |                   |
|                       |           | (must be in the      |                   |
|                       |           | range 0-160 and      |                   |
|                       |           | greater than the     |                   |
|                       |           | hotspot value)       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowsoftness        | REAL      | Real number in the   | 0.0               |
|                       |           | range 0.0-10.0       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadow                | STR       | Shadow-casting       | 0.0               |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no shadows) and     |                   |
|                       |           | &quot;on&quot; (cast shadows)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| month                 | INT       | Integer from 1 to 12 | 9                 |
+-----------------------+-----------+----------------------+-------------------+
| day                   | INT       | Integer from 1 to 31 | 21                |
+-----------------------+-----------+----------------------+-------------------+
| hour                  | INT       | Integer from 0 to 24 | 15                |
+-----------------------+-----------+----------------------+-------------------+
| minute                | INT       | Integer from 0 to 59 | 0                 |
+-----------------------+-----------+----------------------+-------------------+
| daylight              | STR       | Daylight savings     | &quot;off&quot;             |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no daylight         |                   |
|                       |           | savings) and &quot;on&quot;    |                   |
|                       |           | (daylight savings)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| latitude              | REAL      | Real number in the   | 37.62             |
|                       |           | range 0-90           |                   |
+-----------------------+-----------+----------------------+-------------------+
| longitude             | REAL      | Real number in the   | 122.37            |
|                       |           | range 0-180          |                   |
+-----------------------+-----------+----------------------+-------------------+
| timezone              | INT       | Integer from -12 to  | 8 (PST)           |
|                       |           | 12, representing     |                   |
|                       |           | the hours behind     |                   |
|                       |           | Greenwich Mean Time  |                   |
|                       |           | (GMT)                |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowobjects         | ENAME     | A selection of       | 0.0               |
|                       |           | objects that bound   |                   |
|                       |           | the shadow maps      |                   |
+-----------------------+-----------+----------------------+-------------------+
NP--New Point Light

Create a new point light.

(c:light &quot;NP&quot; name [intensity [from [nil [color
[shadowmapsize [nil [nil [shadowsoftness [shadow
[attenuation[shadowobjects ]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The arguments for the New Point Light mode are described in the following
table:

+-----------------------+-----------+----------------------+-------------------+
|                         LIGHT-- &quot;NP&quot; mode arguments                          |
+-----------------------+-----------+----------------------+-------------------+
|       Argument        | Data type |     Description      |      Default      |
+-----------------------+-----------+----------------------+-------------------+
| name                  | STR       | Unique light name    | None              |
+-----------------------+-----------+----------------------+-------------------+
| intensity             | REAL      | A real number from   | Based on          |
|                       |           | 0.0 to the default   | attenuation       |
|                       |           | maximum              |                   |
+-----------------------+-----------+----------------------+-------------------+
| from                  | LIST      | Light location       | Current           |
|                       |           |                      | look-from point   |
+-----------------------+-----------+----------------------+-------------------+
| color                 | LIST      | Any RGB triplet      | 1.0, 1.0, 1.0     |
+-----------------------+-----------+----------------------+-------------------+
| shadowmapsize         | INT       | Integer from 0 to    | 0                 |
|                       |           | 4096 (the size, in   |                   |
|                       |           | pixels, of one side  |                   |
|                       |           | of the shadow map)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowsoftness        | REAL      | Real number in the   | 0.0               |
|                       |           | range 0.0-10.0       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadow                | STR       | Shadow-casting       | 0.0               |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no shadows) and     |                   |
|                       |           | &quot;on&quot; (cast shadows)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| attenuation           | INT       | 0 = no attenuation   | 1                 |
|                       |           | 1 = inverse linear   |                   |
|                       |           | attenuation          |                   |
|                       |           | 2 = inverse square   |                   |
|                       |           | attenuation          |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowobjects         | ENAME     | A selection of       | 0.0               |
|                       |           | objects that bound   |                   |
|                       |           | the shadow maps      |                   |
+-----------------------+-----------+----------------------+-------------------+
Three arguments--to (after from), hotspot, and falloff (after
shadowmapsize)--do not apply to point lights. You must pass them as nil when
you create a new point light.

<span class="ExamplesIdentifier">Examples</span>

For example, the following code creates a new point light named NEWPT1.

(c:light &quot;NP&quot; &quot;NEWPT1&quot;)

NEWPT1 would have the default intensity, the current attenuation setting, the
default location looking at the current view, and the default color of white.

<span class="Todo">Note</span>:  For point lights, the default maximum intensity depends on the current
point/spotlight attenuation setting. With no attenuation, it is 1.00; with
inverse linear attenuation, it is twice the drawing's maximum extents distance;
and with inverse square attenuation, it is the square of twice the maximum
extents distance.

NS--New Spotlight

Creates a new spotlight.

(c:light &quot;NS&quot; name [intensity [from [to [color [shadowmapsize [hotspot [falloff
[shadowsoftness [shadow [attenuation <span class="Special">[shadowobjects]</span>]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The arguments for the New Spotlight mode are described in the following table:

+-----------------------+-----------+----------------------+-------------------+
|                         LIGHT-- &quot;NS&quot; mode arguments                          |
+-----------------------+-----------+----------------------+-------------------+
|       Argument        | Data type |     Description      |      Default      |
+-----------------------+-----------+----------------------+-------------------+
| name                  | STR       | Unique light name    | None              |
+-----------------------+-----------+----------------------+-------------------+
| intensity             | REAL      | A real number from   | Based on          |
|                       |           | 0.0 to the default   | attenuation       |
|                       |           | maximum              |                   |
+-----------------------+-----------+----------------------+-------------------+
| from                  | LIST      | Light location       | Current           |
|                       |           |                      | look-from point   |
+-----------------------+-----------+----------------------+-------------------+
| to                    | LIST      | Light target         | Current look-at   |
|                       |           |                      | point             |
+-----------------------+-----------+----------------------+-------------------+
| color                 | LIST      | Any RGB triplet      | 1.0, 1.0, 1.0     |
+-----------------------+-----------+----------------------+-------------------+
| shadowmapsize         | INT       | Integer from 0 to    | 0                 |
|                       |           | 4096 (the size, in   |                   |
|                       |           | pixels, of one side  |                   |
|                       |           | of the shadow map)   |                   |
+-----------------------+-----------+----------------------+-------------------+
| hotspot               | REAL      | Angle of the         | 44.0              |
|                       |           | brightness beam in   |                   |
|                       |           | degrees (must be in  |                   |
|                       |           | the range of 1-160)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| falloff               | REAL      | Angle that includes  | 45.0              |
|                       |           | the rapid decay      |                   |
|                       |           | area, in degrees     |                   |
|                       |           | (must be in the      |                   |
|                       |           | range 0-160 and      |                   |
|                       |           | greater than the     |                   |
|                       |           | hotspot value)       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowsoftness        | REAL      | Real number in the   | 0.0               |
|                       |           | range 0.0-10.0       |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadow                | STR       | Shadow-casting       | 0.0               |
|                       |           | toggle. Valid        |                   |
|                       |           | values are: &quot;off&quot;    |                   |
|                       |           | (no shadows) and     |                   |
|                       |           | &quot;on&quot; (cast shadows)  |                   |
+-----------------------+-----------+----------------------+-------------------+
| attenuation           | INT       | 0 = no attenuation   | 1                 |
|                       |           | 1 = inverse linear   |                   |
|                       |           | attenuation          |                   |
|                       |           | 2 = inverse square   |                   |
|                       |           | attenuation          |                   |
+-----------------------+-----------+----------------------+-------------------+
| shadowobjects         | ENAME     | A selection of       | 0.0               |
|                       |           | objects that bound   |                   |
|                       |           | the shadow maps      |                   |
+-----------------------+-----------+----------------------+-------------------+
<span class="ExamplesIdentifier">Examples</span>

The following code creates a new spotlight named &quot;GSPOT&quot;:

Command: (c:light &quot;NS&quot; &quot;GSPOT&quot; 43.82 '(12.0 6.0 24.0) '(78.0 78.0
24.0) nil nil 30.0 32.0)

1

GSPOT is a spotlight with an intensity of 43.82. Its color is the default
(white). The spotlight's location is (12,6,24), and its target is (78,78,24).
Its cone is 32 degrees wide, with a hotspot of 30 degrees.

<span class="Todo">Note</span>:  For spotlights, the default maximum intensity depends on the current
point/spotlight attenuation setting. With no attenuation, it is 1.00; with
inverse linear attenuation, it is twice the drawing's maximum extents distance;
and with inverse square attenuation, it is the square of twice the maximum
extents distance.

R--Rename Light

Rename a light.

(c:light &quot;R&quot; old_name new_name)

<span class="ArgumentsIdentifier">Arguments</span>

old_name

A string specifying the name of the light to rename.

new_name

A string specifying the light's new name.

The following function call changes the light named &quot;GSPOT&quot; to &quot;HOTSPOT&quot;:

<span class="ExamplesIdentifier">Examples</span>

Command: (c:light &quot;R&quot; &quot;GSPOT&quot; &quot;HOTSPOT&quot;)

1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="lsedit">lsedit</h3>

Creates or modifies landscape objects (Externally-defined: render ARX
application)

(c:lsedit mode <span class="Special">[options]</span>)

This form of the c:lsedit is used to create or modify instances of landscape
objects in the drawing.

(c:lsedit &quot;LIST&quot; object)

This form of c:lsedit lists the attributes of the specified landscape object.
The list returned identifies the name, height, position, and view alignment of
the specified object.

(c:lsedit object height [position <span class="Special">[alignment]</span>])

This form of lsedit modifies a landscape object.

<span class="ArgumentsIdentifier">Arguments</span>

The arguments for the LSEDIT command are described in the following table:

+------------------+-----------------+-------------------------------+---------+
|                               LSEDIT arguments                               |
+------------------+-----------------+-------------------------------+---------+
|     Argument     |    Data type    |          Description          | Default |
+------------------+-----------------+-------------------------------+---------+
| object           | ENAME           | Handle of the landscape       | None    |
|                  |                 | object                        |         |
+------------------+-----------------+-------------------------------+---------+
| height           | REAL            | Height of the object in       | None    |
|                  |                 | drawing units. If nil, the    |         |
|                  |                 | current value is unchanged.   |         |
+------------------+-----------------+-------------------------------+---------+
| position         | LIST (of reals) | The position of the base of   | None    |
|                  |                 | the object. If nil, the       |         |
|                  |                 | current value is unchanged.   |         |
+------------------+-----------------+-------------------------------+---------+
| alignment        | INT             | Specifies the geometry and    | None    |
|                  |                 | alignment of the              |         |
|                  |                 | entry:0--view-aligned single  |         |
|                  |                 | face                          |         |
|                  |                 | 1--non-view-aligned single    |         |
|                  |                 | face                          |         |
|                  |                 | 2--non-view-aligned crossing  |         |
|                  |                 | faces                         |         |
|                  |                 | 3--view-aligned crossing      |         |
|                  |                 | facesIf nil, the current      |         |
|                  |                 | value is unchanged.           |         |
+------------------+-----------------+-------------------------------+---------+
<span class="ExamplesIdentifier">Examples</span>

Modify a landscape object, where <span class="Special">&lt;ename&gt;</span> is the AutoCAD name (entsel) of the
object to modify; leave alignment unchanged:

(c:lsedit <span class="Special">&lt;ename&gt;</span> 35.0 '(10.0 23.0) nil)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="lslib">lslib</h3>

Manages the landscape library (Externally-defined: render ARX application)

(c:lslib mode <span class="Special">[options]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

mode

The mode argument can be one of the following:

ADD Add an entry to a landscape library

DELETE Delete an entry from a landscape library

MODIFY Modify an entry in a landscape library

OPEN Open a landscape library

SAVE Save the current landscape library

LIST List the entries in the current landscape library

options

The allowable options arguments vary depending on mode. See the description of
each mode to determine the allowable options.

ADD

Add an entry to the current library.

(c:lslib &quot;ADD&quot; name texture-map opacity-map alignment)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string naming the entry in the landscape library.

texture-map

A string naming the image file for the entry.

opacity-map

A string naming the opacity image for the entry.

alignment

An integer specifying the geometry and alignment of the entry. Can be one of
the following:

0 view-aligned single face

1 non-view-aligned single face

2 non-view-aligned crossing faces

3 view-aligned crossing faces

There are no default values for any of these arguments.

<span class="ExamplesIdentifier">Examples</span>

Add an entry called &quot;Maple tree&quot; to the current landscape library:

(c:lslib &quot;ADD&quot; &quot;Maple tree&quot; &quot;maple.tga&quot; &quot;mapleo.tga&quot; 0)

DELETE

Remove an entry from the current library.

(c:lslib &quot;DELETE&quot; name)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string naming the entry in the landscape library.

<span class="ExamplesIdentifier">Examples</span>

Remove the entry called &quot;Maple tree&quot; from the current landscape library:

(c:lslib &quot;delete&quot; &quot;Maple tree&quot;)

MODIFY

(c:lslib &quot;MODIFY&quot; name texture-map [opacity-map <span class="Special">[alignment]</span>])

Change an entry in the current library. The texture-map, opacity-map, and
alignment arguments can be passed as nil, in which case the value is unchanged.

<span class="ArgumentsIdentifier">Arguments</span>

name

A string naming the entry in the landscape library.

texture-map

A string naming the image file for the entry.

opacity-map

A string naming the opacity image for the entry.

alignment

An integer specifying the geometry and alignment of the entry. Can be one of
the following:

0 view-aligned single face

1 non-view-aligned single face

2 non-view-aligned crossing faces

3 view-aligned crossing faces

There are no default values for any of these arguments.

<span class="ExamplesIdentifier">Examples</span>

Change the &quot;Maple tree&quot; to be non-view-aligned with crossing faces:

(c:lslib &quot;MODIFY&quot; &quot;Maple tree&quot; nil nil 2)

OPEN

Open a new library and make it the current library.

(c:lslib &quot;OPEN&quot; name)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string naming the landscape library to open.

<span class="ExamplesIdentifier">Examples</span>

Open the TREES.LLI file and make it the current landscape library:

(c:lslib &quot;OPEN&quot; &quot;TREES.LLI&quot;)

SAVE

Save the current landscape library as the named file.

(c:lslib &quot;SAVE&quot; name)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string naming the landscape library file.

<span class="ExamplesIdentifier">Examples</span>

Save the file as TREES.LLI:

(c:lslib &quot;SAVE&quot; &quot;TREES.LLI&quot;)

LIST

Lists all the elements in the current library. This command takes no arguments.
The list includes landscape entries of the form '(&quot;NAME&quot; &quot;TEX-MAP&quot; &quot;OP-MAP&quot;
ALIGN).

(c:lslib &quot;LIST&quot;)

<span class="ExamplesIdentifier">Examples</span>

The following illustrates output from the LIST option:

((&quot;Bush #1&quot; &quot;8bush02l.tga&quot; &quot;8bush02o.tga&quot; 0)

(&quot;Cactus&quot; &quot;8plnt15l.tga&quot; &quot;8plnt15o.tga&quot; 0)

(&quot;Dawn Redwood&quot; &quot;8tree39l.tga&quot; &quot;8tree39o.tga&quot; 0))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="lsnew">lsnew</h3>

Create landscape objects (Externally-defined: render ARX application)

(c:lsnew object-type height position alignment)

The LSNEW command is used to create instances of landscape objects in the
drawing.

<span class="ArgumentsIdentifier">Arguments</span>

object-type

A string naming the landscape library entry.

height

A real number indicating the height of the object in drawing units.

position

A list of reals indicating the position of the base of the object.

alignment

An integer specifying the geometry and alignment of the entry. Can be one of
the following:

0 view-aligned single face

1 non-view-aligned single face

2 non-view-aligned crossing faces

3 view-aligned crossing faces

There are no default values for any of these arguments.

<span class="ExamplesIdentifier">Examples</span>

Create a new instance of &quot;Cactus&quot; that is 25 units tall, located at 0, 1, 3,
and has a single non-view-aligned face.

Command: (c:lsnew &quot;Cactus&quot; 25.0 '(0.0 1.0 3.0) 1)

1

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="matlib">matlib</h3>

Manages materials libraries (Externally-defined: render ARX application)

(c:matlib mode name <span class="Special">[file]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

mode

A string that specifies the action that this function performs. Can be one of
the following:

I Import a material from a library.

E Export a material to a library.

D Delete a material from the drawing.

C Delete unattached materials from the drawing.

L List materials

name

A string that specifies the name of the material to import, export, or delete.

file

A string that specifies the name of the materials library. file. The file
argument must include the .mli extension

<span class="ExamplesIdentifier">Examples</span>

Imports the material BRASS from the standard AutoCAD Render materials library,
render.mli:

Command: (c:matlib &quot;I&quot; &quot;brass&quot; &quot;c:/acad2000/support/render.mli&quot;)

1

The file argument is not used with the Delete mode:

(c:matlib &quot;D&quot; &quot;steel&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="mirror3d">mirror3d</h3>

Reflects selected objects about a user-specified plane (Externally-defined:
geom3d ARX application)

(mirror3d arg1 arg2 ...)

<span class="ArgumentsIdentifier">Arguments</span>

The order, number, and type of arguments for the mirror3d function are the same
as if you were entering the MIRROR3D AutoCAD command. To signify a user
pressing ENTER without typing any values, use nil or an empty string (&quot;&quot;).

<span class="ReturnsIdentifier">Return Values</span>

T if successful, otherwise nil.

<span class="ExamplesIdentifier">Examples</span>

The following example mirrors the selected objects about the XY plane that
passes through the point 0,0,5, and then deletes the old objects:

(setq ss (ssget))

(mirror3d ss &quot;XY&quot; '(0 0 5) &quot;Y&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="render">render</h3>

Creates a realistically shaded image of a 3D wireframe model using geometry,
lighting, and surface finish information (Externally-defined: render ARX
application)

(c:render [filename|point1 point2])

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string naming a rendering file.

If the filename argument is present, the rendering is written to a file of that
name. If a driver to render to a file hasn't been configured, the filename
argument is ignored. The current configuration must specify rendering to a
file.

point1

A list of reals indicating the first crop window point.

point1

A list of reals indicating the second crop window point.

The rendering is controlled by the current settings; set these by using the
c:rpref function. For example:

(c:rpref &quot;Toggle&quot; &quot;CropWindow&quot; &quot;On&quot;)

<span class="Todo">Note</span>:  When the current rendering preferences specify Query for Selection and
the PICKFIRST system variable is turned on, and when a selection set is current
as you invoke c:render, the objects in the set are rendered with no further
prompting.

Setting the Render to File Options

Sets the render to file options for rendering.

(c:rfileopt fileformat xres yres aratio colormode &lt;mode-specific options&gt;)

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the c:rfileopt arguments.

+--------------------+-----------+---------------------------------------------+
|                              RFILEOPT arguments                              |
+--------------------+-----------+---------------------------------------------+
|      Argument      | Data type |                 Description                 |
+--------------------+-----------+---------------------------------------------+
| fileformat         | STR       | Identifier for the requested                |
|                    |           | format:TGA--Targa format                    |
|                    |           | PCX--Z-Soft bitmap format                   |
|                    |           | BMP--Microsoft Windows format               |
|                    |           | PS--PostScript                              |
|                    |           | TIFF--Tagged Image File Format              |
+--------------------+-----------+---------------------------------------------+
| xres               | INT       | X resolution of the output file (valid      |
|                    |           | values range from 1 to 4096)                |
+--------------------+-----------+---------------------------------------------+
| yres               | INT       | Y resolution of the output file (valid      |
|                    |           | values range from 1 to 4096)                |
+--------------------+-----------+---------------------------------------------+
| aratio             | REAL      | Pixel aspect ratio                          |
+--------------------+-----------+---------------------------------------------+
| colormode          | STR       | Each file format accepts a subset of the    |
|                    |           | following values:MONO--Monochrome           |
|                    |           | G8--256 gray levels                         |
|                    |           | C8--256 colors                              |
|                    |           | C16--16-bit color                           |
|                    |           | C24--24-bit color                           |
|                    |           | C32--24-bit color with 8 bits of alpha      |
+--------------------+-----------+---------------------------------------------+
TGA

Specifies the Targa format.

(c:rfileopt &quot;TGA&quot; xres yres aratio colormode
interlace compress bottomup)

<span class="ArgumentsIdentifier">Arguments</span>

+----------------------+-----------+-------------------------------------------+
|                             TGA format arguments                             |
+----------------------+-----------+-------------------------------------------+
|       Argument       | Data type |                Description                |
+----------------------+-----------+-------------------------------------------+
| colormode            | STR       | Color mode: G8, C8, C24, or C32           |
+----------------------+-----------+-------------------------------------------+
| interlace            | INT       | Interlace mode: 1--no interlace           |
|                      |           | 2--2:1 interlace                          |
|                      |           | 4--4:1 interlace                          |
+----------------------+-----------+-------------------------------------------+
| compress             | STR       | Compression (default =                    |
|                      |           | &quot;COMP&quot;):COMP--Compression on              |
|                      |           | nil--No compression                       |
+----------------------+-----------+-------------------------------------------+
| bottomup             | STR       | Bottom up (default = &quot;UP&quot;): UP--bottom up |
|                      |           | nil--top down                             |
+----------------------+-----------+-------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

(C:RFILEOPT &quot;TGA&quot; 640 480 1.0 &quot;C32&quot; 1 &quot;COMP&quot; &quot;UP&quot;)

PCX

Specifies the Z-Soft Bitmap format.

(c:rfileopt &quot;PCX&quot; xres yres aratio colormode)

<span class="ArgumentsIdentifier">Arguments</span>

       +----------------------+-----------+-----------------------------+
       |                      PCX format arguments                      |
       +----------------------+-----------+-----------------------------+
       |       Argument       | Data type |         Description         |
       +----------------------+-----------+-----------------------------+
       | colormode            | STR       | Color mode: MONO, G8, or C8 |
       +----------------------+-----------+-----------------------------+
<span class="ExamplesIdentifier">Examples</span>

(C:RFILEOPT &quot;PCX&quot; 640 480 1.0 &quot;G8&quot;)

BMP

Specifies the Microsoft Windows bitmap format.

(c:rfileopt &quot;BMP&quot; xres yres aratio colormode)

<span class="ArgumentsIdentifier">Arguments</span>

       +----------------------+-----------+-----------------------------+
       |                      BMP format arguments                      |
       +----------------------+-----------+-----------------------------+
       |       Argument       | Data type |         Description         |
       +----------------------+-----------+-----------------------------+
       | colormode            | STR       | Color mode: MONO, G8, or C8 |
       +----------------------+-----------+-----------------------------+
<span class="ExamplesIdentifier">Examples</span>

(C:RFILEOPT &quot;BMP&quot; 640 480 1.0 &quot;C8&quot;)

PS

Specifies the PostScript format.

(c:rfileopt &quot;PS&quot; xres yres aratio colormode portrait imagesize <span class="Special">[size]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

+---------------------+-----------+--------------------------------------------+
|                             PS format arguments                              |
+---------------------+-----------+--------------------------------------------+
|      Argument       | Data type |                Description                 |
+---------------------+-----------+--------------------------------------------+
| colormode           | STR       | Color mode: MONO, G8, C8, or C24           |
+---------------------+-----------+--------------------------------------------+
| portrait            | STR       | Landscape or portrait (default = &quot;L&quot;):     |
|                     |           | P--Portrait                                |
|                     |           | L--Landscape                               |
+---------------------+-----------+--------------------------------------------+
| imagesize           | STR       | Type (default = &quot;A&quot;)A--Auto                |
|                     |           | I--Image                                   |
|                     |           | C--Custom                                  |
+---------------------+-----------+--------------------------------------------+
| size                | INT       | Size of the image                          |
+---------------------+-----------+--------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

(C:RFILEOPT &quot;PS&quot; 640 480 1.0 &quot;C24&quot; &quot;P&quot; &quot;C&quot; 640)

TIFF

Specifies the Tagged Image File format.

(c:rfileopt &quot;TIFF&quot; xres yres aratio colormode)

<span class="ArgumentsIdentifier">Arguments</span>

  +-----------------------+-----------+---------------------------------------+
  |                           TIFF format arguments                           |
  +-----------------------+-----------+---------------------------------------+
  |       Argument        | Data type |              Description              |
  +-----------------------+-----------+---------------------------------------+
  | colormode             | STR       | Color mode: MONO, G8, C8, C24, or C32 |
  +-----------------------+-----------+---------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

(C:RFILEOPT &quot;TIFF&quot; 640 480 1.0 &quot;C24&quot;)


<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="renderupdate">renderupdate</h3>

Regenerate the ent2face file on the next rendering (Externally-defined: render
ARX application)

(c:renderupdate <span class="Special">[RU_value]</span>)

Use the renderupdate command with no arguments to regenerate the en2face file
on the next rendering.

<span class="ArgumentsIdentifier">Arguments</span>

RU_value

A string specifying one of the following:

ALWAYS Generate a new geometry file for each rendering.

OFF Return Render to the normal geometry caching mode.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="rpref">rpref</h3>

Sets rendering preferences (Externally-defined: render ARX application)

(c:rpref mode option <span class="Special">[setting]</span>)

The c:rpref function determines which rendering parameters will be used, and
which rendering behavior will be the default.

<span class="ArgumentsIdentifier">Arguments</span>

mode

A string that can be one of the following:

DEST Destination of viewport, Render window, or file

ICON Scale of the Light and Materials icon blocks

ROPT More rendering options

SELECT Whether to prompt for object selection

STYPE Rendering type of Render, Photo Real, or Photo Raytrace

TOGGLE Rendering options

option

Depends on mode.

setting

Depends on mode.

See Also Setting the Render to File Options.

DEST--Destination Preference

Selects which output device is used.

(c:rpref &quot;DEST&quot; option)

<span class="ArgumentsIdentifier">Arguments</span>

option

A string that specifies the rendering destination. Can be one of the following:

FRAMEBUFFER Render to display

HARDCOPY Render to Render window

FILE Render to file

<span class="ExamplesIdentifier">Examples</span>

The following call specifies rendering to a file:

(c:rpref &quot;DEST&quot; &quot;FILE&quot;)

ICON--Icon Preference

Specifies the size of the light or material icon block in a drawing.

(c:rpref &quot;ICON&quot; option)

<span class="ArgumentsIdentifier">Arguments</span>

option

A real that specifies the size of the icon block. The default value is 1.00.

<span class="ExamplesIdentifier">Examples</span>

The following function call changes the icon scale to 50 percent:

(c:rpref &quot;ICON&quot; 0.5)

STYPE--Rendering Type Preference

Specifies which type of Render is used.

(c:rpref &quot;STYPE&quot; option)

<span class="ArgumentsIdentifier">Arguments</span>

option

A string that specifies the rendering type. Can be one of the following:

ARENDER Basic rendering

ASCAN Photo Real rendering

ARAY Photo Raytrace rendering

<span class="ExamplesIdentifier">Examples</span>

The following code specifies that the next rendering will be generated by the
basic AutoCAD renderer.

(c:rpref &quot;STYPE&quot; &quot;ARENDER&quot;)

SELECT--Selection Preference

Specifies whether to prompt for object selection before generating a rendering.

(c:rpref &quot;SELECT&quot; option)

<span class="ArgumentsIdentifier">Arguments</span>

option

A string that specifies the prompting. Can be one of the following:

ALL Render full scene

ASK Prompt for object selection

<span class="ExamplesIdentifier">Examples</span>

The following call sets rendering to prompt for object selection:

(c:rpref &quot;SELECT&quot; &quot;ASK&quot;)

TOGGLE--Toggle Preference

Controls various rendering options.

(c:rpref &quot;TOGGLE&quot; option setting)

<span class="ArgumentsIdentifier">Arguments</span>

option

A string that specifies the prompting. Can be one of the following:

CACHE Render to a cache file. As long as the drawing geometry or view is
unchanged, the cached file is used for subsequent renderings, eliminating the
need to retessellate.

SHADOW Render with shadows.

SMOOTH Render with smoothing.

MERGE Merge objects with background.

FINISH Apply materials.

SKIPRDLG Do not display the Render dialog box.

setting

A string that specifies the state of the toggle. Possible values for setting
are &quot;ON&quot; and &quot;OFF&quot;.

<span class="ExamplesIdentifier">Examples</span>

The following calls turn off Merge rendering and turn on shadows:

(c:rpref &quot;TOGGLE&quot; &quot;MERGE&quot; &quot;OFF&quot;)

(c:rpref &quot;TOGGLE&quot; &quot;SMOOTH&quot; &quot;ON&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="replay">replay</h3>

Displays a BMP, TGA, or TIFF image (Externally-defined: render ARX application)

(c:replay filename type [xoff yoff xsize ysize])

With the REPLAY command, you can display BMP, TGA, or TIFF files on the AutoCAD
rendering display. Use this command's function to replay the image file at
various offsets and sizes.

<span class="ArgumentsIdentifier">Arguments</span>

filename

A string naming the image file.

type

A string identifying the file type. Can be BMP, TGA, or TIFF.

xoff

An integer specifying the image X offset in pixels. Default is 0.

yoff

An integer specifying the image Y offset in pixels. Default is 0.

xsize

Image X size in pixels. Default is the actual X size.

ysize

Image Y size in pixels. Default is the actual Y size.

<span class="ExamplesIdentifier">Examples</span>

The following call replays an image named test.tga, displaying pixels starting
from the lower left of the image (zero offset) out to 500 pixels wide and 400
pixels in height:

(c:replay &quot;TEST&quot; &quot;TGA&quot; 0 0 500 400)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="rotate3d">rotate3d</h3>

Rotates an object about an arbitrary 3D axis (Externally-defined: geom3d ARX
application)

(rotate3d args ...)

<span class="ArgumentsIdentifier">Arguments</span>

args

The order, number, and type of arguments for the rotate3d function are the same
as if you were entering them at the command line; see ROTATE3D in the Command
Reference for more information.

To signify a null response (user pressing ENTER without specifying any
arguments), use nil or an empty string (&quot;&quot;).

<span class="ReturnsIdentifier">Return Values</span>

If successful, rotate3d returns T; otherwise it returns nil.

<span class="ExamplesIdentifier">Examples</span>

The following example rotates the selected objects 30 degrees about the axis
specified by points p1 and p2.

(setq ss (ssget))

(rotate3d ss p1 p2 30)

AutoLISP support for the rotate3d function is implemented with the use of the
SAGET library.

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="scene">scene</h3>

Creates new scenes and modifies or deletes existing scenes in paper space only
(Externally-defined: render ARX application)

(c:scene mode <span class="Special">[options]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

mode

A string that can be one of the following:

D Deletes an existing scene

L Lists all scenes in the drawing or returns a definition of the specified
scene

M Modifies an existing scene

<span class="Special">N</span> Creates a new scene

R Renames an existing scene

S Sets the current scene

options

The allowable options depend on the mode specified.

D--Delete Scene

Deletes an existing scene.

(c:scene &quot;D&quot; name)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string that specifies the name of the scene to delete.

the deleted scene is the current scene, NONE becomes the current scene.

<span class="ExamplesIdentifier">Examples</span>

(c:scene &quot;D&quot; &quot;PLANVIEW&quot;)

L--List Scene

Lists all scenes in the drawing or returns a definition of the specified scene.

(c:scene &quot;L&quot; <span class="Special">[name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string that specifies the name of the scene to list. If the name argument is
omitted, c:scene returns a list of all the scenes defined in the drawing.

<span class="ReturnsIdentifier">Return Values</span>

When you specify name, c:scene returns the definition of the named scene.

<span class="ExamplesIdentifier">Examples</span>

The following code returns a list of scene names defined in the drawing.

Command: (c:scene &quot;L&quot;)

(&quot;&quot; &quot;SCENE1&quot; &quot;SCENE2&quot; &quot;SCENE3&quot;)

The empty string (&quot;&quot;) is the default scene, *NONE*, which can't be modified.

The following function call returns a definition of the named scene:

Command: (c:scene &quot;L&quot; &quot;SCENE2&quot;)

(T T)

(&quot;VIEW1&quot; nil)

(&quot;VIEW2&quot; (&quot;LIGHT1&quot; &quot;LIGHT2&quot;))

M--Modify Scene

Modifies an existing scene.

(c:scene &quot;M&quot; name [view <span class="Special">[lights]</span>])

The options for the Modify mode are the same as those for the New mode, except
that you can pass view as nil to modify only the lights.

<span class="Todo">Note</span>:  You must pass the lights argument as a list even when you specify only
one light.

For example, the following call modifies a scene named SCENE1 to use the named
view FRONT and all the lights in the drawing:

(c:scene &quot;M&quot; &quot;SCENE1&quot; &quot;FRONT&quot; (C:LIGHT &quot;L&quot;))

The following call modifies SCENE1 to use the named view BACK and only the
lights P1 and P2:

(c:scene &quot;M&quot; &quot;SCENE1&quot; &quot;BACK&quot; '(&quot;P1&quot; &quot;P2&quot;))

N--New Scene

Creates a new scene.

(c:scene &quot;<span class="Special">N</span>&quot; name [view <span class="Special">[lights]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

name

A string that specifies the name of the new scene.

view

Either a string identifying an AutoCAD named view, or the symbol T to indicate
CURRENT view.

lights

The lights argument can be one of the following:

<span class="Statement">  </span>* A list of strings containing light names to be used.
<span class="Statement">  </span>* The symbol T, indicating ALL lights in the drawing.
<span class="Statement">  </span>* Nil, indicating no lights in the drawing.

+------------+------+-------------+---------+--------+----------+------------+---------------------+
|        * SCENE--&quot;<span class="Special">N</span>&quot; mode argument         |        |          |            |                     |
+------------+------+-------------+---------+--------+----------+------------+---------------------+
| * Argument |  *   |      *      |    *    |        |          |            |                     |
|            | Data | Description | Default |        |          |            |                     |
|            | type |             |         |        |          |            |                     |
+------------+------+-------------+---------+--------+----------+------------+---------------------+
|            |      |             |         | *      | * LIST   | * List of  | * ALL lights in     |
|            |      |             |         | lights | (of      | light      | the drawing         |
|            |      |             |         |        | strings) | names.     |                     |
|            |      |             |         |        |          | Must use   | An                  |
|            |      |             |         |        | T (SYM)  | a list     | &quot;over-the-shoulder&quot; |
|            |      |             |         |        | nil      | even if    | distant light       |
|            |      |             |         |        |          | specifying |                     |
|            |      |             |         |        |          | a single   |                     |
|            |      |             |         |        |          | light.     |                     |
|            |      |             |         |        |          | Use  ALL   |                     |
|            |      |             |         |        |          | lights in  |                     |
|            |      |             |         |        |          | the        |                     |
|            |      |             |         |        |          | drawing    |                     |
|            |      |             |         |        |          | Use no     |                     |
|            |      |             |         |        |          | lights in  |                     |
|            |      |             |         |        |          | the        |                     |
|            |      |             |         |        |          | drawing    |                     |
+------------+------+-------------+---------+--------+----------+------------+---------------------+
<span class="ExamplesIdentifier">Examples</span>

To create a new scene named DEFAULT using the CURRENT view and ALL lights,
issue the following function call:

(c:scene &quot;<span class="Special">N</span>&quot; &quot;DEFAULT&quot;)

To create a new scene named DULL using the CURRENT view and the default,
&quot;over-the-shoulder&quot; lighting, use the following call:

(c:scene &quot;<span class="Special">N</span>&quot; &quot;DULL&quot; T nil)

To create a new scene named SPECIAL using the named view MY_VIEW and the SUN,
LAMP, and SPOT lights, issue the following function call:

(c:scene &quot;<span class="Special">N</span>&quot; &quot;SPECIAL&quot; &quot;MY_VIEW&quot; '(&quot;SUN&quot; &quot;LAMP &quot;SPOT&quot;))

R--Rename Scene

Renames a scene.

(c:scene &quot;R&quot; old_name new_name)

<span class="ArgumentsIdentifier">Arguments</span>

old_name

A string that specifies the name of the original scene.

new_name

A string that specifies the new name for the scene.

<span class="ExamplesIdentifier">Examples</span>

Rename a scene from &quot;SPECIAL&quot; to &quot;BRIGHT&quot;:

(c:scene &quot;R&quot; &quot;SPECIAL&quot; &quot;BRIGHT&quot;)

S--Set Scene

Sets the current scene.

(c:scene &quot;S&quot; <span class="Special">[name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

old_name

A string that specifies the name of the scene to make current.

<span class="ReturnsIdentifier">Return Values</span>

If you omit the name argument, c:scene returns the name of the currently
selected scene.

<span class="ExamplesIdentifier">Examples</span>

Obtain the name of the currently selected scene:

Command: (c:scene &quot;S&quot;)

&quot;PLAN&quot;

If there is no current scene, c:scene returns an empty string (&quot;&quot;).

To make SCENE3 the current scene, issue the following function call:

(c:scene &quot;S&quot; &quot;SCENE3&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="stats">stats</h3>

Displays statistics for the last rendering (Externally-defined: render ARX
application)

(c:stats [filename |nil])

The STATS command provides information about your last rendering.

<span class="ArgumentsIdentifier">Arguments</span>

filename | nil

A string specifying the name of the file to save the rendering information in,
or nil to tell RENDER to stop saving statistics. If you omit the file name,
c:stats displays the Statistics dialog box.

<span class="ExamplesIdentifier">Examples</span>

The following command writes statistics from your last rendering to the
figures.txt file:

(c:stats &quot;figures.txt&quot;)

If the file already exists, the statistics are appended.

The following command saves the information associated with the last rendering
to the stats.txt file, and also saves the information associated with the
following renderings to this file:

(c:stats &quot;stats.txt&quot;)

The following command tells RENDER to stop saving statistics:

(c:stats nil)
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="setuv">setuv</h3>

Assigns material mapping coordinates to selected objects. Its function has two
modes, specified by a string argument (Externally-defined: render ARX
application)

(c:setuv mode options)

The SETUV command lets you assign material mapping coordinates to selected
objects.

<span class="ArgumentsIdentifier">Arguments</span>

mode

mode can be one of the following strings:

A Assign UV mapping to the selection set

D Detach UV mapping from the selection set

options

Allowable options depend on the mode specified.

A--Assign

The &quot;A&quot; (assign) mode assigns mapping coordinates.

<span class="ArgumentsIdentifier">Arguments</span>

<span class="ArgumentsIdentifier">Arguments</span> expected by this mode depend on whether you specify projection or
solid mapping. The assign arguments for projection mapping are described in the
following table:

+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
|              SETUV--&quot;A&quot; mode arguments for projection mapping               |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
|  Argument  |  Data  |                 Description                 | Default |        |         |             |      |
|            |  type  |                                             |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
|            |        |                                             |         | ssname | PICKSET | The         | None |
|            |        |                                             |         |        |         | selection   |      |
|            |        |                                             |         |        |         | set that    |      |
|            |        |                                             |         |        |         | contains    |      |
|            |        |                                             |         |        |         | the         |      |
|            |        |                                             |         |        |         | entities    |      |
|            |        |                                             |         |        |         | to which    |      |
|            |        |                                             |         |        |         | you want    |      |
|            |        |                                             |         |        |         | to assign   |      |
|            |        |                                             |         |        |         | mapping     |      |
|            |        |                                             |         |        |         | coordinates |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
| mapping    | STR    | Type of projection                          | None    |        |         |             |      |
| type       |        | mapping:P--planarD--cylindricalF--spherical |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
| pt1, pt2,  | LIST   | Three points that define the mapping        | None    |        |         |             |      |
| pt3        |        | geometry:Planar--lower-left corner,         |         |        |         |             |      |
|            |        | lower-right corner, upper-left corner       |         |        |         |             |      |
|            |        | Cylindrical--center bottom, center top,     |         |        |         |             |      |
|            |        | direction toward the seam                   |         |        |         |             |      |
|            |        | Spherical--center of the sphere, radius     |         |        |         |             |      |
|            |        | (north), direction toward the seam          |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
| rep        | INT    | Tiling:0--no tiling (crop)                  | 1       |        |         |             |      |
|            |        | 1--tile (repeat pattern)                    |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
| scale      | LIST   | The U and V scale factors                   | (1.0    |        |         |             |      |
|            | (of    |                                             | 1.0)    |        |         |             |      |
|            | reals) |                                             |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
| offset     | LIST   | The U and V offsets                         | (0.0    |        |         |             |      |
|            | (of    |                                             | 0.0)    |        |         |             |      |
|            | reals) |                                             |         |        |         |             |      |
+------------+--------+---------------------------------------------+---------+--------+---------+-------------+------+
For solid mapping, the option arguments specify only the mapping points. These
implicitly define the scale in the UVW dimensions. The assign arguments for
solid mapping are described in the following table:

+------------+------+-------------+---------+--------+---------+-------------+------+
|    SETUV--&quot;A&quot; mode arguments for solid    |        |         |             |      |
|                  mapping                  |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
|  Argument  | Data | Description | Default |        |         |             |      |
|            | type |             |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
|            |      |             |         | ssname | PICKSET | The         | None |
|            |      |             |         |        |         | selection   |      |
|            |      |             |         |        |         | set that    |      |
|            |      |             |         |        |         | contains    |      |
|            |      |             |         |        |         | the         |      |
|            |      |             |         |        |         | objects to  |      |
|            |      |             |         |        |         | which you   |      |
|            |      |             |         |        |         | want to     |      |
|            |      |             |         |        |         | assign      |      |
|            |      |             |         |        |         | mapping     |      |
|            |      |             |         |        |         | coordinates |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
| mapping    | STR  | R--solid    | None    |        |         |             |      |
| type       |      |             |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
| pt1        | LIST | Point to    | None    |        |         |             |      |
|            |      | define the  |         |        |         |             |      |
|            |      | origin      |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
| pt1        | LIST | Point to    | None    |        |         |             |      |
|            |      | define the  |         |        |         |             |      |
|            |      | U axis      |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
| pt1        | LIST | Point to    | None    |        |         |             |      |
|            |      | define the  |         |        |         |             |      |
|            |      | V axis      |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
| pt1        | LIST | Point to    | None    |        |         |             |      |
|            |      | define the  |         |        |         |             |      |
|            |      | W axis      |         |        |         |             |      |
+------------+------+-------------+---------+--------+---------+-------------+------+
<span class="ExamplesIdentifier">Examples</span>

The following function call assigns cylindrical mapping coordinates to an
object the user chooses, using tiling and the default scale and offset:

(c:setuv &quot;A&quot; (ssget) &quot;C&quot; '(5.0 5.0 5.0) '(5.0 5.0 10.0)

'(10.0 0.0 0.0) 1)

D--Detach

The &quot;D&quot; (detach) mode detaches the UV mapping assigned to the objects in the
selection set. These objects will now be mapped with the default mapping
coordinates until you assign mapping coordinates again.

<span class="ArgumentsIdentifier">Arguments</span>

ssname

The selection set that contains the objects from which you want to detach
mapping coordinates

<span class="ExamplesIdentifier">Examples</span>

The following call prompts the user for entities that will be detached from
their mapping coordinates:

(c:setuv &quot;D&quot; (ssget))

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="saveimg">saveimg</h3>

Saves a rendered image to a file in BMP, TGA, or TIFF format
(Externally-defined: render ARX application)

(c:saveimg filename type <span class="Special">[portion]</span> [xoff yoff xsize ysize] <span class="Special">[compression]</span>)

When AutoCAD is configured to render to a separate display, the portion
argument should not be used. You can specify a size and offset for the image;
and for TGA and TIFF files, you can specify a compression scheme.

<span class="ArgumentsIdentifier">Arguments</span>

The arguments to saveimg are described in the following table:

+-------------+------+--------------------+---------+----------+-----+-------+------+
|            SAVEIMG function arguments             |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
|  Argument   | Data |    Description     | Default |          |     |       |      |
|             | type |                    |         |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
|             |      |                    |         | filename | STR | Image | None |
|             |      |                    |         |          |     | file  |      |
|             |      |                    |         |          |     | name  |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| type        | STR  | File type: BMP,    | None    |          |     |       |      |
|             |      | TGA, or TIFF       |         |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| portion     | STR  | Portion of the     | &quot;A&quot;     |          |     |       |      |
|             |      | screen to          |         |          |     |       |      |
|             |      | save:A--active     |         |          |     |       |      |
|             |      | viewportD--drawing |         |          |     |       |      |
|             |      | areaF--full        |         |          |     |       |      |
|             |      | screen <span class="Todo">NOTE</span>  This  |         |          |     |       |      |
|             |      | argument is now    |         |          |     |       |      |
|             |      | ignored, but is    |         |          |     |       |      |
|             |      | provided for       |         |          |     |       |      |
|             |      | script             |         |          |     |       |      |
|             |      | compatibility.     |         |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| xoff        | INT  | X offset in pixels | 0       |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| yoff        | INT  | Y offset in pixels | 0       |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| xsize       | INT  | X size in pixels   | Actual  |          |     |       |      |
|             |      |                    | X size  |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| ysize       | INT  | Y size in pixels   | Actual  |          |     |       |      |
|             |      |                    | Y size  |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
| compression | STR  | Compression        | None    |          |     |       |      |
|             |      | scheme:NONE        |         |          |     |       |      |
|             |      | PACK (TIFF files   |         |          |     |       |      |
|             |      | only)              |         |          |     |       |      |
|             |      | RLE (TGA files     |         |          |     |       |      |
|             |      | only)              |         |          |     |       |      |
+-------------+------+--------------------+---------+----------+-----+-------+------+
<span class="ExamplesIdentifier">Examples</span>

The following example saves a full-screen TIFF image named test.tif, without
compressing the file:

(c:saveimg &quot;TEST&quot; &quot;TIF&quot; &quot;NONE&quot;)

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="showmat">showmat</h3>

Lists the material type and attachment method for a selected object
(Externally-defined: render ARX application)

(c:showmat arg1)

This function lists the material type and attachment method based on arg1.

<span class="ArgumentsIdentifier">Arguments</span>

arg1

Can be an entity name, an integer representing an ACI value, or a layer name (a
string).

<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="rmat">rmat</h3>

Creates, edits, attaches, and detaches rendering materials (Externally-defined:
render ARX application)

(c:rmat mode options)

<span class="ArgumentsIdentifier">Arguments</span>

mode

A string. Can be one of the following:

A Attaches material

C Copies material

D Detaches material

L Lists all materials in the drawing or returns a definition of the specified
material

M Modifies material

<span class="Special">N</span> Creates new material

options

The options allowed depend on the mode specified.

A--Attach Material

The &quot;A&quot; (attach) mode lets you attach a material to selected objects or an ACI
(AutoCAD Color Index) value, depending on whether the third argument
(layer-name) is an integer or a selection set.

(c:rmat &quot;A&quot; name [aci | selection-set | layer-name])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the attach arguments.

+------------------+-----------+-----------------------------------------------+
|                               Attach arguments                               |
+------------------+-----------+-----------------------------------------------+
|     Argument     | Data type |                  Description                  |
+------------------+-----------+-----------------------------------------------+
| name             | STR       | Name of the material to attach                |
+------------------+-----------+-----------------------------------------------+
| aci              | INT       | ACI number in the range of 0 through 255      |
+------------------+-----------+-----------------------------------------------+
| selection-set    | INT       | Selection set that contains the entities to   |
|                  |           | attach                                        |
+------------------+-----------+-----------------------------------------------+
| layer-name       | STR       | Name of the layer                             |
+------------------+-----------+-----------------------------------------------+
<span class="ExamplesIdentifier">Examples</span>

Attach the material PURPLE TIGER to the ACI 1 (red):

(c:rmat &quot;A&quot; &quot;PURPLE TIGER&quot; 1)

If you omit the third argument, the &quot;A&quot; mode returns a list of three items:

<span class="Statement">  </span>* A list of layer names the material is attached to

<span class="Statement">  </span>* A list of ACIs the material is attached to

<span class="Statement">  </span>* A selection set that contains the objects the material is attached to

The following example illustrates the values returned when the third argument
is omitted:

Command: (c:rmat &quot;a&quot; &quot;twood&quot;)

Gathering objects...1 found

 Layer names ACI's

((&quot;first&quot; &quot;second&quot;)(135) &lt;Selection set 12&gt;))

A material index value in the range 1-255 is an ACI number; an index greater
than 255 indicates an AutoCAD Render material not assigned by ACI.

C--Copy Material

Creates a new material by copying one already present in the drawing.

(c:rmat &quot;C&quot; cur_name new_name)

<span class="ArgumentsIdentifier">Arguments</span>

cur_name

A string that specifies the name of the material to copy.

new_name

A string that specifies the name for the new material.

<span class="ExamplesIdentifier">Examples</span>

Modify a material to change its definition:

(c:rmat &quot;C&quot; &quot;RED&quot; &quot;RED2&quot;)

D--Detach Material

The &quot;D&quot; (detach) mode lets you detach a material from selected objects, an ACI
(AutoCAD Color Index) value, or layers, depending on whether the second
argument (selection-set) is an integer, a selection set, or a string.

(c:rmat &quot;D&quot; name [aci | selection-set | layer-name])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the detach arguments.

+------------------+-----------+-------------------------------------+---------+
|                               Detach arguments                               |
+------------------+-----------+-------------------------------------+---------+
|     Argument     | Data type |             Description             | Default |
+------------------+-----------+-------------------------------------+---------+
| name             | STR       | Name of the material to detach      | None    |
+------------------+-----------+-------------------------------------+---------+
| aci              | INT       | ACI number in the range of 0        | None    |
|                  |           | through 255                         |         |
+------------------+-----------+-------------------------------------+---------+
| selection-set    | INT       | Selection set that contains the     | None    |
|                  |           | entities to detach                  |         |
+------------------+-----------+-------------------------------------+---------+
| layer-name       | STR       | Name of the layer                   | None    |
+------------------+-----------+-------------------------------------+---------+
<span class="ExamplesIdentifier">Examples</span>

Prompt the user to select objects, and then detach each object from its
material:

(c:rmat &quot;D&quot; (ssget))

L--List Material

Lists material definitions in the drawing.

(c:rmat &quot;L&quot; <span class="Special">[name]</span>)

<span class="ArgumentsIdentifier">Arguments</span>

name

A string that specifies the material definition to list. If the name argument
is omitted, c:rmat lists all materials in the drawing.

<span class="ExamplesIdentifier">Examples</span>

List all materials in the drawing:

Command: (c:rmat &quot;L&quot;)

GLOBAL*&quot; &quot;BLUE GLASS&quot; &quot;WHITE PLASTIC&quot; &quot;TWOOD&quot; &quot;BEIGE MATTE&quot;)

The first string in the list specifies the default global material, *GLOBAL*.
You can pass this string to c:rmat just as you can pass the names of library or
user-defined materials, as demonstrated in the following example:

Command: (c:rmat &quot;L&quot; &quot;*GLOBAL*&quot;)

(&quot;*GLOBAL*&quot; &quot;STANDARD&quot; (-1.0 -1.0 -1.0) 0.7 (&quot;&quot; 0.0 0 (1.0 1.0) (0.0
0.0) 0.0 0 0) (-1.0 -1.0 -1.0) 0.1 (-1.0 -1.0 -1.0) 0.2 (&quot;&quot; 0.0 0)
0.5 0.0 (&quot;&quot; 0.0 0 (1.0 1.0) (0.0 0.0) 0.0 0 0) 1.0 (&quot;&quot; 0.0 0 (1.0
1.0) (0.0 0.0) 0.0 0 0))

The list items in a material definition are the same as the arguments to the
Modify or New modes.

M--Modify Material

The options for the &quot;M&quot; (modify) mode are the same as for the &quot;<span class="Special">N</span>&quot; (new) mode.
If an argument is nil, or is omitted from the end of the argument list, the
property affected by the argument retains its current value.

For example, the following call changes BLUE MARBLE to have a medium blue stone
(matrix) color and black veins:

(c:rmat &quot;M&quot; &quot;BLUE MARBLE&quot; &quot;marble&quot; '(0.5 0.5 1.0) '(0.0 0.0 0.0))

N--New Material

The &quot;<span class="Special">N</span>&quot; (new) mode creates a new material. The arguments to this function
depend not only on the mode, but also on the type of material you're creating.
The procedural materials--marble, granite, and wood--have a unique set of
arguments, each of which differs from the standard material arguments.

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the new arguments:

+---------------+-----------+---------------------------------------+----------+
|                                New arguments                                 |
+---------------+-----------+---------------------------------------+----------+
|   Argument    | Data type |              Description              | Default  |
+---------------+-----------+---------------------------------------+----------+
| name          | STR       | Name of the material to create        | None     |
+---------------+-----------+---------------------------------------+----------+
| material-type | STR       | Type of new material. The options     | None     |
|               |           | are:STANDARD--standard material       |          |
|               |           | MARBLE--marble material               |          |
|               |           | GRANITE--granite material             |          |
|               |           | WOOD--wood material                   |          |
+---------------+-----------+---------------------------------------+----------+
| description   | (Varies)  | <span class="ArgumentsIdentifier">Arguments</span> depend on the type of       | (Varies) |
|               |           | material you're creating              |          |
+---------------+-----------+---------------------------------------+----------+
| selection-set | INT       | Selection set that contains the       | None     |
|               |           | entities to detach                    |          |
+---------------+-----------+---------------------------------------+----------+
| layer-name    | STR       | Name of the layer                     | None     |
+---------------+-----------+---------------------------------------+----------+
In addition, the arguments for each kind of bitmap are specified in a sublist
as described under Bitmap <span class="ArgumentsIdentifier">Arguments</span>.

Standard

The material type string &quot;STANDARD&quot; indicates you're creating a new standard
material.

(c:rmat &quot;<span class="Special">N</span>&quot; name &quot;STANDARD&quot; [color [color-weight [pattern
[ambient [amb-weight [ref1 [ref1-weight [ref1-map [roughness [transparency
[opacitymap [refraction <span class="Special">[bumpmap]</span>]]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the standard arguments:

+-------------------+-------------+----------------------------+---------------+
|                              Standard arguments                              |
+-------------------+-------------+----------------------------+---------------+
|     Argument      |  Data type  |        Description         |    Default    |
+-------------------+-------------+----------------------------+---------------+
| color             | LIST (or    | Material color as an RGB   | (-1.0 -1.0    |
|                   | reals)      | triple; (-1.0 - 1.0 -1.0)  | -1.0)--By ACI |
|                   |             | means derive the color     |               |
|                   |             | from an object's ACI       |               |
|                   |             | (diffuse color)            |               |
+-------------------+-------------+----------------------------+---------------+
| color-weight      | REAL        | Weight factor (color       | 0.7           |
|                   |             | Value)--the amount of      |               |
|                   |             | diffuse color              |               |
+-------------------+-------------+----------------------------+---------------+
| pattern           | LIST        | Pattern/texture map        | None          |
|                   |             | arguments                  |               |
+-------------------+-------------+----------------------------+---------------+
| ambient           | LIST (or    | Ambient (shadow) color as  | (-1.0 -1.0    |
|                   | reals)      | an RGB triple              | -1.0)--By ACI |
+-------------------+-------------+----------------------------+---------------+
| amb-weight        | REAL        | Weight factor (ambient     | 0.1           |
|                   |             | Value)--the amount of      |               |
|                   |             | specular color             |               |
+-------------------+-------------+----------------------------+---------------+
| refl              | LIST (or    | Reflection (specular)      | (-1.0 -1.0    |
|                   | reals)      | color as an RGB triple     | -1.0)--By ACI |
+-------------------+-------------+----------------------------+---------------+
| refl-weight       | REAL        | Weight factor (reflection  | 0.2           |
|                   |             | Value)--the amount of      |               |
|                   |             | specular color             |               |
+-------------------+-------------+----------------------------+---------------+
| refl-map          | LIST        | Reflection/environment     | None          |
|                   |             | map arguments              |               |
+-------------------+-------------+----------------------------+---------------+
| roughness         | REAL        | Roughness--the size of a   | 0.5           |
|                   |             | specular highlight         |               |
+-------------------+-------------+----------------------------+---------------+
| transparency      | REAL        | Transparency of the        | 0.0           |
|                   |             | material                   |               |
+-------------------+-------------+----------------------------+---------------+
| opacity-map       | LIST        | Opacity map arguments      | None          |
+-------------------+-------------+----------------------------+---------------+
| refraction        | REAL        | Index of refraction        | 1.0           |
+-------------------+-------------+----------------------------+---------------+
| bumpmap           | LIST        | Bump map arguments         | None          |
+-------------------+-------------+----------------------------+---------------+
<span class="ExamplesIdentifier">Examples</span>

The following call creates a shiny red material with a pattern map:

(c:rmat &quot;<span class="Special">N</span>&quot; &quot;RED LACQUER&quot; &quot;STANDARD&quot; ; Name and type

'(1.0 0.0 0.0) (1.0) ; Color (red), weight, and texture map

'(&quot;INLAY.TGA&quot; 0.75 0 (0.5 0.5) (0.3 0.3) 0.0 0 1)

'(1.0 0.0 0.0) 1.0 ; Ambient color and its weight (same as diffuse)

'(1.0 0.0 0.0) 1.0 ; Reflection color (white) and its weight

nil ; No reflection map

0.2 ; Roughness (low)

0.0 ; Transparency (none)

nil ; No opacity map

0.0 ; Refraction (none)

nil ; No bump map

The next call creates a material, MAPS, that uses multiple bitmaps:

(c:rmat &quot;<span class="Special">N</span>&quot; &quot;MAPS&quot; &quot;STANDARD&quot;

'(1.0 0.0 0.0) (1.0) '(&quot;weave.tga&quot; 1.0 0)

'(1.0 0.0 0.0) 1.0

'(1.0 0.0 0.0) 1.0 '(&quot;room.tga&quot; 0.75)

0.5

0.0

'(&quot;hole.tga&quot;)

1.0

'(&quot;ridges.tga&quot;)

The following call creates a material with no bitmaps and default values, with
reflections that are generated by ray tracing when rendered with Photo Raytrace
or with environment map with Photo Real:

(c:rmat &quot;<span class="Special">N</span>&quot; &quot;SHINE&quot; &quot;STANDARD&quot; nil nil nil nil nil nil nil
'(nil nil 1))

Marble

The material type string &quot;MARBLE&quot; indicates that you are creating a new marble
material.

(c:rmat &quot;<span class="Special">N</span>&quot; name &quot;MARBLE&quot; [stone-color [vein-color [refl [refl-weight [refl-map
[roughness [turbulence [sharpness [scale [bumpmap ]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the marble arguments:

+------------------+------------+----------------------------+-----------------+
|                            RMAT--Marble arguments                            |
+------------------+------------+----------------------------+-----------------+
|     Argument     | Data type  |        Description         |     Default     |
+------------------+------------+----------------------------+-----------------+
| stone-color      | LIST (of   | RGB value specifying the   | (-1.0 -1.0      |
|                  | reals)     | main matrix color of the   | -1.0)--white    |
|                  |            | marble                     |                 |
+------------------+------------+----------------------------+-----------------+
| vein-color       | LIST (of   | RGB value specifying the   | (-1.0 -1.0      |
|                  | reals)     | vein color of the marble   | -1.0)--black    |
+------------------+------------+----------------------------+-----------------+
| refl             | LIST (of   | Reflection (specular)      | (-1.0 -1.0      |
|                  | reals)     | color as an RGB value      | -1.0)--By ACI   |
+------------------+------------+----------------------------+-----------------+
| refl-wgt         | REAL       | Weight factor (reflection  | 0.2             |
|                  |            | Value)--the amount of      |                 |
|                  |            | specular color             |                 |
+------------------+------------+----------------------------+-----------------+
| refl-map         | LIST       | Reflection/environment     | None            |
|                  |            | map arguments              |                 |
+------------------+------------+----------------------------+-----------------+
| roughness        | REAL       | Roughness--the size of a   | 0.5             |
|                  |            | specular highlight         |                 |
+------------------+------------+----------------------------+-----------------+
| turbulence       | INT        | Turbulence                 | 3               |
|                  |            | factor--swirliness of the  |                 |
|                  |            | veins                      |                 |
+------------------+------------+----------------------------+-----------------+
| sharpness        | REAL       | Sharpness factor--the      | 1.0             |
|                  |            | amount of blur             |                 |
+------------------+------------+----------------------------+-----------------+
| scale            | REAL       | Overall scale factor       | 0.16            |
+------------------+------------+----------------------------+-----------------+
| bumpmap          | LIST       | Bumpmap arguments          | None            |
+------------------+------------+----------------------------+-----------------+
<span class="ExamplesIdentifier">Examples</span>

The following call creates a marble with a pink matrix and black veins:

(c:rmat &quot;<span class="Special">N</span>&quot; &quot;PINK MARBLE&quot; &quot;MARBLE&quot; '(1.0 0.34 0.79))

Granite

The material type string &quot;GRANITE&quot; indicates that you're creating a new granite
material.

(c:rmat &quot;<span class="Special">N</span>&quot; name &quot;GRANITE&quot; [first-color [amount1 [second-color [amount2
[third-color [amount3 [fourth-color [amount 4 [refl [refl-weight [refl-map
[roughness [sharpness [scale [bumpmap ]]]]]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the granite arguments:

+-------------------+------------+---------------------------+-----------------+
|                           RMAT--Granite arguments                            |
+-------------------+------------+---------------------------+-----------------+
|     Argument      | Data type  |        Description        |     Default     |
+-------------------+------------+---------------------------+-----------------+
| first-color       | LIST (of   | RGB value                 | (-1.0 -1.0      |
|                   | reals)     |                           | -1.0)--white    |
+-------------------+------------+---------------------------+-----------------+
| amount1           | REAL       | Weight factor (color      | 1.0             |
|                   |            | Value) for first color    |                 |
+-------------------+------------+---------------------------+-----------------+
| second-color      | LIST (of   | RGB value                 | (0.5 0.5        |
|                   | reals)     |                           | 0.5)--dark gray |
+-------------------+------------+---------------------------+-----------------+
| amount2           | REAL       | Weight factor (color      | 1.0             |
|                   |            | Value) for second color   |                 |
+-------------------+------------+---------------------------+-----------------+
| third-color       | LIST (of   | RGB value                 | (0.0 0.0        |
|                   | reals)     |                           | 0.0)--black     |
+-------------------+------------+---------------------------+-----------------+
| amount3           | REAL       | Weight factor (color      | 1.0             |
|                   |            | Value) for third color    |                 |
+-------------------+------------+---------------------------+-----------------+
| fourth-color      | LIST (of   | RGB value                 | (0.7 0.7        |
|                   | reals)     |                           | 0.7)--light     |
|                   |            |                           | gray            |
+-------------------+------------+---------------------------+-----------------+
| amount4           | REAL       | Weight factor (color      | 1.0             |
|                   |            | Value) for fourth color   |                 |
+-------------------+------------+---------------------------+-----------------+
| refl              | LIST (of   | Reflection (specular)     | (-1.0 -1.0      |
|                   | reals)     | color as an RGB value     | -1.0)--By ACI   |
+-------------------+------------+---------------------------+-----------------+
| refl-weight       | REAL       | Weight factor             | 0.2             |
|                   |            | (reflection Value)--the   |                 |
|                   |            | amount of specular color  |                 |
+-------------------+------------+---------------------------+-----------------+
| refl-map          | LIST       | Reflection/environment    | None            |
|                   |            | map arguments             |                 |
+-------------------+------------+---------------------------+-----------------+
| roughness         | REAL       | Roughness--the size of a  | 0.5             |
|                   |            | specular highlight        |                 |
+-------------------+------------+---------------------------+-----------------+
| sharpness         | REAL       | Sharpness factor--the     | 1.0             |
|                   |            | amount of blur            |                 |
+-------------------+------------+---------------------------+-----------------+
| scale             | REAL       | Overall scale factor      | 0.16            |
+-------------------+------------+---------------------------+-----------------+
| bumpmap           | LIST       | Bumpmap arguments         | None            |
+-------------------+------------+---------------------------+-----------------+
<span class="ExamplesIdentifier">Examples</span>

Create a granite without dark gray, with more black, and with yellow instead of
light gray:

(c:rmap &quot;<span class="Special">N</span>&quot; &quot;YELLOW GRANITE&quot;

 nil 0.5 nil 0.0 nil 0.85 '(1.0 1.0 0.0) 0.6)

Wood

The material type string &quot;WOOD&quot; indicates that you're creating a new wood
material.

(c:rmat &quot;<span class="Special">N</span>&quot; name &quot;WOOD&quot; [light-color [dark-color [refl [refl-weight [refl-map
[roughness [ratio [density [width [shape [bumpmap ]]]]]]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the wood arguments:

+------------------+------------+----------------------------+-----------------+
|                             RMAT--Wood arguments                             |
+------------------+------------+----------------------------+-----------------+
|     Argument     | Data type  |        Description         |     Default     |
+------------------+------------+----------------------------+-----------------+
| light-color      | LIST (of   | RGB value specifying the   | (0.6 0.4 0.3)   |
|                  | reals)     | color of the light rings   |                 |
+------------------+------------+----------------------------+-----------------+
| dark-color       | LIST (of   | RGB value specifying the   | (0.3 0.2        |
|                  | reals)     | color of the dark rings    | 0.2)--black     |
+------------------+------------+----------------------------+-----------------+
| refl             | LIST (of   | Reflection (specular)      | (-1.0 -1.0      |
|                  | reals)     | color as an RGB value      | -1.0)--By ACI   |
+------------------+------------+----------------------------+-----------------+
| refl-weight      | REAL       | Weight factor (reflection  | 0.2             |
|                  |            | Value)--the amount of      |                 |
|                  |            | specular color             |                 |
+------------------+------------+----------------------------+-----------------+
| refl-map         | LIST       | Reflection/environment     | None            |
|                  |            | map arguments              |                 |
+------------------+------------+----------------------------+-----------------+
| roughness        | REAL       | Roughness--the size of a   | 0.5             |
|                  |            | specular highlight         |                 |
+------------------+------------+----------------------------+-----------------+
| ratio            | REAL       | Ratio of light to dark     | 0.5             |
|                  |            | rings                      |                 |
+------------------+------------+----------------------------+-----------------+
| density          | REAL       | Density of the rings       | 6.0             |
+------------------+------------+----------------------------+-----------------+
| width            | REAL       | Ring width variation       | 0.2             |
+------------------+------------+----------------------------+-----------------+
| shape            | REAL       | Ring shape variation       | 0.2             |
+------------------+------------+----------------------------+-----------------+
| scale            | REAL       | Overall scale factor       | 0.16            |
+------------------+------------+----------------------------+-----------------+
| bumpmap          | LIST       | Bumpmap arguments          | None            |
+------------------+------------+----------------------------+-----------------+
<span class="ExamplesIdentifier">Examples</span>

Create a wood with an irregular grain:

(c:rmat &quot;<span class="Special">N</span>&quot; &quot;CRYPTO&quot; &quot;WOOD&quot; nil nil nil nil nil nil nil nil nil 0.56)

Bitmap <span class="ArgumentsIdentifier">Arguments</span>

The arguments to specify a bitmap are passed to a list, which you can include
as a sublist in the c:rmat call (this is the form shown at the beginning of
each of the following sections) or assign to a symbol before you call c:rmat.

Pattern/Texture

'(name [blend [repeat [scale [offset [reserved [map-style <span class="Special">[auto-axis]</span>]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the pattern/texture arguments:

+--------------------+-----------+---------------------------------+-----------+
|                          Pattern/texture arguments                           |
+--------------------+-----------+---------------------------------+-----------+
|      Argument      | Data type |           Description           |  Default  |
+--------------------+-----------+---------------------------------+-----------+
| name               | STR       | Name of the bitmap file         | None      |
+--------------------+-----------+---------------------------------+-----------+
| blend              | REAL      | Amount of map color to use      | 1.0       |
+--------------------+-----------+---------------------------------+-----------+
| repeat             | INT       | Whether to repeat (tile) the    | 0         |
|                    |           | bitmap:0--no tiling (crop)      |           |
|                    |           | 1--tile (repeat pattern)        |           |
+--------------------+-----------+---------------------------------+-----------+
| scale              | LIST (of  | U and V scale factors           | (1.0 1.0) |
|                    | reals)    |                                 |           |
+--------------------+-----------+---------------------------------+-----------+
| offset             | LIST (of  | U and V offsets                 | (0.0 0.0) |
|                    | reals)    |                                 |           |
+--------------------+-----------+---------------------------------+-----------+
| reserved           | REAL      | Reserved placeholder            | None      |
+--------------------+-----------+---------------------------------+-----------+
| map-style          | INT       | Whether the map style           | 0         |
|                    |           | is:0--fixed scale1--fit to      |           |
|                    |           | entity                          |           |
+--------------------+-----------+---------------------------------+-----------+
| auto-axis          | INT       | Whether or not Auto Axis is     | 1         |
|                    |           | enabled:0--disabled1--enabled   |           |
+--------------------+-----------+---------------------------------+-----------+
Reflection/Environment

'(name [blend <span class="Special">[raytrace]</span>])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the reflection/environment arguments:

+------------------------------+-----------+-------------------------+---------+
|                       Reflection/environment arguments                       |
+------------------------------+-----------+-------------------------+---------+
|           Argument           | Data type |       Description       | Default |
+------------------------------+-----------+-------------------------+---------+
| name                         | STR       | Name of the bitmap file | None    |
+------------------------------+-----------+-------------------------+---------+
| blend                        | REAL      | Amount of map color to  | 1.0     |
|                              |           | use                     |         |
+------------------------------+-----------+-------------------------+---------+
| mirror                       | REAL      | Whether to generate     | 0       |
|                              |           | mirrored                |         |
|                              |           | reflections:0--no       |         |
|                              |           | mirror                  |         |
|                              |           | 1--mirrorDuring         |         |
|                              |           | mirror, generates       |         |
|                              |           | raytraced reflections;  |         |
|                              |           | during scanline, uses   |         |
|                              |           | environment map for     |         |
|                              |           | reflections             |         |
+------------------------------+-----------+-------------------------+---------+
Opacity

'(name [blend [repeat [scale [offset [reserved [map-style <span class="Special">[auto-axis]</span>]]]]]])

<span class="ArgumentsIdentifier">Arguments</span>

The following table describes the opacity arguments:

+----------------+-------------+-----------------------------------+-----------+
|                              Opacity arguments                               |
+----------------+-------------+-----------------------------------+-----------+
|    Argument    |  Data type  |            Description            |  Default  |
+----------------+-------------+-----------------------------------+-----------+
| name           | STR         | Name of the bitmap file           | None      |
+----------------+-------------+-----------------------------------+-----------+
| blend          | REAL        | Amount of map color to use        | 1.0       |
+----------------+-------------+-----------------------------------+-----------+
| repeat         | INT         | Whether to repeat (tile) the      | 0         |
|                |             | bitmap:0--no tiling (crop)        |           |
|                |             | 1--tile (repeat pattern)          |           |
+----------------+-------------+-----------------------------------+-----------+
| scale          | LIST (of    | U and V scale factors             | (1.0 1.0) |
|                | reals)      |                                   |           |
+----------------+-------------+-----------------------------------+-----------+
| offset         | LIST (of    | U and V offsets                   | (0.0 0.0) |
|                | reals)      |                                   |           |
+----------------+-------------+-----------------------------------+-----------+
| reserved       | REAL        | Reserved placeholder              | None      |
+----------------+-------------+-----------------------------------+-----------+
| map-style      | INT         | Whether the map style             | 0         |
|                |             | is:0--fixed scale1--fit to entity |           |
+----------------+-------------+-----------------------------------+-----------+
| auto-axis      | INT         | Whether or not Auto Axis is       | 1         |
|                |             | enabled:0--disabled1--enabled     |           |
+----------------+-------------+-----------------------------------+-----------+
Bump Map

'(name [amplitude [repeat [scale [offset [reserved [map-style
[auto-axis]]]]]]])

The following table describes the bump arguments:

+----------------+-------------+-----------------------------------+-----------+
|                                Bump arguments                                |
+----------------+-------------+-----------------------------------+-----------+
|    Argument    |  Data type  |            Description            |  Default  |
+----------------+-------------+-----------------------------------+-----------+
| name           | STR         | Name of the bitmap file           | None      |
+----------------+-------------+-----------------------------------+-----------+
| amplitude      | REAL        | Degree of bumpiness               | 1.0       |
+----------------+-------------+-----------------------------------+-----------+
| repeat         | INT         | Whether to repeat (tile) the      | 0         |
|                |             | bitmap:0--no tiling (crop)        |           |
|                |             | 1--tile (repeat pattern)          |           |
+----------------+-------------+-----------------------------------+-----------+
| scale          | LIST (of    | U and V scale factors             | (1.0 1.0) |
|                | reals)      |                                   |           |
+----------------+-------------+-----------------------------------+-----------+
| offset         | LIST (of    | U and V offsets                   | (0.0 0.0) |
|                | reals)      |                                   |           |
+----------------+-------------+-----------------------------------+-----------+
| reserved       | REAL        | Reserved placeholder              | None      |
+----------------+-------------+-----------------------------------+-----------+
| map-style      | INT         | Whether the map style             | 0         |
|                |             | is:0--fixed scale1--fit to entity |           |
+----------------+-------------+-----------------------------------+-----------+
| auto-axis      | INT         | Whether or not Auto Axis is       | 1         |
|                |             | enabled:0--disabled1--enabled     |           |
+----------------+-------------+-----------------------------------+-----------+
<span class="PreProc">-------------------------------------------------------------------------------</span>
<h3 class="String" id="solprof">solprof</h3>

Creates profile images of three-dimensional solids (Externally-defined: solids
ARX application

(c:solprof args ...)

<span class="ArgumentsIdentifier">Arguments</span>

args

The order, number, and type of arguments are the same as those specified when
issuing SOLPROF at the Command prompt.

</pre>
    </body>
</html>

